(()=>{var Un=Object.create;var we=Object.defineProperty,$n=Object.defineProperties,On=Object.getOwnPropertyDescriptor,Fn=Object.getOwnPropertyDescriptors,Xn=Object.getOwnPropertyNames,ir=Object.getOwnPropertySymbols,Gn=Object.getPrototypeOf,cr=Object.prototype.hasOwnProperty,Wn=Object.prototype.propertyIsEnumerable;var sr=(r,e,a)=>e in r?we(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a,j=(r,e)=>{for(var a in e||(e={}))cr.call(e,a)&&sr(r,a,e[a]);if(ir)for(var a of ir(e))Wn.call(e,a)&&sr(r,a,e[a]);return r},ur=(r,e)=>$n(r,Fn(e)),zn=r=>we(r,"__esModule",{value:!0});var ye=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(e,a)=>(typeof require!="undefined"?require:e)[a]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var Vn=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Kn=(r,e,a,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let f of Xn(e))!cr.call(r,f)&&(a||f!=="default")&&we(r,f,{get:()=>e[f],enumerable:!(u=On(e,f))||u.enumerable});return r},Yn=(r,e)=>Kn(zn(we(r!=null?Un(Gn(r)):{},"default",!e&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var hr=Vn((dr,Je)=>{(function(r){if(typeof dr=="object"&&typeof Je<"u")Je.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=r()}})(function(){var r,e,a;return function u(f,E,L){function R(k,V){if(!E[k]){if(!f[k]){var y=typeof ye=="function"&&ye;if(!V&&y)return y(k,!0);if(P)return P(k,!0);var S=new Error("Cannot find module '"+k+"'");throw S.code="MODULE_NOT_FOUND",S}var U=E[k]={exports:{}};f[k][0].call(U.exports,function($){var Y=f[k][1][$];return R(Y||$)},U,U.exports,u,f,E,L)}return E[k].exports}for(var P=typeof ye=="function"&&ye,D=0;D<L.length;D++)R(L[D]);return R}({1:[function(u,f,E){(function(L){"use strict";var R=L.MutationObserver||L.WebKitMutationObserver,P;if(R){var D=0,k=new R($),V=L.document.createTextNode("");k.observe(V,{characterData:!0}),P=function(){V.data=D=++D%2}}else if(!L.setImmediate&&typeof L.MessageChannel<"u"){var y=new L.MessageChannel;y.port1.onmessage=$,P=function(){y.port2.postMessage(0)}}else"document"in L&&"onreadystatechange"in L.document.createElement("script")?P=function(){var X=L.document.createElement("script");X.onreadystatechange=function(){$(),X.onreadystatechange=null,X.parentNode.removeChild(X),X=null},L.document.documentElement.appendChild(X)}:P=function(){setTimeout($,0)};var S,U=[];function $(){S=!0;for(var X,te,G=U.length;G;){for(te=U,U=[],X=-1;++X<G;)te[X]();G=U.length}S=!1}f.exports=Y;function Y(X){U.push(X)===1&&!S&&P()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(u,f,E){"use strict";var L=u(1);function R(){}var P={},D=["REJECTED"],k=["FULFILLED"],V=["PENDING"];f.exports=y;function y(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=V,this.queue=[],this.outcome=void 0,g!==R&&Y(this,g)}y.prototype.catch=function(g){return this.then(null,g)},y.prototype.then=function(g,A){if(typeof g!="function"&&this.state===k||typeof A!="function"&&this.state===D)return this;var I=new this.constructor(R);if(this.state!==V){var N=this.state===k?g:A;U(I,N,this.outcome)}else this.queue.push(new S(I,g,A));return I};function S(g,A,I){this.promise=g,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}S.prototype.callFulfilled=function(g){P.resolve(this.promise,g)},S.prototype.otherCallFulfilled=function(g){U(this.promise,this.onFulfilled,g)},S.prototype.callRejected=function(g){P.reject(this.promise,g)},S.prototype.otherCallRejected=function(g){U(this.promise,this.onRejected,g)};function U(g,A,I){L(function(){var N;try{N=A(I)}catch(z){return P.reject(g,z)}N===g?P.reject(g,new TypeError("Cannot resolve promise with itself")):P.resolve(g,N)})}P.resolve=function(g,A){var I=X($,A);if(I.status==="error")return P.reject(g,I.value);var N=I.value;if(N)Y(g,N);else{g.state=k,g.outcome=A;for(var z=-1,K=g.queue.length;++z<K;)g.queue[z].callFulfilled(A)}return g},P.reject=function(g,A){g.state=D,g.outcome=A;for(var I=-1,N=g.queue.length;++I<N;)g.queue[I].callRejected(A);return g};function $(g){var A=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof A=="function")return function(){A.apply(g,arguments)}}function Y(g,A){var I=!1;function N(q){I||(I=!0,P.reject(g,q))}function z(q){I||(I=!0,P.resolve(g,q))}function K(){A(z,N)}var Q=X(K);Q.status==="error"&&N(Q.value)}function X(g,A){var I={};try{I.value=g(A),I.status="success"}catch(N){I.status="error",I.value=N}return I}y.resolve=te;function te(g){return g instanceof this?g:P.resolve(new this(R),g)}y.reject=G;function G(g){var A=new this(R);return P.reject(A,g)}y.all=Ue;function Ue(g){var A=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=g.length,N=!1;if(!I)return this.resolve([]);for(var z=new Array(I),K=0,Q=-1,q=new this(R);++Q<I;)re(g[Q],Q);return q;function re(ve,Se){A.resolve(ve).then($e,function(fe){N||(N=!0,P.reject(q,fe))});function $e(fe){z[Se]=fe,++K===I&&!N&&(N=!0,P.resolve(q,z))}}}y.race=se;function se(g){var A=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=g.length,N=!1;if(!I)return this.resolve([]);for(var z=-1,K=new this(R);++z<I;)Q(g[z]);return K;function Q(q){A.resolve(q).then(function(re){N||(N=!0,P.resolve(K,re))},function(re){N||(N=!0,P.reject(K,re))})}}},{"1":1}],3:[function(u,f,E){(function(L){"use strict";typeof L.Promise!="function"&&(L.Promise=u(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(u,f,E){"use strict";var L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function R(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function P(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(t){return}}var D=P();function k(){try{if(!D||!D.open)return!1;var t=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),o=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||o)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(n){return!1}}function V(t,o){t=t||[],o=o||{};try{return new Blob(t,o)}catch(i){if(i.name!=="TypeError")throw i;for(var n=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,s=new n,c=0;c<t.length;c+=1)s.append(t[c]);return s.getBlob(o.type)}}typeof Promise>"u"&&u(3);var y=Promise;function S(t,o){o&&t.then(function(n){o(null,n)},function(n){o(n)})}function U(t,o,n){typeof o=="function"&&t.then(o),typeof n=="function"&&t.catch(n)}function $(t){return typeof t!="string"&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function Y(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var X="local-forage-detect-blob-support",te=void 0,G={},Ue=Object.prototype.toString,se="readonly",g="readwrite";function A(t){for(var o=t.length,n=new ArrayBuffer(o),s=new Uint8Array(n),c=0;c<o;c++)s[c]=t.charCodeAt(c);return n}function I(t){return new y(function(o){var n=t.transaction(X,g),s=V([""]);n.objectStore(X).put(s,"key"),n.onabort=function(c){c.preventDefault(),c.stopPropagation(),o(!1)},n.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);o(i||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}function N(t){return typeof te=="boolean"?y.resolve(te):I(t).then(function(o){return te=o,te})}function z(t){var o=G[t.name],n={};n.promise=new y(function(s,c){n.resolve=s,n.reject=c}),o.deferredOperations.push(n),o.dbReady?o.dbReady=o.dbReady.then(function(){return n.promise}):o.dbReady=n.promise}function K(t){var o=G[t.name],n=o.deferredOperations.pop();if(n)return n.resolve(),n.promise}function Q(t,o){var n=G[t.name],s=n.deferredOperations.pop();if(s)return s.reject(o),s.promise}function q(t,o){return new y(function(n,s){if(G[t.name]=G[t.name]||Ot(),t.db)if(o)z(t),t.db.close();else return n(t.db);var c=[t.name];o&&c.push(t.version);var i=D.open.apply(D,c);o&&(i.onupgradeneeded=function(l){var m=i.result;try{m.createObjectStore(t.storeName),l.oldVersion<=1&&m.createObjectStore(X)}catch(d){if(d.name==="ConstraintError")console.warn('The database "'+t.name+'" has been upgraded from version '+l.oldVersion+" to version "+l.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw d}}),i.onerror=function(l){l.preventDefault(),s(i.error)},i.onsuccess=function(){var l=i.result;l.onversionchange=function(m){m.target.close()},n(l),K(t)}})}function re(t){return q(t,!1)}function ve(t){return q(t,!0)}function Se(t,o){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),s=t.version<t.db.version,c=t.version>t.db.version;if(s&&(t.version!==o&&console.warn('The database "'+t.name+`" can't be downgraded from version `+t.db.version+" to version "+t.version+"."),t.version=t.db.version),c||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function $e(t){return new y(function(o,n){var s=new FileReader;s.onerror=n,s.onloadend=function(c){var i=btoa(c.target.result||"");o({__local_forage_encoded_blob:!0,data:i,type:t.type})},s.readAsBinaryString(t)})}function fe(t){var o=A(atob(t.data));return V([o],{type:t.type})}function $t(t){return t&&t.__local_forage_encoded_blob}function Ur(t){var o=this,n=o._initReady().then(function(){var s=G[o._dbInfo.name];if(s&&s.dbReady)return s.dbReady});return U(n,t,t),n}function $r(t){z(t);for(var o=G[t.name],n=o.forages,s=0;s<n.length;s++){var c=n[s];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return t.db=null,re(t).then(function(i){return t.db=i,Se(t)?ve(t):i}).then(function(i){t.db=o.db=i;for(var l=0;l<n.length;l++)n[l]._dbInfo.db=i}).catch(function(i){throw Q(t,i),i})}function ne(t,o,n,s){s===void 0&&(s=1);try{var c=t.db.transaction(t.storeName,o);n(null,c)}catch(i){if(s>0&&(!t.db||i.name==="InvalidStateError"||i.name==="NotFoundError"))return y.resolve().then(function(){if(!t.db||i.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),ve(t)}).then(function(){return $r(t).then(function(){ne(t,o,n,s-1)})}).catch(n);n(i)}}function Ot(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Or(t){var o=this,n={db:null};if(t)for(var s in t)n[s]=t[s];var c=G[n.name];c||(c=Ot(),G[n.name]=c),c.forages.push(o),o._initReady||(o._initReady=o.ready,o.ready=Ur);var i=[];function l(){return y.resolve()}for(var m=0;m<c.forages.length;m++){var d=c.forages[m];d!==o&&i.push(d._initReady().catch(l))}var h=c.forages.slice(0);return y.all(i).then(function(){return n.db=c.db,re(n)}).then(function(p){return n.db=p,Se(n,o._defaultConfig.version)?ve(n):p}).then(function(p){n.db=c.db=p,o._dbInfo=n;for(var x=0;x<h.length;x++){var w=h[x];w!==o&&(w._dbInfo.db=n.db,w._dbInfo.version=n.version)}})}function Fr(t,o){var n=this;t=$(t);var s=new y(function(c,i){n.ready().then(function(){ne(n._dbInfo,se,function(l,m){if(l)return i(l);try{var d=m.objectStore(n._dbInfo.storeName),h=d.get(t);h.onsuccess=function(){var p=h.result;p===void 0&&(p=null),$t(p)&&(p=fe(p)),c(p)},h.onerror=function(){i(h.error)}}catch(p){i(p)}})}).catch(i)});return S(s,o),s}function Xr(t,o){var n=this,s=new y(function(c,i){n.ready().then(function(){ne(n._dbInfo,se,function(l,m){if(l)return i(l);try{var d=m.objectStore(n._dbInfo.storeName),h=d.openCursor(),p=1;h.onsuccess=function(){var x=h.result;if(x){var w=x.value;$t(w)&&(w=fe(w));var _=t(w,x.key,p++);_!==void 0?c(_):x.continue()}else c()},h.onerror=function(){i(h.error)}}catch(x){i(x)}})}).catch(i)});return S(s,o),s}function Gr(t,o,n){var s=this;t=$(t);var c=new y(function(i,l){var m;s.ready().then(function(){return m=s._dbInfo,Ue.call(o)==="[object Blob]"?N(m.db).then(function(d){return d?o:$e(o)}):o}).then(function(d){ne(s._dbInfo,g,function(h,p){if(h)return l(h);try{var x=p.objectStore(s._dbInfo.storeName);d===null&&(d=void 0);var w=x.put(d,t);p.oncomplete=function(){d===void 0&&(d=null),i(d)},p.onabort=p.onerror=function(){var _=w.error?w.error:w.transaction.error;l(_)}}catch(_){l(_)}})}).catch(l)});return S(c,n),c}function Wr(t,o){var n=this;t=$(t);var s=new y(function(c,i){n.ready().then(function(){ne(n._dbInfo,g,function(l,m){if(l)return i(l);try{var d=m.objectStore(n._dbInfo.storeName),h=d.delete(t);m.oncomplete=function(){c()},m.onerror=function(){i(h.error)},m.onabort=function(){var p=h.error?h.error:h.transaction.error;i(p)}}catch(p){i(p)}})}).catch(i)});return S(s,o),s}function zr(t){var o=this,n=new y(function(s,c){o.ready().then(function(){ne(o._dbInfo,g,function(i,l){if(i)return c(i);try{var m=l.objectStore(o._dbInfo.storeName),d=m.clear();l.oncomplete=function(){s()},l.onabort=l.onerror=function(){var h=d.error?d.error:d.transaction.error;c(h)}}catch(h){c(h)}})}).catch(c)});return S(n,t),n}function Vr(t){var o=this,n=new y(function(s,c){o.ready().then(function(){ne(o._dbInfo,se,function(i,l){if(i)return c(i);try{var m=l.objectStore(o._dbInfo.storeName),d=m.count();d.onsuccess=function(){s(d.result)},d.onerror=function(){c(d.error)}}catch(h){c(h)}})}).catch(c)});return S(n,t),n}function Kr(t,o){var n=this,s=new y(function(c,i){if(t<0){c(null);return}n.ready().then(function(){ne(n._dbInfo,se,function(l,m){if(l)return i(l);try{var d=m.objectStore(n._dbInfo.storeName),h=!1,p=d.openKeyCursor();p.onsuccess=function(){var x=p.result;if(!x){c(null);return}t===0||h?c(x.key):(h=!0,x.advance(t))},p.onerror=function(){i(p.error)}}catch(x){i(x)}})}).catch(i)});return S(s,o),s}function Yr(t){var o=this,n=new y(function(s,c){o.ready().then(function(){ne(o._dbInfo,se,function(i,l){if(i)return c(i);try{var m=l.objectStore(o._dbInfo.storeName),d=m.openKeyCursor(),h=[];d.onsuccess=function(){var p=d.result;if(!p){s(h);return}h.push(p.key),p.continue()},d.onerror=function(){c(d.error)}}catch(p){c(p)}})}).catch(c)});return S(n,t),n}function Qr(t,o){o=Y.apply(this,arguments);var n=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var s=this,c;if(!t.name)c=y.reject("Invalid arguments");else{var i=t.name===n.name&&s._dbInfo.db,l=i?y.resolve(s._dbInfo.db):re(t).then(function(m){var d=G[t.name],h=d.forages;d.db=m;for(var p=0;p<h.length;p++)h[p]._dbInfo.db=m;return m});t.storeName?c=l.then(function(m){if(!!m.objectStoreNames.contains(t.storeName)){var d=m.version+1;z(t);var h=G[t.name],p=h.forages;m.close();for(var x=0;x<p.length;x++){var w=p[x];w._dbInfo.db=null,w._dbInfo.version=d}var _=new y(function(H,F){var O=D.open(t.name,d);O.onerror=function(J){var ge=O.result;ge.close(),F(J)},O.onupgradeneeded=function(){var J=O.result;J.deleteObjectStore(t.storeName)},O.onsuccess=function(){var J=O.result;J.close(),H(J)}});return _.then(function(H){h.db=H;for(var F=0;F<p.length;F++){var O=p[F];O._dbInfo.db=H,K(O._dbInfo)}}).catch(function(H){throw(Q(t,H)||y.resolve()).catch(function(){}),H})}}):c=l.then(function(m){z(t);var d=G[t.name],h=d.forages;m.close();for(var p=0;p<h.length;p++){var x=h[p];x._dbInfo.db=null}var w=new y(function(_,H){var F=D.deleteDatabase(t.name);F.onerror=function(){var O=F.result;O&&O.close(),H(F.error)},F.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},F.onsuccess=function(){var O=F.result;O&&O.close(),_(O)}});return w.then(function(_){d.db=_;for(var H=0;H<h.length;H++){var F=h[H];K(F._dbInfo)}}).catch(function(_){throw(Q(t,_)||y.resolve()).catch(function(){}),_})})}return S(c,o),c}var qr={_driver:"asyncStorage",_initStorage:Or,_support:k(),iterate:Xr,getItem:Fr,setItem:Gr,removeItem:Wr,clear:zr,length:Vr,key:Kr,keys:Yr,dropInstance:Qr};function Jr(){return typeof openDatabase=="function"}var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zr="~~local_forage_type~",Ft=/^~~local_forage_type~([^~]+)~/,Me="__lfsc__:",Oe=Me.length,Fe="arbf",Xe="blob",Xt="si08",Gt="ui08",Wt="uic8",zt="si16",Vt="si32",Kt="ur16",Yt="ui32",Qt="fl32",qt="fl64",Jt=Oe+Fe.length,Zt=Object.prototype.toString;function jt(t){var o=t.length*.75,n=t.length,s,c=0,i,l,m,d;t[t.length-1]==="="&&(o--,t[t.length-2]==="="&&o--);var h=new ArrayBuffer(o),p=new Uint8Array(h);for(s=0;s<n;s+=4)i=oe.indexOf(t[s]),l=oe.indexOf(t[s+1]),m=oe.indexOf(t[s+2]),d=oe.indexOf(t[s+3]),p[c++]=i<<2|l>>4,p[c++]=(l&15)<<4|m>>2,p[c++]=(m&3)<<6|d&63;return h}function Ge(t){var o=new Uint8Array(t),n="",s;for(s=0;s<o.length;s+=3)n+=oe[o[s]>>2],n+=oe[(o[s]&3)<<4|o[s+1]>>4],n+=oe[(o[s+1]&15)<<2|o[s+2]>>6],n+=oe[o[s+2]&63];return o.length%3===2?n=n.substring(0,n.length-1)+"=":o.length%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function jr(t,o){var n="";if(t&&(n=Zt.call(t)),t&&(n==="[object ArrayBuffer]"||t.buffer&&Zt.call(t.buffer)==="[object ArrayBuffer]")){var s,c=Me;t instanceof ArrayBuffer?(s=t,c+=Fe):(s=t.buffer,n==="[object Int8Array]"?c+=Xt:n==="[object Uint8Array]"?c+=Gt:n==="[object Uint8ClampedArray]"?c+=Wt:n==="[object Int16Array]"?c+=zt:n==="[object Uint16Array]"?c+=Kt:n==="[object Int32Array]"?c+=Vt:n==="[object Uint32Array]"?c+=Yt:n==="[object Float32Array]"?c+=Qt:n==="[object Float64Array]"?c+=qt:o(new Error("Failed to get type for BinaryArray"))),o(c+Ge(s))}else if(n==="[object Blob]"){var i=new FileReader;i.onload=function(){var l=Zr+t.type+"~"+Ge(this.result);o(Me+Xe+l)},i.readAsArrayBuffer(t)}else try{o(JSON.stringify(t))}catch(l){console.error("Couldn't convert value into a JSON string: ",t),o(null,l)}}function en(t){if(t.substring(0,Oe)!==Me)return JSON.parse(t);var o=t.substring(Jt),n=t.substring(Oe,Jt),s;if(n===Xe&&Ft.test(o)){var c=o.match(Ft);s=c[1],o=o.substring(c[0].length)}var i=jt(o);switch(n){case Fe:return i;case Xe:return V([i],{type:s});case Xt:return new Int8Array(i);case Gt:return new Uint8Array(i);case Wt:return new Uint8ClampedArray(i);case zt:return new Int16Array(i);case Kt:return new Uint16Array(i);case Vt:return new Int32Array(i);case Yt:return new Uint32Array(i);case Qt:return new Float32Array(i);case qt:return new Float64Array(i);default:throw new Error("Unkown type: "+n)}}var We={serialize:jr,deserialize:en,stringToBuffer:jt,bufferToString:Ge};function er(t,o,n,s){t.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,s)}function tn(t){var o=this,n={db:null};if(t)for(var s in t)n[s]=typeof t[s]!="string"?t[s].toString():t[s];var c=new y(function(i,l){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(m){return l(m)}n.db.transaction(function(m){er(m,n,function(){o._dbInfo=n,i()},function(d,h){l(h)})},l)});return n.serializer=We,c}function ie(t,o,n,s,c,i){t.executeSql(n,s,c,function(l,m){m.code===m.SYNTAX_ERR?l.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[o.storeName],function(d,h){h.rows.length?i(d,m):er(d,o,function(){d.executeSql(n,s,c,i)},i)},i):i(l,m)},i)}function rn(t,o){var n=this;t=$(t);var s=new y(function(c,i){n.ready().then(function(){var l=n._dbInfo;l.db.transaction(function(m){ie(m,l,"SELECT * FROM "+l.storeName+" WHERE key = ? LIMIT 1",[t],function(d,h){var p=h.rows.length?h.rows.item(0).value:null;p&&(p=l.serializer.deserialize(p)),c(p)},function(d,h){i(h)})})}).catch(i)});return S(s,o),s}function nn(t,o){var n=this,s=new y(function(c,i){n.ready().then(function(){var l=n._dbInfo;l.db.transaction(function(m){ie(m,l,"SELECT * FROM "+l.storeName,[],function(d,h){for(var p=h.rows,x=p.length,w=0;w<x;w++){var _=p.item(w),H=_.value;if(H&&(H=l.serializer.deserialize(H)),H=t(H,_.key,w+1),H!==void 0){c(H);return}}c()},function(d,h){i(h)})})}).catch(i)});return S(s,o),s}function tr(t,o,n,s){var c=this;t=$(t);var i=new y(function(l,m){c.ready().then(function(){o===void 0&&(o=null);var d=o,h=c._dbInfo;h.serializer.serialize(o,function(p,x){x?m(x):h.db.transaction(function(w){ie(w,h,"INSERT OR REPLACE INTO "+h.storeName+" (key, value) VALUES (?, ?)",[t,p],function(){l(d)},function(_,H){m(H)})},function(w){if(w.code===w.QUOTA_ERR){if(s>0){l(tr.apply(c,[t,d,n,s-1]));return}m(w)}})})}).catch(m)});return S(i,n),i}function an(t,o,n){return tr.apply(this,[t,o,n,1])}function on(t,o){var n=this;t=$(t);var s=new y(function(c,i){n.ready().then(function(){var l=n._dbInfo;l.db.transaction(function(m){ie(m,l,"DELETE FROM "+l.storeName+" WHERE key = ?",[t],function(){c()},function(d,h){i(h)})})}).catch(i)});return S(s,o),s}function sn(t){var o=this,n=new y(function(s,c){o.ready().then(function(){var i=o._dbInfo;i.db.transaction(function(l){ie(l,i,"DELETE FROM "+i.storeName,[],function(){s()},function(m,d){c(d)})})}).catch(c)});return S(n,t),n}function cn(t){var o=this,n=new y(function(s,c){o.ready().then(function(){var i=o._dbInfo;i.db.transaction(function(l){ie(l,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(m,d){var h=d.rows.item(0).c;s(h)},function(m,d){c(d)})})}).catch(c)});return S(n,t),n}function un(t,o){var n=this,s=new y(function(c,i){n.ready().then(function(){var l=n._dbInfo;l.db.transaction(function(m){ie(m,l,"SELECT key FROM "+l.storeName+" WHERE id = ? LIMIT 1",[t+1],function(d,h){var p=h.rows.length?h.rows.item(0).key:null;c(p)},function(d,h){i(h)})})}).catch(i)});return S(s,o),s}function fn(t){var o=this,n=new y(function(s,c){o.ready().then(function(){var i=o._dbInfo;i.db.transaction(function(l){ie(l,i,"SELECT key FROM "+i.storeName,[],function(m,d){for(var h=[],p=0;p<d.rows.length;p++)h.push(d.rows.item(p).key);s(h)},function(m,d){c(d)})})}).catch(c)});return S(n,t),n}function ln(t){return new y(function(o,n){t.transaction(function(s){s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,i){for(var l=[],m=0;m<i.rows.length;m++)l.push(i.rows.item(m).name);o({db:t,storeNames:l})},function(c,i){n(i)})},function(s){n(s)})})}function mn(t,o){o=Y.apply(this,arguments);var n=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var s=this,c;return t.name?c=new y(function(i){var l;t.name===n.name?l=s._dbInfo.db:l=openDatabase(t.name,"","",0),t.storeName?i({db:l,storeNames:[t.storeName]}):i(ln(l))}).then(function(i){return new y(function(l,m){i.db.transaction(function(d){function h(_){return new y(function(H,F){d.executeSql("DROP TABLE IF EXISTS "+_,[],function(){H()},function(O,J){F(J)})})}for(var p=[],x=0,w=i.storeNames.length;x<w;x++)p.push(h(i.storeNames[x]));y.all(p).then(function(){l()}).catch(function(_){m(_)})},function(d){m(d)})})}):c=y.reject("Invalid arguments"),S(c,o),c}var dn={_driver:"webSQLStorage",_initStorage:tn,_support:Jr(),iterate:nn,getItem:rn,setItem:an,removeItem:on,clear:sn,length:cn,key:un,keys:fn,dropInstance:mn};function hn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function rr(t,o){var n=t.name+"/";return t.storeName!==o.storeName&&(n+=t.storeName+"/"),n}function pn(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(o){return!0}}function vn(){return!pn()||localStorage.length>0}function bn(t){var o=this,n={};if(t)for(var s in t)n[s]=t[s];return n.keyPrefix=rr(t,o._defaultConfig),vn()?(o._dbInfo=n,n.serializer=We,y.resolve()):y.reject()}function gn(t){var o=this,n=o.ready().then(function(){for(var s=o._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var i=localStorage.key(c);i.indexOf(s)===0&&localStorage.removeItem(i)}});return S(n,t),n}function yn(t,o){var n=this;t=$(t);var s=n.ready().then(function(){var c=n._dbInfo,i=localStorage.getItem(c.keyPrefix+t);return i&&(i=c.serializer.deserialize(i)),i});return S(s,o),s}function En(t,o){var n=this,s=n.ready().then(function(){for(var c=n._dbInfo,i=c.keyPrefix,l=i.length,m=localStorage.length,d=1,h=0;h<m;h++){var p=localStorage.key(h);if(p.indexOf(i)===0){var x=localStorage.getItem(p);if(x&&(x=c.serializer.deserialize(x)),x=t(x,p.substring(l),d++),x!==void 0)return x}}});return S(s,o),s}function Ln(t,o){var n=this,s=n.ready().then(function(){var c=n._dbInfo,i;try{i=localStorage.key(t)}catch(l){i=null}return i&&(i=i.substring(c.keyPrefix.length)),i});return S(s,o),s}function xn(t){var o=this,n=o.ready().then(function(){for(var s=o._dbInfo,c=localStorage.length,i=[],l=0;l<c;l++){var m=localStorage.key(l);m.indexOf(s.keyPrefix)===0&&i.push(m.substring(s.keyPrefix.length))}return i});return S(n,t),n}function Tn(t){var o=this,n=o.keys().then(function(s){return s.length});return S(n,t),n}function Pn(t,o){var n=this;t=$(t);var s=n.ready().then(function(){var c=n._dbInfo;localStorage.removeItem(c.keyPrefix+t)});return S(s,o),s}function Sn(t,o,n){var s=this;t=$(t);var c=s.ready().then(function(){o===void 0&&(o=null);var i=o;return new y(function(l,m){var d=s._dbInfo;d.serializer.serialize(o,function(h,p){if(p)m(p);else try{localStorage.setItem(d.keyPrefix+t,h),l(i)}catch(x){(x.name==="QuotaExceededError"||x.name==="NS_ERROR_DOM_QUOTA_REACHED")&&m(x),m(x)}})})});return S(c,n),c}function Mn(t,o){if(o=Y.apply(this,arguments),t=typeof t!="function"&&t||{},!t.name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var s=this,c;return t.name?c=new y(function(i){t.storeName?i(rr(t,s._defaultConfig)):i(t.name+"/")}).then(function(i){for(var l=localStorage.length-1;l>=0;l--){var m=localStorage.key(l);m.indexOf(i)===0&&localStorage.removeItem(m)}}):c=y.reject("Invalid arguments"),S(c,o),c}var Cn={_driver:"localStorageWrapper",_initStorage:bn,_support:hn(),iterate:En,getItem:yn,setItem:Sn,removeItem:Pn,clear:gn,length:Tn,key:Ln,keys:xn,dropInstance:Mn},wn=function(o,n){return o===n||typeof o=="number"&&typeof n=="number"&&isNaN(o)&&isNaN(n)},Rn=function(o,n){for(var s=o.length,c=0;c<s;){if(wn(o[c],n))return!0;c++}return!1},nr=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},be={},ar={},le={INDEXEDDB:qr,WEBSQL:dn,LOCALSTORAGE:Cn},In=[le.INDEXEDDB._driver,le.WEBSQL._driver,le.LOCALSTORAGE._driver],Ce=["dropInstance"],ze=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ce),An={description:"",driver:In.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function _n(t,o){t[o]=function(){var n=arguments;return t.ready().then(function(){return t[o].apply(t,n)})}}function Ve(){for(var t=1;t<arguments.length;t++){var o=arguments[t];if(o)for(var n in o)o.hasOwnProperty(n)&&(nr(o[n])?arguments[0][n]=o[n].slice():arguments[0][n]=o[n])}return arguments[0]}var Bn=function(){function t(o){R(this,t);for(var n in le)if(le.hasOwnProperty(n)){var s=le[n],c=s._driver;this[n]=c,be[c]||this.defineDriver(s)}this._defaultConfig=Ve({},An),this._config=Ve({},this._defaultConfig,o),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(n){if((typeof n>"u"?"undefined":L(n))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var s in n){if(s==="storeName"&&(n[s]=n[s].replace(/\W/g,"_")),s==="version"&&typeof n[s]!="number")return new Error("Database version must be a number.");this._config[s]=n[s]}return"driver"in n&&n.driver?this.setDriver(this._config.driver):!0}else return typeof n=="string"?this._config[n]:this._config},t.prototype.defineDriver=function(n,s,c){var i=new y(function(l,m){try{var d=n._driver,h=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!n._driver){m(h);return}for(var p=ze.concat("_initStorage"),x=0,w=p.length;x<w;x++){var _=p[x],H=!Rn(Ce,_);if((H||n[_])&&typeof n[_]!="function"){m(h);return}}var F=function(){for(var ge=function(Nn){return function(){var kn=new Error("Method "+Nn+" is not implemented by the current driver"),or=y.reject(kn);return S(or,arguments[arguments.length-1]),or}},Ke=0,Dn=Ce.length;Ke<Dn;Ke++){var Ye=Ce[Ke];n[Ye]||(n[Ye]=ge(Ye))}};F();var O=function(ge){be[d]&&console.info("Redefining LocalForage driver: "+d),be[d]=n,ar[d]=ge,l()};"_support"in n?n._support&&typeof n._support=="function"?n._support().then(O,m):O(!!n._support):O(!0)}catch(J){m(J)}});return U(i,s,c),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(n,s,c){var i=be[n]?y.resolve(be[n]):y.reject(new Error("Driver not found."));return U(i,s,c),i},t.prototype.getSerializer=function(n){var s=y.resolve(We);return U(s,n),s},t.prototype.ready=function(n){var s=this,c=s._driverSet.then(function(){return s._ready===null&&(s._ready=s._initDriver()),s._ready});return U(c,n,n),c},t.prototype.setDriver=function(n,s,c){var i=this;nr(n)||(n=[n]);var l=this._getSupportedDrivers(n);function m(){i._config.driver=i.driver()}function d(x){return i._extend(x),m(),i._ready=i._initStorage(i._config),i._ready}function h(x){return function(){var w=0;function _(){for(;w<x.length;){var H=x[w];return w++,i._dbInfo=null,i._ready=null,i.getDriver(H).then(d).catch(_)}m();var F=new Error("No available storage method found.");return i._driverSet=y.reject(F),i._driverSet}return _()}}var p=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=p.then(function(){var x=l[0];return i._dbInfo=null,i._ready=null,i.getDriver(x).then(function(w){i._driver=w._driver,m(),i._wrapLibraryMethodsWithReady(),i._initDriver=h(l)})}).catch(function(){m();var x=new Error("No available storage method found.");return i._driverSet=y.reject(x),i._driverSet}),U(this._driverSet,s,c),this._driverSet},t.prototype.supports=function(n){return!!ar[n]},t.prototype._extend=function(n){Ve(this,n)},t.prototype._getSupportedDrivers=function(n){for(var s=[],c=0,i=n.length;c<i;c++){var l=n[c];this.supports(l)&&s.push(l)}return s},t.prototype._wrapLibraryMethodsWithReady=function(){for(var n=0,s=ze.length;n<s;n++)_n(this,ze[n])},t.prototype.createInstance=function(n){return new t(n)},t}(),Hn=new Bn;f.exports=Hn},{"3":3}]},{},[4])(4)})});var qe=r=>{let e=typeof r;return r!==null&&(e==="object"||e==="function")},Qe=new Set(["__proto__","prototype","constructor"]),Qn=new Set("0123456789");function fr(r){let e=[],a="",u="start",f=!1;for(let E of r)switch(E){case"\\":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");f&&(a+=E),u="property",f=!f;break;case".":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="property";break}if(f){f=!1,a+=E;break}if(Qe.has(a))return[];e.push(a),a="",u="property";break;case"[":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="index";break}if(f){f=!1,a+=E;break}if(u==="property"){if(Qe.has(a))return[];e.push(a),a=""}u="index";break;case"]":if(u==="index"){e.push(Number.parseInt(a,10)),a="",u="indexEnd";break}if(u==="indexEnd")throw new Error("Invalid character after an index");default:if(u==="index"&&!Qn.has(E))throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");u==="start"&&(u="property"),f&&(f=!1,a+="\\"),a+=E}switch(f&&(a+="\\"),u){case"property":{if(Qe.has(a))return[];e.push(a);break}case"index":throw new Error("Index was not closed");case"start":{e.push("");break}}return e}function lr(r,e){if(typeof e!="number"&&Array.isArray(r)){let a=Number.parseInt(e,10);return Number.isInteger(a)&&r[a]===r[e]}return!1}function qn(r,e){if(lr(r,e))throw new Error("Cannot use string index")}function M(r,e,a){if(!qe(r)||typeof e!="string")return a===void 0?r:a;let u=fr(e);if(u.length===0)return a;for(let f=0;f<u.length;f++){let E=u[f];if(lr(r,E)?r=f===u.length-1?void 0:null:r=r[E],r==null){if(f!==u.length-1)return a;break}}return r===void 0?a:r}function mr(r,e,a){if(!qe(r)||typeof e!="string")return r;let u=r,f=fr(e);for(let E=0;E<f.length;E++){let L=f[E];qn(r,L),E===f.length-1?r[L]=a:qe(r[L])||(r[L]=typeof f[E+1]=="number"?[]:{}),r=r[L]}return u}var ke=Yn(hr());var B=r=>document.getElementById(r),pr=(r,e)=>{if(document.visibilityState==="hidden")return!1;let a=Object.entries(e);for(let[u,f]of a)r[u]=f;return!0},v=(r,e)=>document.visibilityState==="hidden"?!1:pr(B(r),e),C=(r,e)=>document.visibilityState==="hidden"?!1:pr(B(r).style,e);var ae=(r,e)=>r.querySelector(e),Jn=(r,e)=>{let a=B("confirmationBox"),u=B("confirmWrapper"),f=ae(document,"#confirm"),E=ae(document,"#transparentBG"),L=ae(f,"#okConfirm"),R=ae(f,"#cancelConfirm");a.style.display="block",u.style.display="block",E.style.display="block",ae(f,"p").textContent=r,f.focus();let P=({target:k})=>{let V=k;return L.removeEventListener("click",P),R.removeEventListener("click",P),f.removeEventListener("keyup",D),a.style.display="none",u.style.display="none",E.style.display="none",e(V===L)},D=k=>k.key==="Enter"||k.key===" "?P({target:L}):k.key==="Escape"?P({target:R}):k.preventDefault();L.addEventListener("click",P),R.addEventListener("click",P),f.addEventListener("keyup",D)},Zn=(r,e)=>{let a=B("confirmationBox"),u=B("alertWrapper"),f=ae(document,"#transparentBG"),E=ae(document,"#alert"),L=ae(E,"#okAlert");a.style.display="block",u.style.display="block",f.style.display="block",ae(E,"p").textContent=r,E.focus();let R=()=>{L.removeEventListener("click",R),E.removeEventListener("keyup",P),a.style.display="none",u.style.display="none",f.style.display="none",e(void 0)},P=D=>(D.key==="Enter"||D.key===" ")&&R();L.addEventListener("click",R),E.addEventListener("keyup",P)};var Z=r=>new Promise(e=>Zn(r,e));var Re=r=>new Promise(e=>Jn(r,e));var b=(r,e=0)=>{if(r<0)return"-"+b(-r,e);if(r>=1e6){let D=Math.floor(Math.log10(r));return r/=Math.pow(10,D),b(r,2)+"e"+b(D)}let a=Math.floor(r),u=r-a,f=a.toLocaleString(),E=e>0&&r!==0,L=Math.pow(10,e)*u,R=1e-6;Math.ceil(L)-L<R&&(L=Math.ceil(L));let P=E?Math.floor(L).toString():"";if(P!==""){for(;P.length<e;)P="0"+P;P="."+P}return f+P};var vr=(r,e,a,u=1)=>Math.ceil(r*(Math.pow(a,u)-Math.pow(e,u)));var Ze=r=>new Promise(e=>setTimeout(e,r));var jn={HP:80,MP:10,ATK:5,STR:0,DEF:0,ARMOR:0,CRITCHANCE:0,CRITDAMAGE:100},br=class{constructor(e,a){this.baseStats=j({},e),this.currStats=j({},e),this.attackRate=a,this.delay=0,this.updateHTML("Initialize")}decreaseDelay(e){this.delay-=e}computeArmorDamageReduction(){return this.currStats.ARMOR}computeDefenseDamageDivisor(){let e=this.baseStats.DEF;return 1+e/100}computeActualDamageReceived(e){let a=this.computeArmorDamageReduction(),u=this.computeDefenseDamageDivisor();return Math.max(0,e-a/u)}takeDamage(e){let a=this.computeActualDamageReceived(e);this.currStats.HP-=a,this.currStats.HP<0&&(this.currStats=j({},this.baseStats)),this.updateHTML("Damage")}computeStrengthModifier(){let e=this.currStats.STR;return 1+e*(1-this.currStats.HP/this.currStats.HP)/100}computeDamageBase(){return 1+this.currStats.ATK}computeCriticalDamage(){return this.currStats.CRITDAMAGE/100}computeBaseDamageSent(){let e=this.computeDamageBase(),a=this.computeStrengthModifier(),u=1;return Math.random()<this.currStats.CRITCHANCE&&(u=this.computeCriticalDamage()),e*a*u}attack(){if(this.delay>0)return;let e=this.computeBaseDamageSent();Ie.takeDamage(e),this.delay=this.attackRate}computeHPBarWidth(){return 100*(this.currStats.HP/this.baseStats.HP)}computeMPBarWidth(){return 100*(this.currStats.MP/this.baseStats.MP)}updateHTML(e){if(e==="Initialize"&&(v("playerATK",{textContent:`ATK ${this.baseStats.ATK}`}),v("playerSTR",{textContent:`STR ${this.baseStats.STR}`}),v("playerDEF",{textContent:`DEF ${this.baseStats.DEF}`}),v("playerARMOR",{textContent:`ARMOR ${this.baseStats.ARMOR}`}),v("playerCritChance",{textContent:`CritChance ${this.baseStats.CRITCHANCE}`}),v("playerCritDamage",{textContent:`CritDamage ${this.baseStats.CRITDAMAGE}`})),e==="Initialize"||e==="Damage"){v("playerHPText",{textContent:`${b(this.currStats.HP,2)}/${b(this.baseStats.HP)}`});let a=this.computeHPBarWidth();C("playerHPProgression",{width:`${a}%`})}if(e==="Initialize"||e==="Ability"){v("playerMPText",{textContent:`${b(this.currStats.MP,2)}/${b(this.baseStats.MP)}`});let a=this.computeMPBarWidth();C("playerMPProgression",{width:`${a}%`})}}},me=new br(jn,1);var je=class{constructor(e,a){this.baseStats=j({},e),this.currStats=j({},e),this.attackRate=a,this.delay=this.attackRate,this.level=this.computeGeneratedLevel(),this.updateHTML("Initialize")}generateAttacks(e){this.delay-=e,this.delay<0&&(this.makeMove(),this.delay=this.attackRate)}computeGeneratedLevel(){let e=1;return e+=Math.min(25,3*Math.log10(1+this.baseStats.HP)),e+=Math.min(25,3*Math.log10(1+this.baseStats.ATK)),e+=Math.min(25,3*Math.log10(1+this.baseStats.DEF)),e+=Math.min(10,this.baseStats.CRITCHANCE/10),e+=Math.min(13,4*Math.log10(this.baseStats.CRITDAMAGE/100)),e}computeArmorDamageReduction(){return this.currStats.ARMOR*(this.currStats.HP/this.baseStats.HP)}computeDefenseDamageDivisor(){let e=this.currStats.DEF;return 1+e/100}computeActualDamageReceived(e){let a=this.computeArmorDamageReduction(),u=this.computeDefenseDamageDivisor();return Math.max(0,e-a/u)}takeDamage(e){let a=this.computeActualDamageReceived(e);this.currStats.HP-=a,this.currStats.HP<0&&(this.currStats=j({},this.baseStats)),this.updateHTML("Damage")}computeStrengthModifier(){let e=this.currStats.STR;return 1+e*(1-this.currStats.HP/this.currStats.HP)/100}computeDamageBase(){return 1+this.currStats.ATK}computeCriticalDamage(){return this.currStats.CRITDAMAGE/100}computeBaseDamageSent(){let e=this.computeDamageBase(),a=this.computeStrengthModifier(),u=1;return Math.random()<this.currStats.CRITCHANCE&&(u=this.computeCriticalDamage()),e*a*u}computeHPBarWidth(){return 100*(this.currStats.HP/this.baseStats.HP)}computeMPBarWidth(){return 100*(this.currStats.MP/this.baseStats.MP)}makeMove(){this.enemyAI()}updateHTML(e){if(e==="Initialize"&&(v("enemyATK",{textContent:`ATK ${this.baseStats.ATK}`}),v("enemySTR",{textContent:`STR ${this.baseStats.STR}`}),v("enemyDEF",{textContent:`DEF ${this.baseStats.DEF}`}),v("enemyARMOR",{textContent:`ARMOR ${this.baseStats.ARMOR}`}),v("enemyCritChance",{textContent:`CritChance ${this.baseStats.CRITCHANCE}`}),v("enemyCritDamage",{textContent:`CritDamage ${this.baseStats.CRITDAMAGE}`})),e==="Initialize"||e==="Damage"){v("enemyHPText",{textContent:`${b(this.currStats.HP,2)}/${b(this.baseStats.HP)}`});let a=this.computeHPBarWidth();C("enemyHPProgression",{width:`${a}%`})}if(e==="Initialize"||e==="Ability"){v("enemyMPText",{textContent:`${b(this.currStats.MP,2)}/${b(this.baseStats.MP)}`});let a=this.computeMPBarWidth();C("enemyMPProgression",{width:`${a}%`})}}};var gr=class extends je{constructor(e,a){super(e,a);this.enemyType="Aggressive";this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();e<.25&&this.currStats.HP/this.baseStats.HP<.22&&this.currStats.MP>=2?(this.heal(),this.currStats.MP-=2,this.updateHTML("Damage"),this.updateHTML("Ability"),v("enemyMove",{textContent:"HEAL"})):e<.33&&this.currStats.MP>=1?(await this.doubleHit(),this.currStats.MP-=1,this.updateHTML("Ability"),v("enemyMove",{textContent:"DoubleHit"})):e<.5&&this.currStats.MP>=2?(await this.tripleHit(),this.currStats.MP-=2,this.updateHTML("Ability"),v("enemyMove",{textContent:"TripleHit"})):(await this.attack(),v("enemyMove",{textContent:"Attack"}))}heal(){this.currStats.HP+=this.baseStats.HP*(.3+.5*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async attack(){let e=this.computeBaseDamageSent();me.takeDamage(e)}async doubleHit(){for(let e=0;e<2;e++)await this.attack(),await Ze(333)}async tripleHit(){for(let e=0;e<3;e++)await this.attack(),await Ze(250)}variantSpecificHTML(e){e==="Initialize"&&v("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${b(this.level)}`})}},ea={HP:20,MP:99,ATK:2,STR:0,DEF:0,ARMOR:0,CRITCHANCE:5,CRITDAMAGE:144},Ie=new gr(ea,1);var ce=r=>{C("innerTesting",{border:"none"}),C("mainTab",{display:"none"}),C("upgradeTab",{display:"none"}),C("talentsTab",{display:"none"}),C("duelingTab",{display:"none"}),r==="Main"?C("mainTab",{display:"block"}):r==="Upgrades"?C("upgradeTab",{display:"block"}):r==="Talents"?C("talentsTab",{display:"block"}):r==="Dueling"&&(C("duelingTab",{display:"block"}),C("innerTesting",{border:"2px solid grey"}))},Ae=(r,e)=>{e?C("progression",{backgroundColor:"gold"}):C("progression",{backgroundColor:"turquoise"}),setTimeout(()=>{C("progression",{backgroundColor:de(r)})},500),v("refresh-crit-counter",{textContent:b(r.criticalHitsThisRefresh)}),v("refresh-crit-fragments",{textContent:b(100*r.criticalHitsThisRefresh*r.coinUpgrades.barAgitation.upgradeEffect(),2)}),r.barFragments.updateHTML()},_e=r=>{C("progression",{backgroundColor:"cyan"}),setTimeout(()=>{C("progression",{backgroundColor:de(r)})},1e3),v("coinWorth",{textContent:`Worth ${b(r.coinValueCache)} coins`}),r.coinValueCache>0?C("coinWorth",{color:"gold"}):C("coinWorth",{color:"grey"}),v("refresh-crit-counter",{textContent:b(r.criticalHitsThisRefresh)}),v("refresh-counter",{textContent:b(r.refreshCount)})};var ta=10,Be=0,et=0,Ee=r=>{let e=0;return e+=ta*Math.pow(r.barLevel+1,2),e*=Math.min(1,(r.barLevel+20)/40),e*=Math.max(1,1+(r.barLevel-20)/10),r.barLevel>40&&(e*=Math.pow(2,1/10*(r.barLevel-40))),r.barLevel>100&&(e*=Math.pow(2,1/10*(r.barLevel-100))),r.barLevel>200&&(e*=Math.pow(2,1/10*(r.barLevel-200))),r.barLevel%5===0&&(e*=Math.max(1,1/2*r.barLevel/10)),e},ra=r=>{let e=0;return r.barLevel>=10&&(e+=1-Math.pow(Math.E,-r.barLevel/200)),e>=.9999?1e4:1/(1-e)},na=r=>{let e=ra(r);return Math.max(1,e*(1-r.barEXP/r.barTNL))},tt=(r,e)=>{if(r==null)return;let a=1;if(a+=e.coinUpgrades.barSpeed.upgradeEffect(),a*=e.barFragments.unspentBonus(),a*=Math.pow(1+e.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,e.barEXP/e.barTNL))),a/=na(e),a*=e.talents.barSpeed.talentEffect(),a*=Math.pow(1+e.coinUpgrades.barEmpowerment.upgradeEffect(),e.barLevel),Math.random()<ot(e)){let E=!1;a*=e.coinUpgrades.barVibration.upgradeEffect(),e.talents.barCriticalChance.gainEXP(r),e.criticalHits+=1,e.criticalHitsThisRefresh+=1,Math.random()<e.coinUpgrades.barResonance.upgradeEffect()&&(a*=3,e.coins.gain(Math.floor(e.barLevel/5)+3),E=!0),Ae(e,E)}let f=a*r;e.barEXP+=f,Be+=f,v("perSecCurr",{textContent:`+${b(Be,2)} this sec`})},ue=(r,e)=>Math.min(100,.1*Math.floor(1e3*r/e)),he=r=>{C("progression",{width:`${r}%`})},de=r=>{if(r.barLevel%5===0)return r.barLevel>=320?"#FF0000":`#${(128+4*Math.floor(r.barLevel/10)).toString(16).padStart(2,"0")}0000`;if(r.barLevel>=128)return"#FFFFFF";let e=(128+r.barLevel).toString(16).padStart(2,"0"),a=(2*r.barLevel).toString(16).padStart(2,"0"),u=(128+r.barLevel).toString(16).padStart(2,"0");return`#${e}${a}${u}`},rt=r=>{r.coins.gain(r.coinValueCache),r.coinValueCache=at(r),r.barEXP-=r.barTNL,r.barLevel+=1,r.barLevel>r.highestBarLevel&&(r.highestBarLevel=r.barLevel);let e=de(r);C("progression",{backgroundColor:e}),r.barTNL=Ee(r),r.barEXP/=10,r.barEXP=Math.min(r.barEXP,Math.floor(r.barTNL/10));let a=ue(r.barEXP,r.barTNL);he(a),v("coinWorth",{textContent:`Worth ${b(r.coinValueCache)} coins`}),r.barFragments.updateHTML(),r.barLevel===20&&(r.talents.barCriticalChance.updateHTML("Level20"),r.talents.barSpeed.updateHTML("Level20"))},nt=r=>{v("level",{textContent:`Level: ${r.barLevel}`}),v("exp",{textContent:`EXP: ${b(r.barEXP)}/${b(r.barTNL)}`})},yr=r=>{et=Be,Be=0,v("perSecPrev",{textContent:`+${b(et,2)} prev sec`}),r.talents.barCriticalChance.updateHTML("Time"),r.talents.barSpeed.gainEXP(et),r.talents.barSpeed.updateHTML("Time"),r.talents.coinGain.updateHTML("Time")},at=r=>{let e=0,a=1+r.barLevel;a>r.highestBarLevel&&(e+=3),a%5===0&&(e+=Math.floor(a/5)+3,Math.random()<.5&&a>25&&(e=0)),a%10===0&&(e+=Math.floor(a/2)),a%50===0&&(e+=Math.floor(a/2)),a%100===0&&(e+=Math.floor(a)),e>100&&(e=10*Math.pow(e,1/2)),e*=1+r.talents.coinGain.talentEffect();let u=e-Math.floor(e);Math.random()<u&&(e+=1),e=Math.floor(e);let f=B("coinWorth");return f.style.color=e>0?"gold":"grey",e},ot=r=>r.coinUpgrades.barReverberation.upgradeEffect()+r.talents.barCriticalChance.talentEffect();var Le=class{constructor(e=0,a){this.amount=e;this.player=a;this.amount=e,this.updateHTML()}spend(e){this.amount>=e&&(this.amount-=e,this.updateHTML())}gain(e){this.amount+=e,this.updateHTML(),this.updateOnGain(e)}set(e){this.amount=e,this.updateHTML()}valueOf(){return{amount:this.amount}}};var it=class extends Le{updateHTML(){v("gold-amount",{textContent:b(this.amount)})}updateOnGain(e){e>0&&this.player.talents.coinGain.gainEXP(e)}};var Er="coins",st=(r,e)=>{var u,f;let a=(u=M(r,Er))!=null?u:M(e,Er);return new it((f=a==null?void 0:a.amount)!=null?f:0,e)};var ct=class extends Le{updateHTML(){v("fragment-amount",{textContent:b(this.amount)}),v("fragment-bonus",{textContent:b(this.amount)}),v("fragment-gain",{textContent:b(this.getAmountOnRefresh())})}getAmountOnRefresh(){let e=this.player.barLevel,a=100*Math.pow(1.07,-5);return a*=Math.pow(1.07,e),a*=Math.pow(3,Math.floor(e/100)),a*=1+this.player.criticalHitsThisRefresh*this.player.coinUpgrades.barAgitation.upgradeEffect(),a*=1+this.player.coinUpgrades.barReinforcement.upgradeEffect()*this.player.barLevel,Math.floor(a)}unspentBonus(){return 1+1/100*this.amount}updateOnGain(){}};var Lr="barFragments",ut=(r,e)=>{var u,f;let a=(u=M(r,Lr))!=null?u:M(e,Lr);return new ct((f=a==null?void 0:a.amount)!=null?f:0,e)};var xe=class{constructor(e,a,u){this.level=e;this.cost=a;this.player=u}};var ee=class extends xe{constructor(e,a,u){super(e,a,u);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(e,a){a.shiftKey&&(e=-1,e=Math.floor(this.player.coins.amount/this.cost)),this.maxLevel!==-1&&(e=Math.min(e,this.maxLevel-this.level)),this.cost*e<=this.player.coins.amount&&(this.player.coins.spend(this.cost*e),this.level+=e,this.updateHTML())}valueOf(){return{level:this.level,cost:this.cost,maxLevel:this.maxLevel}}},W={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4,barAdoption:250,barEmpowerment:1e4,barReinforcement:2e4,barResonance:2e3},ft=class extends ee{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){v("coin-bar-speed-effect",{textContent:`+${b(this.upgradeEffect(),2)} Progress Per Second`}),v("coin-bar-speed-name",{textContent:`Bar Speed ${b(this.level)}`})}},lt=class extends ee{constructor(e,a,u){super(e,a,u);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?Math.pow(100,1/10)-1:(.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level))*((Math.pow(100,1/10)-1)/.5)}updateHTML(){v("coin-bar-momentum-effect",{textContent:`Up to ${b(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel?(v("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),C("coin-bar-momentum-name",{color:"orchid"})):v("coin-bar-momentum-name",{textContent:`Bar Momentum ${b(this.level)}/${b(this.maxLevel)}`})}},mt=class extends ee{constructor(e,a,u){super(e,a,u);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.01:.009*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+2e-4*Math.min(5,this.level)}updateHTML(){v("coin-bar-reverberation-effect",{textContent:`+${b(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel?(v("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),C("coin-bar-reverberation-name",{color:"orchid"})):v("coin-bar-reverberation-name",{textContent:`Bar Reverberation ${b(this.level)}/${b(this.maxLevel)}`})}},dt=class extends ee{constructor(e,a,u){super(e,a,u);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?2e3:100+1700*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+20*Math.min(10,this.level)}updateHTML(){v("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${b(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel?(v("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),C("coin-bar-vibration-name",{color:"orchid"})):v("coin-bar-vibration-name",{textContent:`Bar Vibration ${b(this.level)}/${b(this.maxLevel)}`})}},ht=class extends ee{constructor(e,a,u){super(e,a,u);this.maxLevel=-1;this.updateHTML()}upgradeEffect(){return this.level/500}updateHTML(){v("coin-bar-agitation-effect",{textContent:`+${b(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT.`}),v("coin-bar-agitation-name",{textContent:`Bar Agitation ${b(this.level)}`})}},pt=class extends ee{constructor(e,a,u){super(e,a,u);this.maxLevel=200;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/100}updateHTML(){v("coin-bar-adoption-effect",{textContent:`+${b(100*this.upgradeEffect())}% Talent EXP`}),this.level===this.maxLevel?(v("coin-bar-adoption-name",{textContent:"Bar Adoption [MAX LEVEL]"}),C("coin-bar-adoption-name",{color:"orchid"})):v("coin-bar-adoption-name",{textContent:`Bar Adoption ${b(this.level)}/${b(this.maxLevel)}`})}},vt=class extends ee{constructor(e,a,u){super(e,a,u);this.maxLevel=100;this.capLevel(),this.updateHTML()}upgradeEffect(){return .02*this.level/100}updateHTML(){v("coin-bar-empowerment-effect",{textContent:`+${b(100*this.upgradeEffect(),2)}% Progress Speed per bar level: (1+x)^(level)`}),this.level===this.maxLevel?(v("coin-bar-empowerment-name",{textContent:"Bar Empowerment [MAX LEVEL]"}),C("coin-bar-empowerment-name",{color:"orchid"})):v("coin-bar-empowerment-name",{textContent:`Bar Empowerment ${b(this.level)}/${b(this.maxLevel)}`})}},bt=class extends ee{constructor(e,a,u){super(e,a,u);this.maxLevel=-1;this.updateHTML()}upgradeEffect(){return this.level/1e3}updateHTML(){v("coin-bar-reinforcement-effect",{textContent:`+${b(100*this.upgradeEffect(),2)}% Bar Fragments per bar level (1 + x * level)`}),v("coin-bar-reinforcement-name",{textContent:`Bar Reinforcement ${b(this.level)}`})}},gt=class extends ee{constructor(e,a,u){super(e,a,u);this.expoDivisor=500;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?1:1-Math.pow(Math.E,-this.level/this.expoDivisor)}updateHTML(){v("coin-bar-resonance-effect",{textContent:`On CRIT, ${b(100*this.upgradeEffect(),2)}% chance of SUPER
                             CRIT (3x damage and earn coins)`}),this.level===this.maxLevel?(v("coin-bar-resonance-name",{textContent:"Bar Resonance [MAX LEVEL]"}),C("coin-bar-resonance-name",{color:"orchid"})):v("coin-bar-resonance-name",{textContent:`Bar Resonance ${b(this.level)}/${b(this.maxLevel)}`})}};var xr="coinUpgrades.barSpeed",yt=(r,e)=>{var u,f;let a=(u=M(r,xr))!=null?u:M(e,xr);return new ft((f=a==null?void 0:a.level)!=null?f:0,W.barSpeed,e)};var Tr="coinUpgrades.barMomentum",Et=(r,e)=>{var u,f;let a=(u=M(r,Tr))!=null?u:M(e,Tr);return new lt((f=a==null?void 0:a.level)!=null?f:0,W.barMomentum,e)};var Pr="coinUpgrades.barReverberation",Lt=(r,e)=>{var u,f;let a=(u=M(r,Pr))!=null?u:M(e,Pr);return new mt((f=a==null?void 0:a.level)!=null?f:0,W.barReverberation,e)};var Sr="coinUpgrades.barVibration",xt=(r,e)=>{var u,f;let a=(u=M(r,Sr))!=null?u:M(e,Sr);return new dt((f=a==null?void 0:a.level)!=null?f:0,W.barVibration,e)};var Mr="coinUpgrades.barAgitation",Tt=(r,e)=>{var u,f;let a=(u=M(r,Mr))!=null?u:M(e,Mr);return new ht((f=a==null?void 0:a.level)!=null?f:0,W.barAgitation,e)};var Cr="coinUpgrades.barAdoption",Pt=(r,e)=>{var u,f;let a=(u=M(r,Cr))!=null?u:M(e,Cr);return new pt((f=a==null?void 0:a.level)!=null?f:0,W.barAdoption,e)};var wr="coinUpgrades.barEmpowerment",St=(r,e)=>{var u,f;let a=(u=M(r,wr))!=null?u:M(e,wr);return new vt((f=a==null?void 0:a.level)!=null?f:0,W.barEmpowerment,e)};var Rr="coinUpgrades.barReinforcement",Mt=(r,e)=>{var u,f;let a=(u=M(r,Rr))!=null?u:M(e,Rr);return new bt((f=a==null?void 0:a.level)!=null?f:0,W.barReinforcement,e)};var Ir="coinUpgrades.barResonance",Ct=(r,e)=>{var u,f;let a=(u=M(r,Ir))!=null?u:M(e,Ir);return new gt((f=a==null?void 0:a.level)!=null?f:0,W.barResonance,e)};var He=(r,e)=>{if(r==="Refresh"&&e.barLevel>=5){if(e.refreshTime<Te)return void Z(`Currently, refreshes have a ${b(Te)} second cooldown. Sorry!`);e.barFragments.set(e.barFragments.getAmountOnRefresh()),e.barEXP=0,e.barLevel=0,e.barTNL=Ee(e),he(ue(e.barEXP,e.barTNL)),e.barFragments.updateHTML(),e.talents.barCriticalChance.convertToPerm(),e.talents.barCriticalChance.updateHTML("Initialize"),e.talents.barSpeed.convertToPerm(),e.talents.barSpeed.updateHTML("Initialize"),e.talents.coinGain.convertToPerm(),e.talents.coinGain.updateHTML("Initialize"),e.refreshCount+=1,e.refreshTime=0,e.criticalHitsThisRefresh=0,e.coinValueCache=at(e),Ae(e,!1),_e(e)}else return void Z("You cannot refresh yet. Get to level 5 lol")};var wt=r=>r.barLevel>=20,De=class extends xe{constructor(e,a,u,f,E,L){super(e,a,L);this.investedFragments=u,this.permLevel=f,this.currEXP=E,this.currTNL=this.calculateTNL()}calculateTNL(){let e=vr(this.cost,this.level,this.level+1,2),a=[50,100,200,500,1e3,2e3,5e3,1e4];for(let u of a)this.level>=u&&(e*=2);return e}setEXP(e){this.currEXP=e,this.updateHTML("GainEXP")}globalTalentEXPMultipliers(){let e=1;return e*=this.sacrificeBoost(),e*=1+this.player.coinUpgrades.barAdoption.upgradeEffect(),e}gainEXP(e){if(!wt(this.player))return;let a=this.calculateEXPGain(e);this.currEXP+=a,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}subEXP(e){!wt(this.player)||(this.currEXP-=e)}levelUp(){let e=0;for(;this.currEXP>=this.currTNL&&!(e>=10);)this.level+=1,this.subEXP(this.currTNL),this.currTNL=this.calculateTNL(),e++;this.updateHTML("LevelUp")}computePermLevelGain(e){let a=0;return a+=Math.sqrt(e),a*=Math.min(4,Math.pow(this.player.refreshTime/300,2)),a=Math.min(e,a),Math.floor(a)}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}sacrificeBoost(){return 1+1/100*Math.pow(Math.log2(1+this.investedFragments/4),2)}async sacrificeFragments(){if(this.player.barFragments.amount<1e3)return void Z("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(this.player.barFragments.amount<=this.investedFragments)return void Z(`This bar needs more fragments than you can invest. You need ${b(this.investedFragments)}.`);await Re(`You will sacrifice ${b(this.player.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=this.player.barFragments.amount,this.player.refreshTime+=Te,He("Refresh",this.player),this.player.barFragments.set(0),this.updateHTML("Sacrifice"))}updateHTML(e){if(this.idHTML!==void 0){if(e==="Initialize"||e==="GainEXP"||e==="LevelUp"||e==="PermLevelUp"){v(`talent${this.idHTML}EXP`,{textContent:`EXP: ${b(this.currEXP)}/${b(this.currTNL)}`});let a=`${this.getBarWidth()}%`;C(`talent${this.idHTML}Progression`,{width:a})}(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp")&&v(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${b(this.level)}`}),(e==="Initialize"||e==="PermLevelUp")&&v(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${b(this.permLevel)}`}),(e==="Initialize"||e==="Time"||e==="LevelUp")&&v(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${b(this.computePermLevelGain(this.level))}`}),(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp"||e==="Level20")&&v(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()}),(e==="Initialize"||e==="Sacrifice")&&(v(`talent${this.idHTML}SacrificeAmount`,{textContent:b(this.investedFragments)}),v(`talent${this.idHTML}SacrificeMultiplier`,{textContent:b(this.sacrificeBoost(),3)}))}}valueOf(){return{level:this.level,cost:this.cost,investedFragments:this.investedFragments,permLevel:this.permLevel,currEXP:this.currEXP,idHTML:this.idHTML}}},pe={talentCriticalChance:10,talentProgressSpeed:10,talentCoinGain:1e3},Rt=class extends De{constructor(e,a,u,f,E,L){super(e,a,u,f,E,L);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(e){let a=5;return a*=e*1e3/Ne,a*=this.player.barLevel/10-1,a*=this.globalTalentEXPMultipliers(),a}talentEffect(){return wt(this.player)?.0025*(1-Math.pow(Math.E,-this.level/2500))+.0025*Math.min(250,this.level)/250+.0025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.0025*Math.min(500,this.level)/500:0}displayEffect(){return`+${b(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},It=class extends De{constructor(e,a,u,f,E,L){super(e,a,u,f,E,L);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(e){let a=Math.log10(1+e);return a*=this.player.barLevel/10-1,a*=this.globalTalentEXPMultipliers(),a}talentEffect(){return(1+this.level/25)*(1+this.permLevel/50)}displayEffect(){return`Progress Speed +${b(100*(this.talentEffect()-1),2)}%`}},At=class extends De{constructor(e,a,u,f,E,L){super(e,a,u,f,E,L);this.idHTML="CoinGain";this.updateHTML("Initialize")}calculateEXPGain(e){let a=2+Math.floor(Math.pow(e,2)/100+4*e);return a*=this.globalTalentEXPMultipliers(),a}talentEffect(){return Math.min(.4,this.level/1e3)+Math.min(.4,this.permLevel/2e3)+.2*(this.level*25+this.permLevel)/(2500+this.level*25+this.permLevel)+1*(this.level*25+this.permLevel)/(5e4+this.level*25+this.permLevel)}displayEffect(){return`Progress bar grants +${b(100*this.talentEffect(),2)}% coins!`}};var Ar="talents.barCriticalChance",_t=(r,e)=>{var u,f,E,L,R;let a=(u=M(r,Ar))!=null?u:M(e,Ar);return new Rt((f=a==null?void 0:a.level)!=null?f:0,pe.talentCriticalChance,(E=a==null?void 0:a.investedFragments)!=null?E:0,(L=a==null?void 0:a.permLevel)!=null?L:0,(R=a==null?void 0:a.currEXP)!=null?R:0,e)};var _r="talents.barSpeed",Bt=(r,e)=>{var u,f,E,L,R;let a=(u=M(r,_r))!=null?u:M(e,_r);return new It((f=a==null?void 0:a.level)!=null?f:0,pe.talentProgressSpeed,(E=a==null?void 0:a.investedFragments)!=null?E:0,(L=a==null?void 0:a.permLevel)!=null?L:0,(R=a==null?void 0:a.currEXP)!=null?R:0,e)};var Br="talents.coinGain",Ht=(r,e)=>{var u,f,E,L,R;let a=(u=M(r,Br))!=null?u:M(e,Br);return new At((f=a==null?void 0:a.level)!=null?f:0,pe.talentCoinGain,(E=a==null?void 0:a.investedFragments)!=null?E:0,(L=a==null?void 0:a.permLevel)!=null?L:0,(R=a==null?void 0:a.currEXP)!=null?R:0,e)};var T={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0,coinValueCache:0},Dr=Object.assign({},T),oa=async r=>{var u;let e=ur(j({},r),{coins:r.coins.valueOf(),coinUpgrades:{barSpeed:r.coinUpgrades.barSpeed.valueOf(),barMomentum:r.coinUpgrades.barMomentum.valueOf(),barReverberation:r.coinUpgrades.barReverberation.valueOf(),barVibration:r.coinUpgrades.barVibration.valueOf(),barAgitation:r.coinUpgrades.barAgitation.valueOf(),barAdoption:r.coinUpgrades.barAdoption.valueOf(),barEmpowerment:r.coinUpgrades.barEmpowerment.valueOf(),barReinforcement:r.coinUpgrades.barReinforcement.valueOf(),barResonance:r.coinUpgrades.barResonance.valueOf()},talents:{barCriticalChance:r.talents.barCriticalChance.valueOf(),barSpeed:r.talents.barSpeed.valueOf(),coinGain:r.talents.coinGain.valueOf()},barFragments:r.barFragments.valueOf()}),a=btoa(JSON.stringify(e));if(await ke.default.setItem("UPBSave",a),typeof((u=navigator.storage)==null?void 0:u.estimate)=="function"){let{usage:f,quota:E}=await navigator.storage.estimate();E&&f&&f/E*100>95&&Z("You are very close to running out of space on this computer which may cause your save to getautomatically deleted soon! Clear some other site's data (and tell Khafra that this works please)!")}},Hr=new Map([["coins",st],["coinUpgrades.barSpeed",yt],["coinUpgrades.barMomentum",Et],["coinUpgrades.barReverberation",Lt],["coinUpgrades.barVibration",xt],["coinUpgrades.barAgitation",Tt],["coinUpgrades.barAdoption",Pt],["coinUpgrades.barEmpowerment",St],["coinUpgrades.barReinforcement",Mt],["coinUpgrades.barResonance",Ct],["talents.barCriticalChance",_t],["talents.barSpeed",Bt],["talents.coinGain",Ht],["barFragments",ut]]),ia=async()=>{let r=await ke.default.getItem("UPBSave"),e=r?JSON.parse(atob(r)):null;if(e!==null){let a=Object.keys(e);for(let u of a)u in Dr&&(Hr.has(u)||Object.defineProperty(T,u,{value:e[u]}))}for(let[a,u]of Hr)mr(T,a,u(e!=null?e:T,T))},Pe=new Set,Dt=new Proxy(setInterval,{apply(r,e,a){let u=r.apply(e,a);return Pe.add(u),u}}),sa=new Proxy(clearInterval,{apply(r,e,a){let u=a[0];return Pe.has(u)&&Pe.delete(u),r.apply(e,a)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var Nt=0,Ne=24,ca=6e4,kt=async()=>{for(let r of Pe)sa(r);Pe.clear(),await ia(),T.barTNL=Ee(T),Object.defineProperty(window,"player",{value:T}),he(ue(T.barEXP,T.barTNL)),T.barFragments.updateHTML(),ce("Main"),C("progression",{backgroundColor:de(T)}),v("coinWorth",{textContent:`Worth ${b(T.coinValueCache)} coins`}),T.coinValueCache&&C("coinWorth",{color:"gold"}),Nt=performance.now(),Dt(ua,1e3/Ne),Dt(yr,1e3,T),Dt(oa,ca,T)},Nr=async()=>{if(await Re("Are you SURE you want to reset the game?")===!1)return Z("OK, the game hasn't been reset!");await ke.default.removeItem("UPBSave");let e=Object.keys(T);for(let a of e){if(typeof T[a]=="object"){delete T[a];continue}Object.defineProperty(T,a,{value:Dr[a]})}await kt()},ua=()=>{let e=performance.now()-Nt;Ut(e/1e3),Nt+=e},Ut=r=>{let e=r;if(e>5){let u=ot(T),f=Ne*u*5,E=Math.floor(f),L=f-E,R=f*T.coinUpgrades.barResonance.upgradeEffect(),P=Math.floor(R),D=R-P;for(;e>5;){let k=Math.random(),V=0;k<L&&(V=1);let y=E+V;T.criticalHitsThisRefresh+=y;let S=Math.random(),U=0;S<D&&(U+=1);let $=P+U;for(;$>0;)T.coins.gain(Math.floor(T.barLevel/5)+3),$-=1;tt(5,T),e-=5,ue(T.barEXP,T.barTNL)>=100&&rt(T),nt(T)}}tt(e,T),T.refreshTime+=r,v("refresh-timer",{textContent:`${b(T.refreshTime,2)}s`});let a=ue(T.barEXP,T.barTNL);a<100?he(a):rt(T),nt(T),Ie.generateAttacks(e),me.decreaseDelay(e)},Te=60;var kr=r=>{B("main-tab-nav").addEventListener("click",()=>ce("Main")),B("upgrade-tab-nav").addEventListener("click",()=>ce("Upgrades")),B("talent-tab-nav").addEventListener("click",()=>ce("Talents")),B("dueling-tab-nav").addEventListener("click",()=>ce("Dueling")),B("buy-coin-bar-speed").addEventListener("click",e=>r.coinUpgrades.barSpeed.purchaseLevels(1,e)),B("buy-coin-bar-momentum").addEventListener("click",e=>r.coinUpgrades.barMomentum.purchaseLevels(1,e)),B("buy-coin-bar-reverberation").addEventListener("click",e=>r.coinUpgrades.barReverberation.purchaseLevels(1,e)),B("buy-coin-bar-vibration").addEventListener("click",e=>r.coinUpgrades.barVibration.purchaseLevels(1,e)),B("buy-coin-bar-agitation").addEventListener("click",e=>r.coinUpgrades.barAgitation.purchaseLevels(1,e)),B("buy-coin-bar-adoption").addEventListener("click",e=>r.coinUpgrades.barAdoption.purchaseLevels(1,e)),B("buy-coin-bar-empowerment").addEventListener("click",e=>r.coinUpgrades.barEmpowerment.purchaseLevels(1,e)),B("buy-coin-bar-reinforcement").addEventListener("click",e=>r.coinUpgrades.barReinforcement.purchaseLevels(1,e)),B("buy-coin-bar-resonance").addEventListener("click",e=>r.coinUpgrades.barResonance.purchaseLevels(1,e)),B("buy-reset").addEventListener("click",()=>He("Refresh",r)),B("reset-game").addEventListener("click",()=>void Nr()),B("simulate-time").addEventListener("click",()=>void Ut(3600)),B("talentCriticalChanceSacrifice").addEventListener("click",()=>void r.talents.barCriticalChance.sacrificeFragments()),B("talentProgressSpeedSacrifice").addEventListener("click",()=>void r.talents.barSpeed.sacrificeFragments()),B("talentCoinGainSacrifice").addEventListener("click",()=>void r.talents.coinGain.sacrificeFragments()),B("basicAttack").addEventListener("click",()=>void me.attack())};window.addEventListener("load",async()=>{var r,e;if(kr(T),await kt(),_e(T),typeof((r=navigator.storage)==null?void 0:r.persist)=="function"&&typeof((e=navigator.storage)==null?void 0:e.persisted)=="function"){let a=await navigator.storage.persisted();a?console.log(`Storage is persistent! (persistent = ${a})`):await navigator.storage.persist()&&Z("Data on this page is now persistent! If you do not know what this means, you can safely ignore it.")}});document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(T.coins.updateHTML(),T.coinUpgrades.barMomentum.updateHTML(),T.coinUpgrades.barSpeed.updateHTML(),T.coinUpgrades.barReverberation.updateHTML(),T.coinUpgrades.barVibration.updateHTML(),T.coinUpgrades.barAgitation.updateHTML(),T.barFragments.updateHTML(),T.talents.barCriticalChance.updateHTML("Initialize"),T.talents.barSpeed.updateHTML("Initialize"),v("coinWorth",{textContent:`Worth ${b(T.coinValueCache)} coins`}),T.coinValueCache>0?C("coinWorth",{color:"gold"}):C("coinWorth",{color:"grey"}))});})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
