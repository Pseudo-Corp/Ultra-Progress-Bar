(()=>{var rn=Object.create;var Je=Object.defineProperty;var nn=Object.getOwnPropertyDescriptor;var an=Object.getOwnPropertyNames;var on=Object.getPrototypeOf,sn=Object.prototype.hasOwnProperty;var fn=i=>Je(i,"__esModule",{value:!0});var be=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(r,u)=>(typeof require!="undefined"?require:r)[u]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var un=(i,r)=>()=>(r||i((r={exports:{}}).exports,r),r.exports);var cn=(i,r,u,d)=>{if(r&&typeof r=="object"||typeof r=="function")for(let y of an(r))!sn.call(i,y)&&(u||y!=="default")&&Je(i,y,{get:()=>r[y],enumerable:!(d=nn(r,y))||d.enumerable});return i},ln=(i,r)=>cn(fn(Je(i!=null?rn(on(i)):{},"default",!r&&i&&i.__esModule?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var Ut=un((Dt,qe)=>{(function(i){if(typeof Dt=="object"&&typeof qe<"u")qe.exports=i();else if(typeof define=="function"&&define.amd)define([],i);else{var r;typeof window<"u"?r=window:typeof global<"u"?r=global:typeof self<"u"?r=self:r=this,r.localforage=i()}})(function(){var i,r,u;return function d(y,T,x){function k(W,J){if(!T[W]){if(!y[W]){var b=typeof be=="function"&&be;if(!J&&b)return b(W,!0);if(C)return C(W,!0);var L=new Error("Cannot find module '"+W+"'");throw L.code="MODULE_NOT_FOUND",L}var D=T[W]={exports:{}};y[W][0].call(D.exports,function(O){var q=y[W][1][O];return k(q||O)},D,D.exports,d,y,T,x)}return T[W].exports}for(var C=typeof be=="function"&&be,H=0;H<x.length;H++)k(x[H]);return k}({1:[function(d,y,T){(function(x){"use strict";var k=x.MutationObserver||x.WebKitMutationObserver,C;if(k){var H=0,W=new k(O),J=x.document.createTextNode("");W.observe(J,{characterData:!0}),C=function(){J.data=H=++H%2}}else if(!x.setImmediate&&typeof x.MessageChannel<"u"){var b=new x.MessageChannel;b.port1.onmessage=O,C=function(){b.port2.postMessage(0)}}else"document"in x&&"onreadystatechange"in x.document.createElement("script")?C=function(){var F=x.document.createElement("script");F.onreadystatechange=function(){O(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},x.document.documentElement.appendChild(F)}:C=function(){setTimeout(O,0)};var L,D=[];function O(){L=!0;for(var F,Z,X=D.length;X;){for(Z=D,D=[],F=-1;++F<X;)Z[F]();X=D.length}L=!1}y.exports=q;function q(F){D.push(F)===1&&!L&&C()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(d,y,T){"use strict";var x=d(1);function k(){}var C={},H=["REJECTED"],W=["FULFILLED"],J=["PENDING"];y.exports=b;function b(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=J,this.queue=[],this.outcome=void 0,v!==k&&q(this,v)}b.prototype.catch=function(v){return this.then(null,v)},b.prototype.then=function(v,M){if(typeof v!="function"&&this.state===W||typeof M!="function"&&this.state===H)return this;var _=new this.constructor(k);if(this.state!==J){var R=this.state===W?v:M;D(_,R,this.outcome)}else this.queue.push(new L(_,v,M));return _};function L(v,M,_){this.promise=v,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}L.prototype.callFulfilled=function(v){C.resolve(this.promise,v)},L.prototype.otherCallFulfilled=function(v){D(this.promise,this.onFulfilled,v)},L.prototype.callRejected=function(v){C.reject(this.promise,v)},L.prototype.otherCallRejected=function(v){D(this.promise,this.onRejected,v)};function D(v,M,_){x(function(){var R;try{R=M(_)}catch(z){return C.reject(v,z)}R===v?C.reject(v,new TypeError("Cannot resolve promise with itself")):C.resolve(v,R)})}C.resolve=function(v,M){var _=F(O,M);if(_.status==="error")return C.reject(v,_.value);var R=_.value;if(R)q(v,R);else{v.state=W,v.outcome=M;for(var z=-1,Y=v.queue.length;++z<Y;)v.queue[z].callFulfilled(M)}return v},C.reject=function(v,M){v.state=H,v.outcome=M;for(var _=-1,R=v.queue.length;++_<R;)v.queue[_].callRejected(M);return v};function O(v){var M=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof M=="function")return function(){M.apply(v,arguments)}}function q(v,M){var _=!1;function R(K){_||(_=!0,C.reject(v,K))}function z(K){_||(_=!0,C.resolve(v,K))}function Y(){M(z,R)}var G=F(Y);G.status==="error"&&R(G.value)}function F(v,M){var _={};try{_.value=v(M),_.status="success"}catch(R){_.status="error",_.value=R}return _}b.resolve=Z;function Z(v){return v instanceof this?v:C.resolve(new this(k),v)}b.reject=X;function X(v){var M=new this(k);return C.reject(M,v)}b.all=Fe;function Fe(v){var M=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=v.length,R=!1;if(!_)return this.resolve([]);for(var z=new Array(_),Y=0,G=-1,K=new this(k);++G<_;)j(v[G],G);return K;function j(pe,Pe){M.resolve(pe).then(Xe,function(ie){R||(R=!0,C.reject(K,ie))});function Xe(ie){z[Pe]=ie,++Y===_&&!R&&(R=!0,C.resolve(K,z))}}}b.race=ae;function ae(v){var M=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=v.length,R=!1;if(!_)return this.resolve([]);for(var z=-1,Y=new this(k);++z<_;)G(v[z]);return Y;function G(K){M.resolve(K).then(function(j){R||(R=!0,C.resolve(Y,j))},function(j){R||(R=!0,C.reject(Y,j))})}}},{"1":1}],3:[function(d,y,T){(function(x){"use strict";typeof x.Promise!="function"&&(x.Promise=d(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(d,y,T){"use strict";var x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function k(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function C(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(e){return}}var H=C();function W(){try{if(!H||!H.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(t){return!1}}function J(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(a){if(a.name!=="TypeError")throw a;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,o=new t,s=0;s<e.length;s+=1)o.append(e[s]);return o.getBlob(n.type)}}typeof Promise>"u"&&d(3);var b=Promise;function L(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function D(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function O(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var F="local-forage-detect-blob-support",Z=void 0,X={},Fe=Object.prototype.toString,ae="readonly",v="readwrite";function M(e){for(var n=e.length,t=new ArrayBuffer(n),o=new Uint8Array(t),s=0;s<n;s++)o[s]=e.charCodeAt(s);return t}function _(e){return new b(function(n){var t=e.transaction(F,v),o=J([""]);t.objectStore(F).put(o,"key"),t.onabort=function(s){s.preventDefault(),s.stopPropagation(),n(!1)},t.oncomplete=function(){var s=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);n(a||!s||parseInt(s[1],10)>=43)}}).catch(function(){return!1})}function R(e){return typeof Z=="boolean"?b.resolve(Z):_(e).then(function(n){return Z=n,Z})}function z(e){var n=X[e.name],t={};t.promise=new b(function(o,s){t.resolve=o,t.reject=s}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function Y(e){var n=X[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function G(e,n){var t=X[e.name],o=t.deferredOperations.pop();if(o)return o.reject(n),o.promise}function K(e,n){return new b(function(t,o){if(X[e.name]=X[e.name]||ht(),e.db)if(n)z(e),e.db.close();else return t(e.db);var s=[e.name];n&&s.push(e.version);var a=H.open.apply(H,s);n&&(a.onupgradeneeded=function(c){var l=a.result;try{l.createObjectStore(e.storeName),c.oldVersion<=1&&l.createObjectStore(F)}catch(m){if(m.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw m}}),a.onerror=function(c){c.preventDefault(),o(a.error)},a.onsuccess=function(){var c=a.result;c.onversionchange=function(l){l.target.close()},t(c),Y(e)}})}function j(e){return K(e,!1)}function pe(e){return K(e,!0)}function Pe(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,s=e.version>e.db.version;if(o&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function Xe(e){return new b(function(n,t){var o=new FileReader;o.onerror=t,o.onloadend=function(s){var a=btoa(s.target.result||"");n({__local_forage_encoded_blob:!0,data:a,type:e.type})},o.readAsBinaryString(e)})}function ie(e){var n=M(atob(e.data));return J([n],{type:e.type})}function pt(e){return e&&e.__local_forage_encoded_blob}function nr(e){var n=this,t=n._initReady().then(function(){var o=X[n._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return D(t,e,e),t}function ar(e){z(e);for(var n=X[e.name],t=n.forages,o=0;o<t.length;o++){var s=t[o];s._dbInfo.db&&(s._dbInfo.db.close(),s._dbInfo.db=null)}return e.db=null,j(e).then(function(a){return e.db=a,Pe(e)?pe(e):a}).then(function(a){e.db=n.db=a;for(var c=0;c<t.length;c++)t[c]._dbInfo.db=a}).catch(function(a){throw G(e,a),a})}function ee(e,n,t,o){o===void 0&&(o=1);try{var s=e.db.transaction(e.storeName,n);t(null,s)}catch(a){if(o>0&&(!e.db||a.name==="InvalidStateError"||a.name==="NotFoundError"))return b.resolve().then(function(){if(!e.db||a.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),pe(e)}).then(function(){return ar(e).then(function(){ee(e,n,t,o-1)})}).catch(t);t(a)}}function ht(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function or(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var s=X[t.name];s||(s=ht(),X[t.name]=s),s.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=nr);var a=[];function c(){return b.resolve()}for(var l=0;l<s.forages.length;l++){var m=s.forages[l];m!==n&&a.push(m._initReady().catch(c))}var p=s.forages.slice(0);return b.all(a).then(function(){return t.db=s.db,j(t)}).then(function(h){return t.db=h,Pe(t,n._defaultConfig.version)?pe(t):h}).then(function(h){t.db=s.db=h,n._dbInfo=t;for(var g=0;g<p.length;g++){var w=p[g];w!==n&&(w._dbInfo.db=t.db,w._dbInfo.version=t.version)}})}function ir(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,ae,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.get(e);p.onsuccess=function(){var h=p.result;h===void 0&&(h=null),pt(h)&&(h=ie(h)),s(h)},p.onerror=function(){a(p.error)}}catch(h){a(h)}})}).catch(a)});return L(o,n),o}function sr(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,ae,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.openCursor(),h=1;p.onsuccess=function(){var g=p.result;if(g){var w=g.value;pt(w)&&(w=ie(w));var I=e(w,g.key,h++);I!==void 0?s(I):g.continue()}else s()},p.onerror=function(){a(p.error)}}catch(g){a(g)}})}).catch(a)});return L(o,n),o}function fr(e,n,t){var o=this;e=O(e);var s=new b(function(a,c){var l;o.ready().then(function(){return l=o._dbInfo,Fe.call(n)==="[object Blob]"?R(l.db).then(function(m){return m?n:Xe(n)}):n}).then(function(m){ee(o._dbInfo,v,function(p,h){if(p)return c(p);try{var g=h.objectStore(o._dbInfo.storeName);m===null&&(m=void 0);var w=g.put(m,e);h.oncomplete=function(){m===void 0&&(m=null),a(m)},h.onabort=h.onerror=function(){var I=w.error?w.error:w.transaction.error;c(I)}}catch(I){c(I)}})}).catch(c)});return L(s,t),s}function ur(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,v,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.delete(e);l.oncomplete=function(){s()},l.onerror=function(){a(p.error)},l.onabort=function(){var h=p.error?p.error:p.transaction.error;a(h)}}catch(h){a(h)}})}).catch(a)});return L(o,n),o}function cr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,v,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.clear();c.oncomplete=function(){o()},c.onabort=c.onerror=function(){var p=m.error?m.error:m.transaction.error;s(p)}}catch(p){s(p)}})}).catch(s)});return L(t,e),t}function lr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,ae,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.count();m.onsuccess=function(){o(m.result)},m.onerror=function(){s(m.error)}}catch(p){s(p)}})}).catch(s)});return L(t,e),t}function dr(e,n){var t=this,o=new b(function(s,a){if(e<0){s(null);return}t.ready().then(function(){ee(t._dbInfo,ae,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=!1,h=m.openKeyCursor();h.onsuccess=function(){var g=h.result;if(!g){s(null);return}e===0||p?s(g.key):(p=!0,g.advance(e))},h.onerror=function(){a(h.error)}}catch(g){a(g)}})}).catch(a)});return L(o,n),o}function mr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,ae,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.openKeyCursor(),p=[];m.onsuccess=function(){var h=m.result;if(!h){o(p);return}p.push(h.key),h.continue()},m.onerror=function(){s(m.error)}}catch(h){s(h)}})}).catch(s)});return L(t,e),t}function pr(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,s;if(!e.name)s=b.reject("Invalid arguments");else{var a=e.name===t.name&&o._dbInfo.db,c=a?b.resolve(o._dbInfo.db):j(e).then(function(l){var m=X[e.name],p=m.forages;m.db=l;for(var h=0;h<p.length;h++)p[h]._dbInfo.db=l;return l});e.storeName?s=c.then(function(l){if(!!l.objectStoreNames.contains(e.storeName)){var m=l.version+1;z(e);var p=X[e.name],h=p.forages;l.close();for(var g=0;g<h.length;g++){var w=h[g];w._dbInfo.db=null,w._dbInfo.version=m}var I=new b(function(P,U){var A=H.open(e.name,m);A.onerror=function(Q){var ve=A.result;ve.close(),U(Q)},A.onupgradeneeded=function(){var Q=A.result;Q.deleteObjectStore(e.storeName)},A.onsuccess=function(){var Q=A.result;Q.close(),P(Q)}});return I.then(function(P){p.db=P;for(var U=0;U<h.length;U++){var A=h[U];A._dbInfo.db=P,Y(A._dbInfo)}}).catch(function(P){throw(G(e,P)||b.resolve()).catch(function(){}),P})}}):s=c.then(function(l){z(e);var m=X[e.name],p=m.forages;l.close();for(var h=0;h<p.length;h++){var g=p[h];g._dbInfo.db=null}var w=new b(function(I,P){var U=H.deleteDatabase(e.name);U.onerror=function(){var A=U.result;A&&A.close(),P(U.error)},U.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},U.onsuccess=function(){var A=U.result;A&&A.close(),I(A)}});return w.then(function(I){m.db=I;for(var P=0;P<p.length;P++){var U=p[P];Y(U._dbInfo)}}).catch(function(I){throw(G(e,I)||b.resolve()).catch(function(){}),I})})}return L(s,n),s}var hr={_driver:"asyncStorage",_initStorage:or,_support:W(),iterate:sr,getItem:ir,setItem:fr,removeItem:ur,clear:cr,length:lr,key:dr,keys:mr,dropInstance:pr};function vr(){return typeof openDatabase=="function"}var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",br="~~local_forage_type~",vt=/^~~local_forage_type~([^~]+)~/,Re="__lfsc__:",$e=Re.length,ke="arbf",We="blob",bt="si08",gt="ui08",yt="uic8",Et="si16",Lt="si32",xt="ur16",Tt="ui32",wt="fl32",St="fl64",_t=$e+ke.length,Ct=Object.prototype.toString;function Mt(e){var n=e.length*.75,t=e.length,o,s=0,a,c,l,m;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var p=new ArrayBuffer(n),h=new Uint8Array(p);for(o=0;o<t;o+=4)a=te.indexOf(e[o]),c=te.indexOf(e[o+1]),l=te.indexOf(e[o+2]),m=te.indexOf(e[o+3]),h[s++]=a<<2|c>>4,h[s++]=(c&15)<<4|l>>2,h[s++]=(l&3)<<6|m&63;return p}function ze(e){var n=new Uint8Array(e),t="",o;for(o=0;o<n.length;o+=3)t+=te[n[o]>>2],t+=te[(n[o]&3)<<4|n[o+1]>>4],t+=te[(n[o+1]&15)<<2|n[o+2]>>6],t+=te[n[o+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function gr(e,n){var t="";if(e&&(t=Ct.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&Ct.call(e.buffer)==="[object ArrayBuffer]")){var o,s=Re;e instanceof ArrayBuffer?(o=e,s+=ke):(o=e.buffer,t==="[object Int8Array]"?s+=bt:t==="[object Uint8Array]"?s+=gt:t==="[object Uint8ClampedArray]"?s+=yt:t==="[object Int16Array]"?s+=Et:t==="[object Uint16Array]"?s+=xt:t==="[object Int32Array]"?s+=Lt:t==="[object Uint32Array]"?s+=Tt:t==="[object Float32Array]"?s+=wt:t==="[object Float64Array]"?s+=St:n(new Error("Failed to get type for BinaryArray"))),n(s+ze(o))}else if(t==="[object Blob]"){var a=new FileReader;a.onload=function(){var c=br+e.type+"~"+ze(this.result);n(Re+We+c)},a.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(c){console.error("Couldn't convert value into a JSON string: ",e),n(null,c)}}function yr(e){if(e.substring(0,$e)!==Re)return JSON.parse(e);var n=e.substring(_t),t=e.substring($e,_t),o;if(t===We&&vt.test(n)){var s=n.match(vt);o=s[1],n=n.substring(s[0].length)}var a=Mt(n);switch(t){case ke:return a;case We:return J([a],{type:o});case bt:return new Int8Array(a);case gt:return new Uint8Array(a);case yt:return new Uint8ClampedArray(a);case Et:return new Int16Array(a);case xt:return new Uint16Array(a);case Lt:return new Int32Array(a);case Tt:return new Uint32Array(a);case wt:return new Float32Array(a);case St:return new Float64Array(a);default:throw new Error("Unkown type: "+t)}}var Ve={serialize:gr,deserialize:yr,stringToBuffer:Mt,bufferToString:ze};function It(e,n,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function Er(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var s=new b(function(a,c){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(l){return c(l)}t.db.transaction(function(l){It(l,t,function(){n._dbInfo=t,a()},function(m,p){c(p)})},c)});return t.serializer=Ve,s}function re(e,n,t,o,s,a){e.executeSql(t,o,s,function(c,l){l.code===l.SYNTAX_ERR?c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(m,p){p.rows.length?a(m,l):It(m,n,function(){m.executeSql(t,o,s,a)},a)},a):a(c,l)},a)}function Lr(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[e],function(m,p){var h=p.rows.length?p.rows.item(0).value:null;h&&(h=c.serializer.deserialize(h)),s(h)},function(m,p){a(p)})})}).catch(a)});return L(o,n),o}function xr(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT * FROM "+c.storeName,[],function(m,p){for(var h=p.rows,g=h.length,w=0;w<g;w++){var I=h.item(w),P=I.value;if(P&&(P=c.serializer.deserialize(P)),P=e(P,I.key,w+1),P!==void 0){s(P);return}}s()},function(m,p){a(p)})})}).catch(a)});return L(o,n),o}function Pt(e,n,t,o){var s=this;e=O(e);var a=new b(function(c,l){s.ready().then(function(){n===void 0&&(n=null);var m=n,p=s._dbInfo;p.serializer.serialize(n,function(h,g){g?l(g):p.db.transaction(function(w){re(w,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){c(m)},function(I,P){l(P)})},function(w){if(w.code===w.QUOTA_ERR){if(o>0){c(Pt.apply(s,[e,m,t,o-1]));return}l(w)}})})}).catch(l)});return L(a,t),a}function Tr(e,n,t){return Pt.apply(this,[e,n,t,1])}function wr(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"DELETE FROM "+c.storeName+" WHERE key = ?",[e],function(){s()},function(m,p){a(p)})})}).catch(a)});return L(o,n),o}function Sr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"DELETE FROM "+a.storeName,[],function(){o()},function(l,m){s(m)})})}).catch(s)});return L(t,e),t}function _r(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"SELECT COUNT(key) as c FROM "+a.storeName,[],function(l,m){var p=m.rows.item(0).c;o(p)},function(l,m){s(m)})})}).catch(s)});return L(t,e),t}function Cr(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT key FROM "+c.storeName+" WHERE id = ? LIMIT 1",[e+1],function(m,p){var h=p.rows.length?p.rows.item(0).key:null;s(h)},function(m,p){a(p)})})}).catch(a)});return L(o,n),o}function Mr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"SELECT key FROM "+a.storeName,[],function(l,m){for(var p=[],h=0;h<m.rows.length;h++)p.push(m.rows.item(h).key);o(p)},function(l,m){s(m)})})}).catch(s)});return L(t,e),t}function Ir(e){return new b(function(n,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(s,a){for(var c=[],l=0;l<a.rows.length;l++)c.push(a.rows.item(l).name);n({db:e,storeNames:c})},function(s,a){t(a)})},function(o){t(o)})})}function Pr(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,s;return e.name?s=new b(function(a){var c;e.name===t.name?c=o._dbInfo.db:c=openDatabase(e.name,"","",0),e.storeName?a({db:c,storeNames:[e.storeName]}):a(Ir(c))}).then(function(a){return new b(function(c,l){a.db.transaction(function(m){function p(I){return new b(function(P,U){m.executeSql("DROP TABLE IF EXISTS "+I,[],function(){P()},function(A,Q){U(Q)})})}for(var h=[],g=0,w=a.storeNames.length;g<w;g++)h.push(p(a.storeNames[g]));b.all(h).then(function(){c()}).catch(function(I){l(I)})},function(m){l(m)})})}):s=b.reject("Invalid arguments"),L(s,n),s}var Rr={_driver:"webSQLStorage",_initStorage:Er,_support:vr(),iterate:xr,getItem:Lr,setItem:Tr,removeItem:wr,clear:Sr,length:_r,key:Cr,keys:Mr,dropInstance:Pr};function Br(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Rt(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Ar(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function Nr(){return!Ar()||localStorage.length>0}function Dr(e){var n=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=Rt(e,n._defaultConfig),Nr()?(n._dbInfo=t,t.serializer=Ve,b.resolve()):b.reject()}function Ur(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var a=localStorage.key(s);a.indexOf(o)===0&&localStorage.removeItem(a)}});return L(t,e),t}function Hr(e,n){var t=this;e=O(e);var o=t.ready().then(function(){var s=t._dbInfo,a=localStorage.getItem(s.keyPrefix+e);return a&&(a=s.serializer.deserialize(a)),a});return L(o,n),o}function Or(e,n){var t=this,o=t.ready().then(function(){for(var s=t._dbInfo,a=s.keyPrefix,c=a.length,l=localStorage.length,m=1,p=0;p<l;p++){var h=localStorage.key(p);if(h.indexOf(a)===0){var g=localStorage.getItem(h);if(g&&(g=s.serializer.deserialize(g)),g=e(g,h.substring(c),m++),g!==void 0)return g}}});return L(o,n),o}function Fr(e,n){var t=this,o=t.ready().then(function(){var s=t._dbInfo,a;try{a=localStorage.key(e)}catch(c){a=null}return a&&(a=a.substring(s.keyPrefix.length)),a});return L(o,n),o}function Xr(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo,s=localStorage.length,a=[],c=0;c<s;c++){var l=localStorage.key(c);l.indexOf(o.keyPrefix)===0&&a.push(l.substring(o.keyPrefix.length))}return a});return L(t,e),t}function $r(e){var n=this,t=n.keys().then(function(o){return o.length});return L(t,e),t}function kr(e,n){var t=this;e=O(e);var o=t.ready().then(function(){var s=t._dbInfo;localStorage.removeItem(s.keyPrefix+e)});return L(o,n),o}function Wr(e,n,t){var o=this;e=O(e);var s=o.ready().then(function(){n===void 0&&(n=null);var a=n;return new b(function(c,l){var m=o._dbInfo;m.serializer.serialize(n,function(p,h){if(h)l(h);else try{localStorage.setItem(m.keyPrefix+e,p),c(a)}catch(g){(g.name==="QuotaExceededError"||g.name==="NS_ERROR_DOM_QUOTA_REACHED")&&l(g),l(g)}})})});return L(s,t),s}function zr(e,n){if(n=q.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,s;return e.name?s=new b(function(a){e.storeName?a(Rt(e,o._defaultConfig)):a(e.name+"/")}).then(function(a){for(var c=localStorage.length-1;c>=0;c--){var l=localStorage.key(c);l.indexOf(a)===0&&localStorage.removeItem(l)}}):s=b.reject("Invalid arguments"),L(s,n),s}var Vr={_driver:"localStorageWrapper",_initStorage:Dr,_support:Br(),iterate:Or,getItem:Hr,setItem:Wr,removeItem:kr,clear:Ur,length:$r,key:Fr,keys:Xr,dropInstance:zr},Yr=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},Gr=function(n,t){for(var o=n.length,s=0;s<o;){if(Yr(n[s],t))return!0;s++}return!1},Bt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},he={},At={},se={INDEXEDDB:hr,WEBSQL:Rr,LOCALSTORAGE:Vr},Kr=[se.INDEXEDDB._driver,se.WEBSQL._driver,se.LOCALSTORAGE._driver],Be=["dropInstance"],Ye=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Be),Qr={description:"",driver:Kr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Jr(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function Ge(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(Bt(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var qr=function(){function e(n){k(this,e);for(var t in se)if(se.hasOwnProperty(t)){var o=se[t],s=o._driver;this[t]=s,he[s]||this.defineDriver(o)}this._defaultConfig=Ge({},Qr),this._config=Ge({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":x(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,s){var a=new b(function(c,l){try{var m=t._driver,p=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){l(p);return}for(var h=Ye.concat("_initStorage"),g=0,w=h.length;g<w;g++){var I=h[g],P=!Gr(Be,I);if((P||t[I])&&typeof t[I]!="function"){l(p);return}}var U=function(){for(var ve=function(en){return function(){var tn=new Error("Method "+en+" is not implemented by the current driver"),Nt=b.reject(tn);return L(Nt,arguments[arguments.length-1]),Nt}},Ke=0,jr=Be.length;Ke<jr;Ke++){var Qe=Be[Ke];t[Qe]||(t[Qe]=ve(Qe))}};U();var A=function(ve){he[m]&&console.info("Redefining LocalForage driver: "+m),he[m]=t,At[m]=ve,c()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(A,l):A(!!t._support):A(!0)}catch(Q){l(Q)}});return D(a,o,s),a},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,s){var a=he[t]?b.resolve(he[t]):b.reject(new Error("Driver not found."));return D(a,o,s),a},e.prototype.getSerializer=function(t){var o=b.resolve(Ve);return D(o,t),o},e.prototype.ready=function(t){var o=this,s=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return D(s,t,t),s},e.prototype.setDriver=function(t,o,s){var a=this;Bt(t)||(t=[t]);var c=this._getSupportedDrivers(t);function l(){a._config.driver=a.driver()}function m(g){return a._extend(g),l(),a._ready=a._initStorage(a._config),a._ready}function p(g){return function(){var w=0;function I(){for(;w<g.length;){var P=g[w];return w++,a._dbInfo=null,a._ready=null,a.getDriver(P).then(m).catch(I)}l();var U=new Error("No available storage method found.");return a._driverSet=b.reject(U),a._driverSet}return I()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=h.then(function(){var g=c[0];return a._dbInfo=null,a._ready=null,a.getDriver(g).then(function(w){a._driver=w._driver,l(),a._wrapLibraryMethodsWithReady(),a._initDriver=p(c)})}).catch(function(){l();var g=new Error("No available storage method found.");return a._driverSet=b.reject(g),a._driverSet}),D(this._driverSet,o,s),this._driverSet},e.prototype.supports=function(t){return!!At[t]},e.prototype._extend=function(t){Ge(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],s=0,a=t.length;s<a;s++){var c=t[s];this.supports(c)&&o.push(c)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Ye.length;t<o;t++)Jr(this,Ye[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),Zr=new qr;y.exports=Zr},{"3":3}]},{},[4])(4)})});var me=ln(Ut());var je=i=>{let r=typeof i;return i!==null&&(r==="object"||r==="function")},Ze=new Set(["__proto__","prototype","constructor"]),dn=new Set("0123456789");function Ht(i){let r=[],u="",d="start",y=!1;for(let T of i)switch(T){case"\\":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");y&&(u+=T),d="property",y=!y;break;case".":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="property";break}if(y){y=!1,u+=T;break}if(Ze.has(u))return[];r.push(u),u="",d="property";break;case"[":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="index";break}if(y){y=!1,u+=T;break}if(d==="property"){if(Ze.has(u))return[];r.push(u),u=""}d="index";break;case"]":if(d==="index"){r.push(Number.parseInt(u,10)),u="",d="indexEnd";break}if(d==="indexEnd")throw new Error("Invalid character after an index");default:if(d==="index"&&!dn.has(T))throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");d==="start"&&(d="property"),y&&(y=!1,u+="\\"),u+=T}switch(y&&(u+="\\"),d){case"property":{if(Ze.has(u))return[];r.push(u);break}case"index":throw new Error("Index was not closed");case"start":{r.push("");break}}return r}function Ot(i,r){if(typeof r!="number"&&Array.isArray(i)){let u=Number.parseInt(r,10);return Number.isInteger(u)&&i[u]===i[r]}return!1}function mn(i,r){if(Ot(i,r))throw new Error("Cannot use string index")}function N(i,r,u){if(!je(i)||typeof r!="string")return u===void 0?i:u;let d=Ht(r);if(d.length===0)return u;for(let y=0;y<d.length;y++){let T=d[y];if(Ot(i,T)?i=y===d.length-1?void 0:null:i=i[T],i==null){if(y!==d.length-1)return u;break}}return i===void 0?u:i}function Ft(i,r,u){if(!je(i)||typeof r!="string")return i;let d=i,y=Ht(r);for(let T=0;T<y.length;T++){let x=y[T];mn(i,x),T===y.length-1?i[x]=u:je(i[x])||(i[x]=typeof y[T+1]=="number"?[]:{}),i=i[x]}return d}var E=(i,r=0)=>{if(i<0)return"-"+E(-i,r);if(i>=1e6){let H=Math.floor(Math.log10(i));return i/=Math.pow(10,H),E(i,2)+"e"+E(H)}let u=Math.floor(i),d=i-u,y=u.toLocaleString(),T=r>0&&i!==0,x=Math.pow(10,r)*d,k=1e-6;Math.ceil(x)-x<k&&(x=Math.ceil(x));let C=T?Math.floor(x).toString():"";if(C!==""){for(;C.length<r;)C="0"+C;C="."+C}return y+C};var pn=10,Ae=0,et=0,ge=()=>{let i=0;return i+=pn*Math.pow(f.barLevel+1,2),i*=Math.min(1,(f.barLevel+20)/40),i*=Math.max(1,1+(f.barLevel-20)/10),f.barLevel>40&&(i*=Math.pow(2,1/10*(f.barLevel-40))),f.barLevel>100&&(i*=Math.pow(2,1/10*(f.barLevel-100))),f.barLevel>200&&(i*=Math.pow(2,1/10*(f.barLevel-200))),i},hn=()=>{let i=0;return f.barLevel>=5&&(i=.1),f.barLevel>=10&&(i+=.9*(1-Math.pow(Math.E,-f.barLevel/200))),i>=.9999?1e4:1/(1-i)},vn=()=>hn()*(1-f.barEXP/f.barTNL),Xt=i=>{if(i==null)return;let r=1;r+=f.coinUpgrades.barSpeed.upgradeEffect(),r*=f.barFragments.unspentBonus(),r*=Math.pow(1+f.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,f.barEXP/f.barTNL))),r/=vn(),r*=f.talents.barSpeed.talentEffect(),Math.random()<f.coinUpgrades.barReverberation.upgradeEffect()+f.talents.barCriticalChance.talentEffect()&&(r*=f.coinUpgrades.barVibration.upgradeEffect(),f.talents.barCriticalChance.gainEXP(i),f.criticalHits+=1,f.criticalHitsThisRefresh+=1,Ne());let d=r*i;f.barEXP+=d,Ae+=d,S("perSecCurr",{textContent:`+${E(Ae,2)} this sec`})},fe=(i,r)=>Math.min(100,.1*Math.floor(1e3*i/r)),ue=i=>{B("progression",{width:`${i}%`})},ce=()=>{let i=(128+f.barLevel).toString(16).padStart(2,"0"),r=(2*f.barLevel).toString(16).padStart(2,"0"),u=(128+f.barLevel).toString(16).padStart(2,"0");return f.barLevel<128?`#${i}${r}${u}`:"#ffffff"},$t=()=>{f.coins.gain(ne()),f.barEXP-=f.barTNL,f.barLevel+=1,f.barLevel>f.highestBarLevel&&(f.highestBarLevel=f.barLevel);let i=ce();B("progression",{backgroundColor:i}),f.barTNL=ge(),f.barEXP/=10,f.barEXP=Math.min(f.barEXP,Math.floor(f.barTNL/10));let r=fe(f.barEXP,f.barTNL);ue(r),S("coinWorth",{textContent:`Worth ${E(ne())} coins`}),f.barFragments.updateHTML(),f.barLevel===20&&(f.talents.barCriticalChance.updateHTML("Level20"),f.talents.barSpeed.updateHTML("Level20"))},kt=()=>{S("level",{textContent:`Level: ${f.barLevel}`}),S("exp",{textContent:`EXP: ${E(f.barEXP)}/${E(f.barTNL)}`})},Wt=()=>{et=Ae,Ae=0,S("perSecPrev",{textContent:`+${E(et,2)} prev sec`}),f.talents.barCriticalChance.updateHTML("Time"),f.talents.barSpeed.gainEXP(et)},ne=()=>{let i=0,r=1+f.barLevel;r>f.highestBarLevel&&(i+=3),r%5===0&&(i+=Math.floor(r/5)+3),r%10===0&&(i+=Math.floor(r/2)),r%50===0&&(i+=Math.floor(r/2)),r%100===0&&(i+=Math.floor(r));let u=$("coinWorth");return u.style.color=i>0?"gold":"grey",i};var le=i=>{B("mainTab",{display:"none"}),B("upgradeTab",{display:"none"}),B("talentsTab",{display:"none"}),i==="Main"?B("mainTab",{display:"block"}):i==="Upgrades"?B("upgradeTab",{display:"block"}):i==="Talents"&&B("talentsTab",{display:"block"})},$=i=>document.getElementById(i),Ne=()=>{B("progression",{backgroundColor:"gold"}),setTimeout(()=>{B("progression",{backgroundColor:ce()})},250),S("refresh-crit-counter",{textContent:E(f.criticalHitsThisRefresh)}),f.barFragments.updateHTML()},De=()=>{B("progression",{backgroundColor:"cyan"}),setTimeout(()=>{B("progression",{backgroundColor:ce()})},1e3),S("coinWorth",{textContent:`Worth ${E(ne())} coins`}),S("refresh-crit-counter",{textContent:E(f.criticalHitsThisRefresh)}),S("refresh-counter",{textContent:E(f.refreshCount)})};var zt=(i,r)=>{if(document.visibilityState==="hidden")return!1;let u=Object.entries(r);for(let[d,y]of u)i[d]=y;return!0},S=(i,r)=>document.visibilityState==="hidden"?!1:zt($(i),r),B=(i,r)=>document.visibilityState==="hidden"?!1:zt($(i).style,r);var ye=class{constructor(r=0){this.amount=r,this.updateHTML()}spend(r){this.amount>=r&&(this.amount-=r,this.updateHTML())}gain(r){this.amount+=r,this.updateHTML()}set(r){this.amount=r,this.updateHTML()}};var Ue=class extends ye{updateHTML(){S("gold-amount",{textContent:E(this.amount)})}};var He=class extends ye{updateHTML(){S("fragment-amount",{textContent:E(this.amount)}),S("fragment-bonus",{textContent:E(this.amount)}),S("fragment-gain",{textContent:E(this.getAmountOnRefresh())})}getAmountOnRefresh(){if(f!==void 0){let r=f.barLevel,u=100*Math.pow(1.07,-5);return u*=Math.pow(1.07,r),u*=Math.pow(3,Math.floor(r/100)),u*=1+f.criticalHitsThisRefresh*f.coinUpgrades.barAgitation.upgradeEffect(),Math.floor(u)}else return 0}unspentBonus(){return 1+1/100*this.amount}};var Ee=class{constructor(r,u){this.level=r,this.cost=u}};var de=class extends Ee{constructor(r,u){super(r,u);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(r,u){u.shiftKey&&(r=-1),r===-1&&(r=Math.floor(f.coins.amount/this.cost)),this.maxLevel!==-1&&(r=Math.min(r,this.maxLevel-this.level)),this.cost*r<=f.coins.amount&&(f.coins.spend(this.cost*r),this.level+=r,this.updateHTML())}},V={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4},Le=class extends de{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){S("coin-bar-speed-effect",{textContent:`+${E(this.upgradeEffect(),2)} Progress Per Second`})}},xe=class extends de{constructor(r,u){super(r,u);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?.5:.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level)}updateHTML(){S("coin-bar-momentum-effect",{textContent:`Up to ${E(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel&&(S("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),B("coin-bar-momentum-name",{color:"orchid"}))}},Te=class extends de{constructor(r,u){super(r,u);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.1:.09*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+.002*Math.min(5,this.level)}updateHTML(){S("coin-bar-reverberation-effect",{textContent:`+${E(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel&&(S("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),B("coin-bar-reverberation-name",{color:"orchid"}))}},we=class extends de{constructor(r,u){super(r,u);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?200:20+170*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+Math.min(10,this.level)}updateHTML(){S("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${E(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel&&(S("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),B("coin-bar-vibration-name",{color:"orchid"}))}},Se=class extends de{constructor(r,u){super(r,u);this.maxLevel=10;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/5e3}updateHTML(){S("coin-bar-agitation-effect",{textContent:`+${E(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT`}),this.level===this.maxLevel&&(S("coin-bar-agitation-name",{textContent:"Bar Agitation [MAX LEVEL]"}),B("coin-bar-agitation-name",{color:"orchid"}))}};var Vt="coinUpgrades.barSpeed",tt=i=>{var u,d;let r=(u=N(i,Vt))!=null?u:N(f,Vt);return new Le((d=r==null?void 0:r.level)!=null?d:0,V.barSpeed)};var Yt="coinUpgrades.barMomentum",rt=i=>{var u,d;let r=(u=N(i,Yt))!=null?u:N(f,Yt);return new xe((d=r==null?void 0:r.level)!=null?d:0,V.barMomentum)};var Gt="coinUpgrades.barReverberation",nt=i=>{var u,d;let r=(u=N(i,Gt))!=null?u:N(f,Gt);return new Te((d=r==null?void 0:r.level)!=null?d:0,V.barReverberation)};var Kt="coinUpgrades.barVibration",at=i=>{var u,d;let r=(u=N(i,Kt))!=null?u:N(f,Kt);return new we((d=r==null?void 0:r.level)!=null?d:0,V.barVibration)};var Qt="coinUpgrades.barAgitation",ot=i=>{var u,d;let r=(u=N(i,Qt))!=null?u:N(f,Qt);return new Se((d=r==null?void 0:r.level)!=null?d:0,V.barAgitation)};var Jt=(i,r,u,d=1)=>Math.ceil(i*(Math.pow(u,d)-Math.pow(r,d)));var Oe=i=>{if(i==="Refresh"&&f.barLevel>=5){if(f.refreshTime<_e)return alert(`Currently, refreshes have a ${E(_e)} second cooldown. Sorry!`);f.barFragments.set(f.barFragments.getAmountOnRefresh()),f.barEXP=0,f.barLevel=0,f.barTNL=ge(),ue(fe(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),f.talents.barCriticalChance.convertToPerm(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.convertToPerm(),f.talents.barSpeed.updateHTML("Initialize"),f.refreshCount+=1,f.refreshTime=0,f.criticalHitsThisRefresh=0,Ne(),De()}else alert("You cannot refresh yet. Get to level 5 lol")};var it=()=>f.barLevel>=20,st=class extends Ee{constructor(r,u,d,y,T){super(r,u);this.investedFragments=d,this.permLevel=y,this.currEXP=T,this.currTNL=this.calculateTNL()}calculateTNL(){return Jt(this.cost,this.level,this.level+1,2)}setEXP(r){this.currEXP=r,this.updateHTML("GainEXP")}gainEXP(r){if(!it())return;let u=this.calculateEXPGain(r);this.currEXP+=u,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}levelUp(){this.level+=1,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("LevelUp")}computePermLevelGain(r){if(f!==void 0){let u=0;return u+=Math.sqrt(r),u*=Math.min(4,Math.pow(f.refreshTime/300,2)),u=Math.min(r,u),Math.floor(u)}else return 0}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}sacrificeFragments(){if(f!==void 0){if(f.barFragments.amount<1e3)return alert("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(f.barFragments.amount<=this.investedFragments)return alert(`This bar needs more fragments than you can invest. You need ${E(this.investedFragments)}.`);confirm(`You will sacrifice ${E(f.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=f.barFragments.amount,f.refreshTime+=_e,Oe("Refresh"),f.barFragments.set(0))}}updateHTML(r){if(this.idHTML!==void 0){if(r==="Initialize"||r==="GainEXP"||r==="LevelUp"||r==="PermLevelUp"){S(`talent${this.idHTML}EXP`,{textContent:`EXP: ${E(this.currEXP)}/${E(this.currTNL)}`});let u=`${this.getBarWidth()}%`;B(`talent${this.idHTML}Progression`,{width:u})}(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp")&&S(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${E(this.level)}`}),(r==="Initialize"||r==="PermLevelUp")&&S(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${E(this.permLevel)}`}),(r==="Initialize"||r==="Time"||r==="LevelUp")&&S(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${E(this.computePermLevelGain(this.level))}`}),(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp"||r==="Level20")&&S(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}},oe={talentCriticalChance:10,talentProgressSpeed:10},Ce=class extends st{constructor(r,u,d,y,T){super(r,u,d,y,T);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(r){let u=1;return u*=r*1e3/ft,f!==void 0&&(u*=f.barLevel/10-1),u*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),u}talentEffect(){return f!==void 0&&it()?.025*(1-Math.pow(Math.E,-this.level/2500))+.025*Math.min(250,this.level)/250+.025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.025*Math.min(500,this.level)/500:0}displayEffect(){return`+${E(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Me=class extends st{constructor(r,u,d,y,T){super(r,u,d,y,T);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(r){let u=Math.log10(1+r);return f!==void 0&&(u*=f.barLevel/10-1),u*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),u}talentEffect(){return f!==void 0&&it?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${E(100*(this.talentEffect()-1),2)}%`}};var qt="talents.barCriticalChance",ut=i=>{var u,d,y,T,x;let r=(u=N(i,qt))!=null?u:N(f,qt);return new Ce((d=r==null?void 0:r.level)!=null?d:0,oe.talentCriticalChance,(y=r==null?void 0:r.investedFragments)!=null?y:0,(T=r==null?void 0:r.permLevel)!=null?T:0,(x=r==null?void 0:r.currEXP)!=null?x:0)};var Zt="talents.barSpeed",ct=i=>{var u,d,y,T,x;let r=(u=N(i,Zt))!=null?u:N(f,Zt);return new Me((d=r==null?void 0:r.level)!=null?d:0,oe.talentCriticalChance,(y=r==null?void 0:r.investedFragments)!=null?y:0,(T=r==null?void 0:r.permLevel)!=null?T:0,(x=r==null?void 0:r.currEXP)!=null?x:0)};document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(f.coins.updateHTML(),f.coinUpgrades.barMomentum.updateHTML(),f.coinUpgrades.barSpeed.updateHTML(),f.coinUpgrades.barReverberation.updateHTML(),f.coinUpgrades.barVibration.updateHTML(),f.coinUpgrades.barAgitation.updateHTML(),f.barFragments.updateHTML(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.updateHTML("Initialize"),S("coinWorth",{textContent:`Worth ${E(ne())} coins`}))});var jt=()=>{$("main-tab-nav").addEventListener("click",()=>le("Main")),$("upgrade-tab-nav").addEventListener("click",()=>le("Upgrades")),$("talent-tab-nav").addEventListener("click",()=>le("Talents")),$("buy-coin-bar-speed").addEventListener("click",i=>f.coinUpgrades.barSpeed.purchaseLevels(1,i)),$("buy-coin-bar-momentum").addEventListener("click",i=>f.coinUpgrades.barMomentum.purchaseLevels(1,i)),$("buy-coin-bar-reverberation").addEventListener("click",i=>f.coinUpgrades.barReverberation.purchaseLevels(1,i)),$("buy-coin-bar-vibration").addEventListener("click",i=>f.coinUpgrades.barVibration.purchaseLevels(1,i)),$("buy-coin-bar-agitation").addEventListener("click",i=>f.coinUpgrades.barAgitation.purchaseLevels(1,i)),$("buy-reset").addEventListener("click",()=>Oe("Refresh")),$("reset-game").addEventListener("click",()=>void er()),$("talentCriticalChanceSacrifice").addEventListener("click",()=>f.talents.barCriticalChance.sacrificeFragments()),$("talentProgressSpeedSacrifice").addEventListener("click",()=>f.talents.barSpeed.sacrificeFragments())};window.addEventListener("load",async()=>{jt(),await lt(),De()});var f={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,coins:new Ue,coinUpgrades:{barSpeed:new Le(0,V.barSpeed),barMomentum:new xe(0,V.barMomentum),barReverberation:new Te(0,V.barReverberation),barVibration:new we(0,V.barVibration),barAgitation:new Se(0,V.barAgitation)},talents:{barCriticalChance:new Ce(0,oe.talentCriticalChance,0,0,0),barSpeed:new Me(0,oe.talentProgressSpeed,0,0,0)},barFragments:new He,refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0},rr=Object.assign({},f),gn=async()=>{let i=Object.assign({},f,{});await me.default.removeItem("UPBSave");let r=btoa(JSON.stringify(i));r!==null&&await me.default.setItem("UPBSave",r)},tr=new Map([["coins",i=>new Ue(Number(i.coins.amount))],["coinUpgrades.barSpeed",tt],["coinUpgrades.barMomentum",rt],["coinUpgrades.barReverberation",nt],["coinUpgrades.barVibration",at],["coinUpgrades.barAgitation",ot],["talents.barCriticalChance",ut],["talents.barSpeed",ct],["barFragments",i=>new He(Number(i.barFragments.amount))]]),yn=async()=>{console.log("load attempted");let i=await me.default.getItem("UPBSave"),r=i?JSON.parse(atob(i)):null;if(!r)return;let u=Object.keys(r);for(let d of u)d in rr&&(tr.has(d)||Object.defineProperty(f,d,{value:r[d]}));for(let[d,y]of tr)Ft(f,d,y(r))},Ie=new Set,dt=new Proxy(setInterval,{apply(i,r,u){let d=i.apply(r,u);return Ie.add(d),d}}),En=new Proxy(clearInterval,{apply(i,r,u){let d=u[0];return Ie.has(d)&&Ie.delete(d),i.apply(r,u)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var mt=0,ft=24,Ln=5e3,lt=async()=>{for(let i of Ie)En(i);Ie.clear(),await yn(),f.barTNL=ge(),Object.defineProperty(window,"player",{value:f}),ue(fe(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),le("Main"),B("progression",{backgroundColor:ce()}),S("coinWorth",{textContent:`Worth ${E(ne())} coins`}),mt=performance.now(),dt(xn,1e3/ft),dt(Wt,1e3),dt(gn,Ln)},er=async()=>{await me.default.removeItem("UPBSave");let i=btoa(JSON.stringify(rr));await me.default.setItem("UPBSave",i),await lt()},xn=()=>{let r=performance.now()-mt;Tn(r/1e3),mt+=r},Tn=i=>{Xt(i),f.refreshTime+=i,S("refresh-timer",{textContent:`${E(f.refreshTime,2)}s`});let r=fe(f.barEXP,f.barTNL);r<100?ue(r):$t(),kt()},_e=60;})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
