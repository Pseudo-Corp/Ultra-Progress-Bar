(()=>{var Kn=Object.create;var De=Object.defineProperty,Yn=Object.defineProperties,Qn=Object.getOwnPropertyDescriptor,qn=Object.getOwnPropertyDescriptors,Jn=Object.getOwnPropertyNames,pr=Object.getOwnPropertySymbols,Zn=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable;var vr=(r,e,n)=>e in r?De(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,se=(r,e)=>{for(var n in e||(e={}))br.call(e,n)&&vr(r,n,e[n]);if(pr)for(var n of pr(e))jn.call(e,n)&&vr(r,n,e[n]);return r},gr=(r,e)=>Yn(r,qn(e)),ea=r=>De(r,"__esModule",{value:!0});var Me=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(e,n)=>(typeof require!="undefined"?require:e)[n]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var ta=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var ra=(r,e,n,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let f of Jn(e))!br.call(r,f)&&(n||f!=="default")&&De(r,f,{get:()=>e[f],enumerable:!(u=Qn(e,f))||u.enumerable});return r},na=(r,e)=>ra(ea(De(r!=null?Kn(Zn(r)):{},"default",!e&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Mr=ta((Tr,rt)=>{(function(r){if(typeof Tr=="object"&&typeof rt<"u")rt.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=r()}})(function(){var r,e,n;return function u(f,S,E){function R(N,V){if(!S[N]){if(!f[N]){var y=typeof Me=="function"&&Me;if(!V&&y)return y(N,!0);if(P)return P(N,!0);var L=new Error("Cannot find module '"+N+"'");throw L.code="MODULE_NOT_FOUND",L}var U=S[N]={exports:{}};f[N][0].call(U.exports,function(F){var J=f[N][1][F];return R(J||F)},U,U.exports,u,f,S,E)}return S[N].exports}for(var P=typeof Me=="function"&&Me,B=0;B<E.length;B++)R(E[B]);return R}({1:[function(u,f,S){(function(E){"use strict";var R=E.MutationObserver||E.WebKitMutationObserver,P;if(R){var B=0,N=new R(F),V=E.document.createTextNode("");N.observe(V,{characterData:!0}),P=function(){V.data=B=++B%2}}else if(!E.setImmediate&&typeof E.MessageChannel<"u"){var y=new E.MessageChannel;y.port1.onmessage=F,P=function(){y.port2.postMessage(0)}}else"document"in E&&"onreadystatechange"in E.document.createElement("script")?P=function(){var G=E.document.createElement("script");G.onreadystatechange=function(){F(),G.onreadystatechange=null,G.parentNode.removeChild(G),G=null},E.document.documentElement.appendChild(G)}:P=function(){setTimeout(F,0)};var L,U=[];function F(){L=!0;for(var G,ae,X=U.length;X;){for(ae=U,U=[],G=-1;++G<X;)ae[G]();X=U.length}L=!1}f.exports=J;function J(G){U.push(G)===1&&!L&&P()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(u,f,S){"use strict";var E=u(1);function R(){}var P={},B=["REJECTED"],N=["FULFILLED"],V=["PENDING"];f.exports=y;function y(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=V,this.queue=[],this.outcome=void 0,g!==R&&J(this,g)}y.prototype.catch=function(g){return this.then(null,g)},y.prototype.then=function(g,I){if(typeof g!="function"&&this.state===N||typeof I!="function"&&this.state===B)return this;var A=new this.constructor(R);if(this.state!==V){var k=this.state===N?g:I;U(A,k,this.outcome)}else this.queue.push(new L(A,g,I));return A};function L(g,I,A){this.promise=g,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}L.prototype.callFulfilled=function(g){P.resolve(this.promise,g)},L.prototype.otherCallFulfilled=function(g){U(this.promise,this.onFulfilled,g)},L.prototype.callRejected=function(g){P.reject(this.promise,g)},L.prototype.otherCallRejected=function(g){U(this.promise,this.onRejected,g)};function U(g,I,A){E(function(){var k;try{k=I(A)}catch(z){return P.reject(g,z)}k===g?P.reject(g,new TypeError("Cannot resolve promise with itself")):P.resolve(g,k)})}P.resolve=function(g,I){var A=G(F,I);if(A.status==="error")return P.reject(g,A.value);var k=A.value;if(k)J(g,k);else{g.state=N,g.outcome=I;for(var z=-1,Q=g.queue.length;++z<Q;)g.queue[z].callFulfilled(I)}return g},P.reject=function(g,I){g.state=B,g.outcome=I;for(var A=-1,k=g.queue.length;++A<k;)g.queue[A].callRejected(I);return g};function F(g){var I=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof I=="function")return function(){I.apply(g,arguments)}}function J(g,I){var A=!1;function k(j){A||(A=!0,P.reject(g,j))}function z(j){A||(A=!0,P.resolve(g,j))}function Q(){I(z,k)}var Z=G(Q);Z.status==="error"&&k(Z.value)}function G(g,I){var A={};try{A.value=g(I),A.status="success"}catch(k){A.status="error",A.value=k}return A}y.resolve=ae;function ae(g){return g instanceof this?g:P.resolve(new this(R),g)}y.reject=X;function X(g){var I=new this(R);return P.reject(I,g)}y.all=Xe;function Xe(g){var I=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=g.length,k=!1;if(!A)return this.resolve([]);for(var z=new Array(A),Q=0,Z=-1,j=new this(R);++Z<A;)ie(g[Z],Z);return j;function ie(Se,Ae){I.resolve(Se).then(We,function(he){k||(k=!0,P.reject(j,he))});function We(he){z[Ae]=he,++Q===A&&!k&&(k=!0,P.resolve(j,z))}}}y.race=le;function le(g){var I=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=g.length,k=!1;if(!A)return this.resolve([]);for(var z=-1,Q=new this(R);++z<A;)Z(g[z]);return Q;function Z(j){I.resolve(j).then(function(ie){k||(k=!0,P.resolve(Q,ie))},function(ie){k||(k=!0,P.reject(Q,ie))})}}},{"1":1}],3:[function(u,f,S){(function(E){"use strict";typeof E.Promise!="function"&&(E.Promise=u(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(u,f,S){"use strict";var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function R(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function P(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(t){return}}var B=P();function N(){try{if(!B||!B.open)return!1;var t=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),i=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||i)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(a){return!1}}function V(t,i){t=t||[],i=i||{};try{return new Blob(t,i)}catch(o){if(o.name!=="TypeError")throw o;for(var a=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,s=new a,c=0;c<t.length;c+=1)s.append(t[c]);return s.getBlob(i.type)}}typeof Promise>"u"&&u(3);var y=Promise;function L(t,i){i&&t.then(function(a){i(null,a)},function(a){i(a)})}function U(t,i,a){typeof i=="function"&&t.then(i),typeof a=="function"&&t.catch(a)}function F(t){return typeof t!="string"&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function J(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var G="local-forage-detect-blob-support",ae=void 0,X={},Xe=Object.prototype.toString,le="readonly",g="readwrite";function I(t){for(var i=t.length,a=new ArrayBuffer(i),s=new Uint8Array(a),c=0;c<i;c++)s[c]=t.charCodeAt(c);return a}function A(t){return new y(function(i){var a=t.transaction(G,g),s=V([""]);a.objectStore(G).put(s,"key"),a.onabort=function(c){c.preventDefault(),c.stopPropagation(),i(!1)},a.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),o=navigator.userAgent.match(/Edge\//);i(o||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}function k(t){return typeof ae=="boolean"?y.resolve(ae):A(t).then(function(i){return ae=i,ae})}function z(t){var i=X[t.name],a={};a.promise=new y(function(s,c){a.resolve=s,a.reject=c}),i.deferredOperations.push(a),i.dbReady?i.dbReady=i.dbReady.then(function(){return a.promise}):i.dbReady=a.promise}function Q(t){var i=X[t.name],a=i.deferredOperations.pop();if(a)return a.resolve(),a.promise}function Z(t,i){var a=X[t.name],s=a.deferredOperations.pop();if(s)return s.reject(i),s.promise}function j(t,i){return new y(function(a,s){if(X[t.name]=X[t.name]||Qt(),t.db)if(i)z(t),t.db.close();else return a(t.db);var c=[t.name];i&&c.push(t.version);var o=B.open.apply(B,c);i&&(o.onupgradeneeded=function(l){var d=o.result;try{d.createObjectStore(t.storeName),l.oldVersion<=1&&d.createObjectStore(G)}catch(h){if(h.name==="ConstraintError")console.warn('The database "'+t.name+'" has been upgraded from version '+l.oldVersion+" to version "+l.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw h}}),o.onerror=function(l){l.preventDefault(),s(o.error)},o.onsuccess=function(){var l=o.result;l.onversionchange=function(d){d.target.close()},a(l),Q(t)}})}function ie(t){return j(t,!1)}function Se(t){return j(t,!0)}function Ae(t,i){if(!t.db)return!0;var a=!t.db.objectStoreNames.contains(t.storeName),s=t.version<t.db.version,c=t.version>t.db.version;if(s&&(t.version!==i&&console.warn('The database "'+t.name+`" can't be downgraded from version `+t.db.version+" to version "+t.version+"."),t.version=t.db.version),c||a){if(a){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function We(t){return new y(function(i,a){var s=new FileReader;s.onerror=a,s.onloadend=function(c){var o=btoa(c.target.result||"");i({__local_forage_encoded_blob:!0,data:o,type:t.type})},s.readAsBinaryString(t)})}function he(t){var i=I(atob(t.data));return V([i],{type:t.type})}function Yt(t){return t&&t.__local_forage_encoded_blob}function Kr(t){var i=this,a=i._initReady().then(function(){var s=X[i._dbInfo.name];if(s&&s.dbReady)return s.dbReady});return U(a,t,t),a}function Yr(t){z(t);for(var i=X[t.name],a=i.forages,s=0;s<a.length;s++){var c=a[s];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return t.db=null,ie(t).then(function(o){return t.db=o,Ae(t)?Se(t):o}).then(function(o){t.db=i.db=o;for(var l=0;l<a.length;l++)a[l]._dbInfo.db=o}).catch(function(o){throw Z(t,o),o})}function oe(t,i,a,s){s===void 0&&(s=1);try{var c=t.db.transaction(t.storeName,i);a(null,c)}catch(o){if(s>0&&(!t.db||o.name==="InvalidStateError"||o.name==="NotFoundError"))return y.resolve().then(function(){if(!t.db||o.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),Se(t)}).then(function(){return Yr(t).then(function(){oe(t,i,a,s-1)})}).catch(a);a(o)}}function Qt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Qr(t){var i=this,a={db:null};if(t)for(var s in t)a[s]=t[s];var c=X[a.name];c||(c=Qt(),X[a.name]=c),c.forages.push(i),i._initReady||(i._initReady=i.ready,i.ready=Kr);var o=[];function l(){return y.resolve()}for(var d=0;d<c.forages.length;d++){var h=c.forages[d];h!==i&&o.push(h._initReady().catch(l))}var p=c.forages.slice(0);return y.all(o).then(function(){return a.db=c.db,ie(a)}).then(function(b){return a.db=b,Ae(a,i._defaultConfig.version)?Se(a):b}).then(function(b){a.db=c.db=b,i._dbInfo=a;for(var T=0;T<p.length;T++){var w=p[T];w!==i&&(w._dbInfo.db=a.db,w._dbInfo.version=a.version)}})}function qr(t,i){var a=this;t=F(t);var s=new y(function(c,o){a.ready().then(function(){oe(a._dbInfo,le,function(l,d){if(l)return o(l);try{var h=d.objectStore(a._dbInfo.storeName),p=h.get(t);p.onsuccess=function(){var b=p.result;b===void 0&&(b=null),Yt(b)&&(b=he(b)),c(b)},p.onerror=function(){o(p.error)}}catch(b){o(b)}})}).catch(o)});return L(s,i),s}function Jr(t,i){var a=this,s=new y(function(c,o){a.ready().then(function(){oe(a._dbInfo,le,function(l,d){if(l)return o(l);try{var h=d.objectStore(a._dbInfo.storeName),p=h.openCursor(),b=1;p.onsuccess=function(){var T=p.result;if(T){var w=T.value;Yt(w)&&(w=he(w));var D=t(w,T.key,b++);D!==void 0?c(D):T.continue()}else c()},p.onerror=function(){o(p.error)}}catch(T){o(T)}})}).catch(o)});return L(s,i),s}function Zr(t,i,a){var s=this;t=F(t);var c=new y(function(o,l){var d;s.ready().then(function(){return d=s._dbInfo,Xe.call(i)==="[object Blob]"?k(d.db).then(function(h){return h?i:We(i)}):i}).then(function(h){oe(s._dbInfo,g,function(p,b){if(p)return l(p);try{var T=b.objectStore(s._dbInfo.storeName);h===null&&(h=void 0);var w=T.put(h,t);b.oncomplete=function(){h===void 0&&(h=null),o(h)},b.onabort=b.onerror=function(){var D=w.error?w.error:w.transaction.error;l(D)}}catch(D){l(D)}})}).catch(l)});return L(c,a),c}function jr(t,i){var a=this;t=F(t);var s=new y(function(c,o){a.ready().then(function(){oe(a._dbInfo,g,function(l,d){if(l)return o(l);try{var h=d.objectStore(a._dbInfo.storeName),p=h.delete(t);d.oncomplete=function(){c()},d.onerror=function(){o(p.error)},d.onabort=function(){var b=p.error?p.error:p.transaction.error;o(b)}}catch(b){o(b)}})}).catch(o)});return L(s,i),s}function en(t){var i=this,a=new y(function(s,c){i.ready().then(function(){oe(i._dbInfo,g,function(o,l){if(o)return c(o);try{var d=l.objectStore(i._dbInfo.storeName),h=d.clear();l.oncomplete=function(){s()},l.onabort=l.onerror=function(){var p=h.error?h.error:h.transaction.error;c(p)}}catch(p){c(p)}})}).catch(c)});return L(a,t),a}function tn(t){var i=this,a=new y(function(s,c){i.ready().then(function(){oe(i._dbInfo,le,function(o,l){if(o)return c(o);try{var d=l.objectStore(i._dbInfo.storeName),h=d.count();h.onsuccess=function(){s(h.result)},h.onerror=function(){c(h.error)}}catch(p){c(p)}})}).catch(c)});return L(a,t),a}function rn(t,i){var a=this,s=new y(function(c,o){if(t<0){c(null);return}a.ready().then(function(){oe(a._dbInfo,le,function(l,d){if(l)return o(l);try{var h=d.objectStore(a._dbInfo.storeName),p=!1,b=h.openKeyCursor();b.onsuccess=function(){var T=b.result;if(!T){c(null);return}t===0||p?c(T.key):(p=!0,T.advance(t))},b.onerror=function(){o(b.error)}}catch(T){o(T)}})}).catch(o)});return L(s,i),s}function nn(t){var i=this,a=new y(function(s,c){i.ready().then(function(){oe(i._dbInfo,le,function(o,l){if(o)return c(o);try{var d=l.objectStore(i._dbInfo.storeName),h=d.openKeyCursor(),p=[];h.onsuccess=function(){var b=h.result;if(!b){s(p);return}p.push(b.key),b.continue()},h.onerror=function(){c(h.error)}}catch(b){c(b)}})}).catch(c)});return L(a,t),a}function an(t,i){i=J.apply(this,arguments);var a=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||a.name,t.storeName=t.storeName||a.storeName);var s=this,c;if(!t.name)c=y.reject("Invalid arguments");else{var o=t.name===a.name&&s._dbInfo.db,l=o?y.resolve(s._dbInfo.db):ie(t).then(function(d){var h=X[t.name],p=h.forages;h.db=d;for(var b=0;b<p.length;b++)p[b]._dbInfo.db=d;return d});t.storeName?c=l.then(function(d){if(!!d.objectStoreNames.contains(t.storeName)){var h=d.version+1;z(t);var p=X[t.name],b=p.forages;d.close();for(var T=0;T<b.length;T++){var w=b[T];w._dbInfo.db=null,w._dbInfo.version=h}var D=new y(function(_,O){var $=B.open(t.name,h);$.onerror=function(ee){var Te=$.result;Te.close(),O(ee)},$.onupgradeneeded=function(){var ee=$.result;ee.deleteObjectStore(t.storeName)},$.onsuccess=function(){var ee=$.result;ee.close(),_(ee)}});return D.then(function(_){p.db=_;for(var O=0;O<b.length;O++){var $=b[O];$._dbInfo.db=_,Q($._dbInfo)}}).catch(function(_){throw(Z(t,_)||y.resolve()).catch(function(){}),_})}}):c=l.then(function(d){z(t);var h=X[t.name],p=h.forages;d.close();for(var b=0;b<p.length;b++){var T=p[b];T._dbInfo.db=null}var w=new y(function(D,_){var O=B.deleteDatabase(t.name);O.onerror=function(){var $=O.result;$&&$.close(),_(O.error)},O.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},O.onsuccess=function(){var $=O.result;$&&$.close(),D($)}});return w.then(function(D){h.db=D;for(var _=0;_<p.length;_++){var O=p[_];Q(O._dbInfo)}}).catch(function(D){throw(Z(t,D)||y.resolve()).catch(function(){}),D})})}return L(c,i),c}var on={_driver:"asyncStorage",_initStorage:Qr,_support:N(),iterate:Jr,getItem:qr,setItem:Zr,removeItem:jr,clear:en,length:tn,key:rn,keys:nn,dropInstance:an};function sn(){return typeof openDatabase=="function"}var ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cn="~~local_forage_type~",qt=/^~~local_forage_type~([^~]+)~/,He="__lfsc__:",ze=He.length,Ve="arbf",Ke="blob",Jt="si08",Zt="ui08",jt="uic8",er="si16",tr="si32",rr="ur16",nr="ui32",ar="fl32",ir="fl64",or=ze+Ve.length,sr=Object.prototype.toString;function cr(t){var i=t.length*.75,a=t.length,s,c=0,o,l,d,h;t[t.length-1]==="="&&(i--,t[t.length-2]==="="&&i--);var p=new ArrayBuffer(i),b=new Uint8Array(p);for(s=0;s<a;s+=4)o=ue.indexOf(t[s]),l=ue.indexOf(t[s+1]),d=ue.indexOf(t[s+2]),h=ue.indexOf(t[s+3]),b[c++]=o<<2|l>>4,b[c++]=(l&15)<<4|d>>2,b[c++]=(d&3)<<6|h&63;return p}function Ye(t){var i=new Uint8Array(t),a="",s;for(s=0;s<i.length;s+=3)a+=ue[i[s]>>2],a+=ue[(i[s]&3)<<4|i[s+1]>>4],a+=ue[(i[s+1]&15)<<2|i[s+2]>>6],a+=ue[i[s+2]&63];return i.length%3===2?a=a.substring(0,a.length-1)+"=":i.length%3===1&&(a=a.substring(0,a.length-2)+"=="),a}function un(t,i){var a="";if(t&&(a=sr.call(t)),t&&(a==="[object ArrayBuffer]"||t.buffer&&sr.call(t.buffer)==="[object ArrayBuffer]")){var s,c=He;t instanceof ArrayBuffer?(s=t,c+=Ve):(s=t.buffer,a==="[object Int8Array]"?c+=Jt:a==="[object Uint8Array]"?c+=Zt:a==="[object Uint8ClampedArray]"?c+=jt:a==="[object Int16Array]"?c+=er:a==="[object Uint16Array]"?c+=rr:a==="[object Int32Array]"?c+=tr:a==="[object Uint32Array]"?c+=nr:a==="[object Float32Array]"?c+=ar:a==="[object Float64Array]"?c+=ir:i(new Error("Failed to get type for BinaryArray"))),i(c+Ye(s))}else if(a==="[object Blob]"){var o=new FileReader;o.onload=function(){var l=cn+t.type+"~"+Ye(this.result);i(He+Ke+l)},o.readAsArrayBuffer(t)}else try{i(JSON.stringify(t))}catch(l){console.error("Couldn't convert value into a JSON string: ",t),i(null,l)}}function fn(t){if(t.substring(0,ze)!==He)return JSON.parse(t);var i=t.substring(or),a=t.substring(ze,or),s;if(a===Ke&&qt.test(i)){var c=i.match(qt);s=c[1],i=i.substring(c[0].length)}var o=cr(i);switch(a){case Ve:return o;case Ke:return V([o],{type:s});case Jt:return new Int8Array(o);case Zt:return new Uint8Array(o);case jt:return new Uint8ClampedArray(o);case er:return new Int16Array(o);case rr:return new Uint16Array(o);case tr:return new Int32Array(o);case nr:return new Uint32Array(o);case ar:return new Float32Array(o);case ir:return new Float64Array(o);default:throw new Error("Unkown type: "+a)}}var Qe={serialize:un,deserialize:fn,stringToBuffer:cr,bufferToString:Ye};function ur(t,i,a,s){t.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],a,s)}function ln(t){var i=this,a={db:null};if(t)for(var s in t)a[s]=typeof t[s]!="string"?t[s].toString():t[s];var c=new y(function(o,l){try{a.db=openDatabase(a.name,String(a.version),a.description,a.size)}catch(d){return l(d)}a.db.transaction(function(d){ur(d,a,function(){i._dbInfo=a,o()},function(h,p){l(p)})},l)});return a.serializer=Qe,c}function fe(t,i,a,s,c,o){t.executeSql(a,s,c,function(l,d){d.code===d.SYNTAX_ERR?l.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[i.storeName],function(h,p){p.rows.length?o(h,d):ur(h,i,function(){h.executeSql(a,s,c,o)},o)},o):o(l,d)},o)}function mn(t,i){var a=this;t=F(t);var s=new y(function(c,o){a.ready().then(function(){var l=a._dbInfo;l.db.transaction(function(d){fe(d,l,"SELECT * FROM "+l.storeName+" WHERE key = ? LIMIT 1",[t],function(h,p){var b=p.rows.length?p.rows.item(0).value:null;b&&(b=l.serializer.deserialize(b)),c(b)},function(h,p){o(p)})})}).catch(o)});return L(s,i),s}function dn(t,i){var a=this,s=new y(function(c,o){a.ready().then(function(){var l=a._dbInfo;l.db.transaction(function(d){fe(d,l,"SELECT * FROM "+l.storeName,[],function(h,p){for(var b=p.rows,T=b.length,w=0;w<T;w++){var D=b.item(w),_=D.value;if(_&&(_=l.serializer.deserialize(_)),_=t(_,D.key,w+1),_!==void 0){c(_);return}}c()},function(h,p){o(p)})})}).catch(o)});return L(s,i),s}function fr(t,i,a,s){var c=this;t=F(t);var o=new y(function(l,d){c.ready().then(function(){i===void 0&&(i=null);var h=i,p=c._dbInfo;p.serializer.serialize(i,function(b,T){T?d(T):p.db.transaction(function(w){fe(w,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[t,b],function(){l(h)},function(D,_){d(_)})},function(w){if(w.code===w.QUOTA_ERR){if(s>0){l(fr.apply(c,[t,h,a,s-1]));return}d(w)}})})}).catch(d)});return L(o,a),o}function hn(t,i,a){return fr.apply(this,[t,i,a,1])}function pn(t,i){var a=this;t=F(t);var s=new y(function(c,o){a.ready().then(function(){var l=a._dbInfo;l.db.transaction(function(d){fe(d,l,"DELETE FROM "+l.storeName+" WHERE key = ?",[t],function(){c()},function(h,p){o(p)})})}).catch(o)});return L(s,i),s}function vn(t){var i=this,a=new y(function(s,c){i.ready().then(function(){var o=i._dbInfo;o.db.transaction(function(l){fe(l,o,"DELETE FROM "+o.storeName,[],function(){s()},function(d,h){c(h)})})}).catch(c)});return L(a,t),a}function bn(t){var i=this,a=new y(function(s,c){i.ready().then(function(){var o=i._dbInfo;o.db.transaction(function(l){fe(l,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(d,h){var p=h.rows.item(0).c;s(p)},function(d,h){c(h)})})}).catch(c)});return L(a,t),a}function gn(t,i){var a=this,s=new y(function(c,o){a.ready().then(function(){var l=a._dbInfo;l.db.transaction(function(d){fe(d,l,"SELECT key FROM "+l.storeName+" WHERE id = ? LIMIT 1",[t+1],function(h,p){var b=p.rows.length?p.rows.item(0).key:null;c(b)},function(h,p){o(p)})})}).catch(o)});return L(s,i),s}function yn(t){var i=this,a=new y(function(s,c){i.ready().then(function(){var o=i._dbInfo;o.db.transaction(function(l){fe(l,o,"SELECT key FROM "+o.storeName,[],function(d,h){for(var p=[],b=0;b<h.rows.length;b++)p.push(h.rows.item(b).key);s(p)},function(d,h){c(h)})})}).catch(c)});return L(a,t),a}function Sn(t){return new y(function(i,a){t.transaction(function(s){s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,o){for(var l=[],d=0;d<o.rows.length;d++)l.push(o.rows.item(d).name);i({db:t,storeNames:l})},function(c,o){a(o)})},function(s){a(s)})})}function En(t,i){i=J.apply(this,arguments);var a=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||a.name,t.storeName=t.storeName||a.storeName);var s=this,c;return t.name?c=new y(function(o){var l;t.name===a.name?l=s._dbInfo.db:l=openDatabase(t.name,"","",0),t.storeName?o({db:l,storeNames:[t.storeName]}):o(Sn(l))}).then(function(o){return new y(function(l,d){o.db.transaction(function(h){function p(D){return new y(function(_,O){h.executeSql("DROP TABLE IF EXISTS "+D,[],function(){_()},function($,ee){O(ee)})})}for(var b=[],T=0,w=o.storeNames.length;T<w;T++)b.push(p(o.storeNames[T]));y.all(b).then(function(){l()}).catch(function(D){d(D)})},function(h){d(h)})})}):c=y.reject("Invalid arguments"),L(c,i),c}var Tn={_driver:"webSQLStorage",_initStorage:ln,_support:sn(),iterate:dn,getItem:mn,setItem:hn,removeItem:pn,clear:vn,length:bn,key:gn,keys:yn,dropInstance:En};function Mn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function lr(t,i){var a=t.name+"/";return t.storeName!==i.storeName&&(a+=t.storeName+"/"),a}function Pn(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(i){return!0}}function Ln(){return!Pn()||localStorage.length>0}function xn(t){var i=this,a={};if(t)for(var s in t)a[s]=t[s];return a.keyPrefix=lr(t,i._defaultConfig),Ln()?(i._dbInfo=a,a.serializer=Qe,y.resolve()):y.reject()}function Cn(t){var i=this,a=i.ready().then(function(){for(var s=i._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var o=localStorage.key(c);o.indexOf(s)===0&&localStorage.removeItem(o)}});return L(a,t),a}function wn(t,i){var a=this;t=F(t);var s=a.ready().then(function(){var c=a._dbInfo,o=localStorage.getItem(c.keyPrefix+t);return o&&(o=c.serializer.deserialize(o)),o});return L(s,i),s}function Rn(t,i){var a=this,s=a.ready().then(function(){for(var c=a._dbInfo,o=c.keyPrefix,l=o.length,d=localStorage.length,h=1,p=0;p<d;p++){var b=localStorage.key(p);if(b.indexOf(o)===0){var T=localStorage.getItem(b);if(T&&(T=c.serializer.deserialize(T)),T=t(T,b.substring(l),h++),T!==void 0)return T}}});return L(s,i),s}function An(t,i){var a=this,s=a.ready().then(function(){var c=a._dbInfo,o;try{o=localStorage.key(t)}catch(l){o=null}return o&&(o=o.substring(c.keyPrefix.length)),o});return L(s,i),s}function Hn(t){var i=this,a=i.ready().then(function(){for(var s=i._dbInfo,c=localStorage.length,o=[],l=0;l<c;l++){var d=localStorage.key(l);d.indexOf(s.keyPrefix)===0&&o.push(d.substring(s.keyPrefix.length))}return o});return L(a,t),a}function In(t){var i=this,a=i.keys().then(function(s){return s.length});return L(a,t),a}function Dn(t,i){var a=this;t=F(t);var s=a.ready().then(function(){var c=a._dbInfo;localStorage.removeItem(c.keyPrefix+t)});return L(s,i),s}function _n(t,i,a){var s=this;t=F(t);var c=s.ready().then(function(){i===void 0&&(i=null);var o=i;return new y(function(l,d){var h=s._dbInfo;h.serializer.serialize(i,function(p,b){if(b)d(b);else try{localStorage.setItem(h.keyPrefix+t,p),l(o)}catch(T){(T.name==="QuotaExceededError"||T.name==="NS_ERROR_DOM_QUOTA_REACHED")&&d(T),d(T)}})})});return L(c,a),c}function Bn(t,i){if(i=J.apply(this,arguments),t=typeof t!="function"&&t||{},!t.name){var a=this.config();t.name=t.name||a.name,t.storeName=t.storeName||a.storeName}var s=this,c;return t.name?c=new y(function(o){t.storeName?o(lr(t,s._defaultConfig)):o(t.name+"/")}).then(function(o){for(var l=localStorage.length-1;l>=0;l--){var d=localStorage.key(l);d.indexOf(o)===0&&localStorage.removeItem(d)}}):c=y.reject("Invalid arguments"),L(c,i),c}var kn={_driver:"localStorageWrapper",_initStorage:xn,_support:Mn(),iterate:Rn,getItem:wn,setItem:_n,removeItem:Dn,clear:Cn,length:In,key:An,keys:Hn,dropInstance:Bn},Nn=function(i,a){return i===a||typeof i=="number"&&typeof a=="number"&&isNaN(i)&&isNaN(a)},Un=function(i,a){for(var s=i.length,c=0;c<s;){if(Nn(i[c],a))return!0;c++}return!1},mr=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},Ee={},dr={},pe={INDEXEDDB:on,WEBSQL:Tn,LOCALSTORAGE:kn},Fn=[pe.INDEXEDDB._driver,pe.WEBSQL._driver,pe.LOCALSTORAGE._driver],Ie=["dropInstance"],qe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ie),$n={description:"",driver:Fn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function On(t,i){t[i]=function(){var a=arguments;return t.ready().then(function(){return t[i].apply(t,a)})}}function Je(){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i)for(var a in i)i.hasOwnProperty(a)&&(mr(i[a])?arguments[0][a]=i[a].slice():arguments[0][a]=i[a])}return arguments[0]}var Gn=function(){function t(i){R(this,t);for(var a in pe)if(pe.hasOwnProperty(a)){var s=pe[a],c=s._driver;this[a]=c,Ee[c]||this.defineDriver(s)}this._defaultConfig=Je({},$n),this._config=Je({},this._defaultConfig,i),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(a){if((typeof a>"u"?"undefined":E(a))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var s in a){if(s==="storeName"&&(a[s]=a[s].replace(/\W/g,"_")),s==="version"&&typeof a[s]!="number")return new Error("Database version must be a number.");this._config[s]=a[s]}return"driver"in a&&a.driver?this.setDriver(this._config.driver):!0}else return typeof a=="string"?this._config[a]:this._config},t.prototype.defineDriver=function(a,s,c){var o=new y(function(l,d){try{var h=a._driver,p=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver){d(p);return}for(var b=qe.concat("_initStorage"),T=0,w=b.length;T<w;T++){var D=b[T],_=!Un(Ie,D);if((_||a[D])&&typeof a[D]!="function"){d(p);return}}var O=function(){for(var Te=function(zn){return function(){var Vn=new Error("Method "+zn+" is not implemented by the current driver"),hr=y.reject(Vn);return L(hr,arguments[arguments.length-1]),hr}},Ze=0,Wn=Ie.length;Ze<Wn;Ze++){var je=Ie[Ze];a[je]||(a[je]=Te(je))}};O();var $=function(Te){Ee[h]&&console.info("Redefining LocalForage driver: "+h),Ee[h]=a,dr[h]=Te,l()};"_support"in a?a._support&&typeof a._support=="function"?a._support().then($,d):$(!!a._support):$(!0)}catch(ee){d(ee)}});return U(o,s,c),o},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(a,s,c){var o=Ee[a]?y.resolve(Ee[a]):y.reject(new Error("Driver not found."));return U(o,s,c),o},t.prototype.getSerializer=function(a){var s=y.resolve(Qe);return U(s,a),s},t.prototype.ready=function(a){var s=this,c=s._driverSet.then(function(){return s._ready===null&&(s._ready=s._initDriver()),s._ready});return U(c,a,a),c},t.prototype.setDriver=function(a,s,c){var o=this;mr(a)||(a=[a]);var l=this._getSupportedDrivers(a);function d(){o._config.driver=o.driver()}function h(T){return o._extend(T),d(),o._ready=o._initStorage(o._config),o._ready}function p(T){return function(){var w=0;function D(){for(;w<T.length;){var _=T[w];return w++,o._dbInfo=null,o._ready=null,o.getDriver(_).then(h).catch(D)}d();var O=new Error("No available storage method found.");return o._driverSet=y.reject(O),o._driverSet}return D()}}var b=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=b.then(function(){var T=l[0];return o._dbInfo=null,o._ready=null,o.getDriver(T).then(function(w){o._driver=w._driver,d(),o._wrapLibraryMethodsWithReady(),o._initDriver=p(l)})}).catch(function(){d();var T=new Error("No available storage method found.");return o._driverSet=y.reject(T),o._driverSet}),U(this._driverSet,s,c),this._driverSet},t.prototype.supports=function(a){return!!dr[a]},t.prototype._extend=function(a){Je(this,a)},t.prototype._getSupportedDrivers=function(a){for(var s=[],c=0,o=a.length;c<o;c++){var l=a[c];this.supports(l)&&s.push(l)}return s},t.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,s=qe.length;a<s;a++)On(this,qe[a])},t.prototype.createInstance=function(a){return new t(a)},t}(),Xn=new Gn;f.exports=Xn},{"3":3}]},{},[4])(4)})});var tt=r=>{let e=typeof r;return r!==null&&(e==="object"||e==="function")},et=new Set(["__proto__","prototype","constructor"]),aa=new Set("0123456789");function yr(r){let e=[],n="",u="start",f=!1;for(let S of r)switch(S){case"\\":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");f&&(n+=S),u="property",f=!f;break;case".":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="property";break}if(f){f=!1,n+=S;break}if(et.has(n))return[];e.push(n),n="",u="property";break;case"[":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="index";break}if(f){f=!1,n+=S;break}if(u==="property"){if(et.has(n))return[];e.push(n),n=""}u="index";break;case"]":if(u==="index"){e.push(Number.parseInt(n,10)),n="",u="indexEnd";break}if(u==="indexEnd")throw new Error("Invalid character after an index");default:if(u==="index"&&!aa.has(S))throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");u==="start"&&(u="property"),f&&(f=!1,n+="\\"),n+=S}switch(f&&(n+="\\"),u){case"property":{if(et.has(n))return[];e.push(n);break}case"index":throw new Error("Index was not closed");case"start":{e.push("");break}}return e}function Sr(r,e){if(typeof e!="number"&&Array.isArray(r)){let n=Number.parseInt(e,10);return Number.isInteger(n)&&r[n]===r[e]}return!1}function ia(r,e){if(Sr(r,e))throw new Error("Cannot use string index")}function x(r,e,n){if(!tt(r)||typeof e!="string")return n===void 0?r:n;let u=yr(e);if(u.length===0)return n;for(let f=0;f<u.length;f++){let S=u[f];if(Sr(r,S)?r=f===u.length-1?void 0:null:r=r[S],r==null){if(f!==u.length-1)return n;break}}return r===void 0?n:r}function Er(r,e,n){if(!tt(r)||typeof e!="string")return r;let u=r,f=yr(e);for(let S=0;S<f.length;S++){let E=f[S];ia(r,E),S===f.length-1?r[E]=n:tt(r[E])||(r[E]=typeof f[S+1]=="number"?[]:{}),r=r[E]}return u}var Ge=na(Mr());var H=r=>document.getElementById(r),Pr=(r,e)=>{if(document.visibilityState==="hidden")return!1;let n=Object.entries(e);for(let[u,f]of n)r[u]=f;return!0},m=(r,e)=>document.visibilityState==="hidden"?!1:Pr(H(r),e),C=(r,e)=>document.visibilityState==="hidden"?!1:Pr(H(r).style,e);var ce=(r,e)=>r.querySelector(e),oa=(r,e)=>{let n=H("confirmationBox"),u=H("confirmWrapper"),f=ce(document,"#confirm"),S=ce(document,"#transparentBG"),E=ce(f,"#okConfirm"),R=ce(f,"#cancelConfirm");n.style.display="block",u.style.display="block",S.style.display="block",ce(f,"p").textContent=r,f.focus();let P=({target:N})=>{let V=N;return E.removeEventListener("click",P),R.removeEventListener("click",P),f.removeEventListener("keyup",B),n.style.display="none",u.style.display="none",S.style.display="none",e(V===E)},B=N=>N.key==="Enter"||N.key===" "?P({target:E}):N.key==="Escape"?P({target:R}):N.preventDefault();E.addEventListener("click",P),R.addEventListener("click",P),f.addEventListener("keyup",B)},sa=(r,e)=>{let n=H("confirmationBox"),u=H("alertWrapper"),f=ce(document,"#transparentBG"),S=ce(document,"#alert"),E=ce(S,"#okAlert");n.style.display="block",u.style.display="block",f.style.display="block",ce(S,"p").textContent=r,S.focus();let R=()=>{E.removeEventListener("click",R),S.removeEventListener("keyup",P),n.style.display="none",u.style.display="none",f.style.display="none",e(void 0)},P=B=>(B.key==="Enter"||B.key===" ")&&R();E.addEventListener("click",R),S.addEventListener("keyup",P)};var te=r=>new Promise(e=>sa(r,e));var _e=r=>new Promise(e=>oa(r,e));var v=(r,e=0)=>{if(r<0)return"-"+v(-r,e);if(r>=1e6){let B=Math.floor(Math.log10(r));return r/=Math.pow(10,B),v(r,2)+"e"+v(B)}let n=Math.floor(r),u=r-n,f=n.toLocaleString(),S=e>0&&r!==0,E=Math.pow(10,e)*u,R=1e-6;Math.ceil(E)-E<R&&(E=Math.ceil(E));let P=S?Math.floor(E).toString():"";if(P!==""){for(;P.length<e;)P="0"+P;P="."+P}return f+P};var Lr=(r,e,n,u=1)=>Math.ceil(r*(Math.pow(n,u)-Math.pow(e,u)));var K=r=>new Promise(e=>setTimeout(e,r));var ca={HP:120,MP:10,ATK:15,STR:0,DEF:15,ARMOR:0,CRITCHANCE:0,CRITDAMAGE:100},xr=class{constructor(e,n){this.baseStats=se({},e),this.currStats=se({},e),this.attackRate=n,this.delay=0,this.updateHTML("Initialize")}async decreaseDelay(e){this.delay-=e,Be&&this.delay<0&&await this.attack()}computeArmorDamageReduction(){return this.currStats.ARMOR}computeDefenseDamageDivisor(){let e=this.baseStats.DEF;return 1+e/100}computeActualDamageReceived(e){let n=this.computeArmorDamageReduction(),u=this.computeDefenseDamageDivisor();return Math.max(0,e-n/u)}async takeDamage(e){let n=this.computeActualDamageReceived(e);this.currStats.HP-=n,this.currStats.HP=Math.max(0,this.currStats.HP),this.updateHTML("Damage"),this.currStats.HP===0&&(await K(1e3),this.currStats=se({},this.baseStats),this.delay=this.attackRate,this.updateHTML("Initialize"),ve())}computeStrengthModifier(){let e=this.currStats.STR;return 1+e/100}computeDamageBase(){return 1+this.currStats.ATK}computeCriticalDamage(){return this.currStats.CRITDAMAGE/100}computeBaseDamageSent(){let e=this.computeDamageBase(),n=this.computeStrengthModifier(),u=1;return Math.random()<this.currStats.CRITCHANCE&&(u=this.computeCriticalDamage()),e*n*u}async attack(){if(this.delay>0||this.currStats.HP===0)return;let e=this.computeBaseDamageSent();await re.takeDamage(e),this.delay=this.attackRate}computeHPBarWidth(){return 100*(this.currStats.HP/this.baseStats.HP)}computeMPBarWidth(){return 100*(this.currStats.MP/this.baseStats.MP)}updateHTML(e){if(e==="Initialize"&&(m("playerATK",{textContent:`ATK ${this.baseStats.ATK}`}),m("playerSTR",{textContent:`STR ${this.baseStats.STR}`}),m("playerDEF",{textContent:`DEF ${this.baseStats.DEF}`}),m("playerARMOR",{textContent:`ARMOR ${this.baseStats.ARMOR}`}),m("playerCritChance",{textContent:`CritChance ${this.baseStats.CRITCHANCE}`}),m("playerCritDamage",{textContent:`CritDamage ${this.baseStats.CRITDAMAGE}`})),e==="Initialize"||e==="Damage"){m("playerHPText",{textContent:`${v(this.currStats.HP,2)}/${v(this.baseStats.HP)}`});let n=this.computeHPBarWidth();C("playerHPProgression",{width:`${n}%`})}if(e==="Initialize"||e==="Ability"){m("playerMPText",{textContent:`${v(this.currStats.MP,2)}/${v(this.baseStats.MP)}`});let n=this.computeMPBarWidth();C("playerMPProgression",{width:`${n}%`})}}},Y=new xr(ca,.666),Be=!1,Cr=()=>{Be=!Be,m("autoAttack",{textContent:`Auto Fight: ${Be}`})};var q=class{constructor(e,n){this.baseStats=se({},e),this.currStats=se({},e),this.attackRate=n,this.delay=this.attackRate,this.level=this.computeGeneratedLevel(),this.updateHTML("Initialize")}generateAttacks(e){this.currStats.HP>0&&(this.delay-=e,this.delay<0&&(this.makeMove(),this.delay=this.attackRate))}computeGeneratedLevel(){let e=1;return e+=Math.min(25,3*Math.log10(1+this.baseStats.HP)),e+=Math.min(25,3*Math.log10(1+this.baseStats.ATK)),e+=Math.min(25,3*Math.log10(1+this.baseStats.DEF)),e+=Math.min(10,this.baseStats.CRITCHANCE/10),e+=Math.min(13,4*Math.log10(this.baseStats.CRITDAMAGE/100)),e}computeArmorDamageReduction(){return this.currStats.ARMOR*(this.currStats.HP/this.baseStats.HP)}computeDefenseDamageDivisor(){let e=this.currStats.DEF;return 1+e/100}computeActualDamageReceived(e){let n=this.computeArmorDamageReduction(),u=this.computeDefenseDamageDivisor();return Math.max(0,e-n/u)}async takeDamage(e){if(this.currStats.HP===0)return;let n=this.computeActualDamageReceived(e);this.currStats.HP-=n,this.currStats.HP=Math.max(0,this.currStats.HP),this.updateHTML("Damage"),this.currStats.HP===0&&(await K(1e3),ve())}computeStrengthModifier(){let e=this.currStats.STR;return 1+e*(1-this.currStats.HP/this.baseStats.HP)/100}computeDamageBase(){return 1+this.currStats.ATK}computeCriticalDamage(){return this.currStats.CRITDAMAGE/100}computeBaseDamageSent(){let e=this.computeDamageBase(),n=this.computeStrengthModifier(),u=1;return Math.random()<this.currStats.CRITCHANCE&&(u=this.computeCriticalDamage()),e*n*u}computeHPBarWidth(){return 100*(this.currStats.HP/this.baseStats.HP)}computeMPBarWidth(){return 100*(this.currStats.MP/this.baseStats.MP)}makeMove(){this.enemyAI()}updateHTML(e){if((e==="Initialize"||e=="StatChange")&&(m("enemyATK",{textContent:`ATK ${this.currStats.ATK}`}),m("enemySTR",{textContent:`STR ${this.currStats.STR}`}),m("enemyDEF",{textContent:`DEF ${this.currStats.DEF}`}),m("enemyARMOR",{textContent:`ARMOR ${this.currStats.ARMOR}`}),m("enemyCritChance",{textContent:`CritChance ${this.currStats.CRITCHANCE}`}),m("enemyCritDamage",{textContent:`CritDamage ${this.currStats.CRITDAMAGE}`})),e==="Initialize"||e==="Damage"){m("enemyHPText",{textContent:`${v(this.currStats.HP,2)}/${v(this.baseStats.HP)}`});let n=this.computeHPBarWidth();C("enemyHPProgression",{width:`${n}%`})}if(e==="Initialize"||e==="Ability"){m("enemyMPText",{textContent:`${v(this.currStats.MP,2)}/${v(this.baseStats.MP)}`});let n=this.computeMPBarWidth();C("enemyMPProgression",{width:`${n}%`})}}};var nt=class extends q{constructor(e,n){super(e,n);this.enemyType="Aggressive";this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();e<.25&&this.currStats.HP/this.baseStats.HP<.22&&this.currStats.MP>=2?(this.heal(),this.currStats.MP-=2,this.updateHTML("Damage"),this.updateHTML("Ability"),m("enemyMove",{textContent:"HEAL"})):e<.33&&this.currStats.MP>=1?(this.currStats.MP-=1,this.updateHTML("Ability"),m("enemyMove",{textContent:"DoubleHit"}),await this.doubleHit()):e<.5&&this.currStats.MP>=2?(this.currStats.MP-=2,this.updateHTML("Ability"),m("enemyMove",{textContent:"TripleHit"}),await this.tripleHit()):(m("enemyMove",{textContent:"Attack"}),await this.attack())}heal(){this.currStats.HP+=this.baseStats.HP*(.3+.5*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async attack(){let e=this.computeBaseDamageSent();await Y.takeDamage(e)}async doubleHit(){for(let e=0;e<2;e++)await this.attack(),await K(333)}async tripleHit(){for(let e=0;e<3;e++)await this.attack(),await K(250)}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var at=class extends q{constructor(e,n){super(e,n);this.enemyType="BOSS";this.firstAttack=!0,this.usedRage=!1,this.usedEmpowerment=!1,this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();if(this.firstAttack){this.empower(),this.updateHTML("StatChange"),this.updateHTML("Ability"),m("enemyMove",{textContent:"EMPOWER"}),this.firstAttack=!1,this.usedEmpowerment=!0;return}if(!this.usedRage&&this.currStats.HP/this.baseStats.HP<.5){this.rage(),this.updateHTML("StatChange"),this.updateHTML("Ability"),m("enemyMove",{textContent:"RAGE"}),this.usedRage=!0;return}(e<.05||e<.3&&this.currStats.HP/this.baseStats.HP<.05)&&this.currStats.MP>=2?(this.heal(),this.currStats.MP-=2,this.updateHTML("Damage"),this.updateHTML("Ability"),m("enemyMove",{textContent:"HEAL"})):e<.25&&this.currStats.MP>=4?(this.currStats.MP-=4,this.updateHTML("Ability"),m("enemyMove",{textContent:"QuadrupleHit"}),await this.quadrupleHit()):(m("enemyMove",{textContent:"Attack"}),await this.attack())}empower(){this.currStats.ATK=Math.floor(1.3*this.currStats.ATK+2),this.currStats.STR=Math.floor(1.5*this.currStats.STR+2),this.currStats.CRITCHANCE+=25,this.currStats.CRITDAMAGE=Math.floor(1.4*this.currStats.CRITDAMAGE)}rage(){this.currStats.ATK=Math.floor(1.5*this.currStats.ATK),this.currStats.STR=Math.floor(1.8*this.currStats.STR),this.currStats.CRITCHANCE+=75,this.currStats.CRITDAMAGE=Math.floor(1.5*this.currStats.CRITDAMAGE),this.currStats.HP=this.baseStats.HP*(.75+.25*this.level/99)}heal(){this.currStats.HP+=this.baseStats.HP*(.3+.4*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async attack(){let e=this.computeBaseDamageSent();await Y.takeDamage(e)}async quadrupleHit(){for(let e=0;e<2;e++)await this.attack(),await K(200)}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var it=class extends q{constructor(e,n){super(e,n);this.enemyType="Defensive";this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();(e<.1||e<.25&&this.currStats.HP/this.baseStats.HP<.25)&&this.currStats.MP>=2?(this.currStats.MP-=2,this.heal(),this.updateHTML("Damage"),this.updateHTML("Ability"),m("enemyMove",{textContent:"HEAL"})):e<.375&&this.currStats.MP>=1?(this.currStats.MP-=1,this.updateHTML("Ability"),m("enemyMove",{textContent:"DoubleHit"}),await this.doubleHit()):e<.625&&this.currStats.MP>=1?(this.currStats.MP-=1,this.updateHTML("Ability"),m("enemyMove",{textContent:"DefenseUP"}),await this.defenseUp(),this.updateHTML("StatChange")):(m("enemyMove",{textContent:"Attack"}),await this.attack())}heal(){this.currStats.HP+=this.baseStats.HP*(.3+.4*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async defenseUp(){this.currStats.DEF+=.01*this.currStats.DEF+1,this.currStats.DEF=Math.floor(this.currStats.DEF)}async attack(){let e=this.computeBaseDamageSent();await Y.takeDamage(e)}async doubleHit(){for(let e=0;e<2;e++)await this.attack(),await K(333)}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var ot=class extends q{constructor(e,n){super(e,n);this.enemyType="Healer";this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();(e<.333||e<.5&&this.currStats.HP/this.baseStats.HP<.25)&&this.currStats.MP>=2?(this.heal(),this.currStats.MP-=2,this.updateHTML("Damage"),this.updateHTML("Ability"),m("enemyMove",{textContent:"HEAL"})):e<.375&&this.currStats.MP>=1?(this.currStats.MP-=1,this.updateHTML("Ability"),m("enemyMove",{textContent:"DoubleHit"}),await this.doubleHit()):(m("enemyMove",{textContent:"Attack"}),await this.attack())}heal(){this.currStats.HP+=this.baseStats.HP*(.5+.5*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async attack(){let e=this.computeBaseDamageSent();await Y.takeDamage(e)}async doubleHit(){for(let e=0;e<2;e++)await this.attack(),await K(333)}doNothing(){}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var st=class extends q{constructor(e,n){super(e,n);this.enemyType="Idle";this.variantSpecificHTML("Initialize")}enemyAI(){this.doNothing()}doNothing(){}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var ct=class extends q{constructor(e,n){super(e,n);this.enemyType="Random";this.variantSpecificHTML("Initialize")}async enemyAI(){let e=Math.random();e<.125&&this.currStats.MP>=2?(this.heal(),this.currStats.MP-=2,this.updateHTML("Damage"),this.updateHTML("Ability"),m("enemyMove",{textContent:"HEAL"})):e<.25&&this.currStats.MP>=1?(this.currStats.MP-=1,this.updateHTML("Ability"),m("enemyMove",{textContent:"DoubleHit"}),await this.doubleHit()):e<.375&&this.currStats.MP>=2?(this.currStats.MP-=2,this.updateHTML("Ability"),m("enemyMove",{textContent:"TripleHit"}),await this.tripleHit()):e<.75?(m("enemyMove",{textContent:"Attack"}),await this.attack()):(this.doNothing(),m("enemyMove",{textContent:"IDLE"}))}heal(){this.currStats.HP+=this.baseStats.HP*(.3+.5*this.level/99),this.currStats.HP=Math.min(this.currStats.HP,this.baseStats.HP)}async attack(){let e=this.computeBaseDamageSent();await Y.takeDamage(e)}async doubleHit(){for(let e=0;e<2;e++)await this.attack(),await K(333)}async tripleHit(){for(let e=0;e<3;e++)await this.attack(),await K(250)}doNothing(){}variantSpecificHTML(e){e==="Initialize"&&m("enemyName",{textContent:`${this.enemyType} Training Dummy Lv${v(this.level)}`})}};var ua={HP:20,MP:99,ATK:2,STR:0,DEF:0,ARMOR:0,CRITCHANCE:5,CRITDAMAGE:144},fa={HP:200,MP:120,ATK:1,STR:1,DEF:1,ARMOR:1,CRITCHANCE:25,CRITDAMAGE:150},la={HP:50,MP:12,ATK:1,STR:0,DEF:30,ARMOR:1,CRITCHANCE:5,CRITDAMAGE:125},ma={HP:35,MP:24,ATK:1,STR:0,DEF:10,ARMOR:0,CRITCHANCE:0,CRITDAMAGE:100},da={HP:50,MP:1,ATK:0,STR:0,DEF:0,ARMOR:0,CRITCHANCE:0,CRITDAMAGE:100},ha={HP:30,MP:25,ATK:1,STR:1,DEF:1,ARMOR:1,CRITCHANCE:30,CRITDAMAGE:125},re,ve=()=>{let r=Math.random();r<=.1?re=new st(da,1):r<=.3?re=new nt(ua,.75):r<=.5?re=new it(la,1):r<=.7?re=new ot(ma,1):r<=.9?re=new ct(ha,1):re=new at(fa,1.5)};var me=r=>{C("innerTesting",{border:"none"}),C("mainTab",{display:"none"}),C("upgradeTab",{display:"none"}),C("talentsTab",{display:"none"}),C("duelingTab",{display:"none"}),r==="Main"?C("mainTab",{display:"block"}):r==="Upgrades"?C("upgradeTab",{display:"block"}):r==="Talents"?C("talentsTab",{display:"block"}):r==="Dueling"&&(C("duelingTab",{display:"block"}),C("innerTesting",{border:"2px solid grey"}))},ke=(r,e)=>{e?C("progression",{backgroundColor:"gold"}):C("progression",{backgroundColor:"turquoise"}),setTimeout(()=>{C("progression",{backgroundColor:be(r)})},500),m("refresh-crit-counter",{textContent:v(r.criticalHitsThisRefresh)}),m("refresh-crit-fragments",{textContent:v(100*r.criticalHitsThisRefresh*r.coinUpgrades.barAgitation.upgradeEffect(),2)}),r.barFragments.updateHTML()},Ne=r=>{C("progression",{backgroundColor:"cyan"}),setTimeout(()=>{C("progression",{backgroundColor:be(r)})},1e3),m("coinWorth",{textContent:`Worth ${v(r.coinValueCache)} coins`}),r.coinValueCache>0?C("coinWorth",{color:"gold"}):C("coinWorth",{color:"grey"}),m("refresh-crit-counter",{textContent:v(r.criticalHitsThisRefresh)}),m("refresh-counter",{textContent:v(r.refreshCount)})};var pa=10,Ue=0,ut=0,Pe=r=>{let e=0;return e+=pa*Math.pow(r.barLevel+1,2),e*=Math.min(1,(r.barLevel+20)/40),e*=Math.max(1,1+(r.barLevel-20)/10),r.barLevel>40&&(e*=Math.pow(2,1/10*(r.barLevel-40))),r.barLevel>100&&(e*=Math.pow(2,1/10*(r.barLevel-100))),r.barLevel>200&&(e*=Math.pow(2,1/10*(r.barLevel-200))),r.barLevel%5===0&&(e*=Math.max(1,1/2*r.barLevel/10)),e},va=r=>{let e=0;return r.barLevel>=10&&(e+=1-Math.pow(Math.E,-r.barLevel/200)),e>=.9999?1e4:1/(1-e)},ba=r=>{let e=va(r);return Math.max(1,e*(1-r.barEXP/r.barTNL))},ft=(r,e)=>{if(r==null)return;let n=1;if(n+=e.coinUpgrades.barSpeed.upgradeEffect(),n*=e.barFragments.unspentBonus(),n*=Math.pow(1+e.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,e.barEXP/e.barTNL))),n/=ba(e),n*=e.talents.barSpeed.talentEffect(),n*=Math.pow(1+e.coinUpgrades.barEmpowerment.upgradeEffect(),e.barLevel),Math.random()<ht(e)){let S=!1;n*=e.coinUpgrades.barVibration.upgradeEffect(),e.talents.barCriticalChance.gainEXP(r),e.criticalHits+=1,e.criticalHitsThisRefresh+=1,Math.random()<e.coinUpgrades.barResonance.upgradeEffect()&&(n*=3,e.coins.gain(Math.floor(e.barLevel/5)+3),S=!0),ke(e,S)}let f=n*r;e.barEXP+=f,Ue+=f,m("perSecCurr",{textContent:`+${v(Ue,2)} this sec`})},de=(r,e)=>Math.min(100,.1*Math.floor(1e3*r/e)),ge=r=>{C("progression",{width:`${r}%`})},be=r=>{if(r.barLevel%5===0)return r.barLevel>=320?"#FF0000":`#${(128+4*Math.floor(r.barLevel/10)).toString(16).padStart(2,"0")}0000`;if(r.barLevel>=128)return"#FFFFFF";let e=(128+r.barLevel).toString(16).padStart(2,"0"),n=(2*r.barLevel).toString(16).padStart(2,"0"),u=(128+r.barLevel).toString(16).padStart(2,"0");return`#${e}${n}${u}`},lt=r=>{r.coins.gain(r.coinValueCache),r.coinValueCache=dt(r),r.barEXP-=r.barTNL,r.barLevel+=1,r.barLevel>r.highestBarLevel&&(r.highestBarLevel=r.barLevel);let e=be(r);C("progression",{backgroundColor:e}),r.barTNL=Pe(r),r.barEXP/=10,r.barEXP=Math.min(r.barEXP,Math.floor(r.barTNL/10));let n=de(r.barEXP,r.barTNL);ge(n),m("coinWorth",{textContent:`Worth ${v(r.coinValueCache)} coins`}),r.barFragments.updateHTML(),r.barLevel===20&&(r.talents.barCriticalChance.updateHTML("Level20"),r.talents.barSpeed.updateHTML("Level20"))},mt=r=>{m("level",{textContent:`Level: ${r.barLevel}`}),m("exp",{textContent:`EXP: ${v(r.barEXP)}/${v(r.barTNL)}`})},wr=r=>{ut=Ue,Ue=0,m("perSecPrev",{textContent:`+${v(ut,2)} prev sec`}),r.talents.barCriticalChance.updateHTML("Time"),r.talents.barSpeed.gainEXP(ut),r.talents.barSpeed.updateHTML("Time"),r.talents.coinGain.updateHTML("Time")},dt=r=>{let e=0,n=1+r.barLevel;n>r.highestBarLevel&&(e+=3),n%5===0&&(e+=Math.floor(n/5)+3,Math.random()<.5&&n>25&&(e=0)),n%10===0&&(e+=Math.floor(n/2)),n%50===0&&(e+=Math.floor(n/2)),n%100===0&&(e+=Math.floor(n)),e>100&&(e=10*Math.pow(e,1/2)),e*=1+r.talents.coinGain.talentEffect();let u=e-Math.floor(e);Math.random()<u&&(e+=1),e=Math.floor(e);let f=H("coinWorth");return f.style.color=e>0?"gold":"grey",e},ht=r=>r.coinUpgrades.barReverberation.upgradeEffect()+r.talents.barCriticalChance.talentEffect();var Le=class{constructor(e=0,n){this.amount=e;this.player=n;this.amount=e,this.updateHTML()}spend(e){this.amount>=e&&(this.amount-=e,this.updateHTML())}gain(e){this.amount+=e,this.updateHTML(),this.updateOnGain(e)}set(e){this.amount=e,this.updateHTML()}valueOf(){return{amount:this.amount}}};var pt=class extends Le{updateHTML(){m("gold-amount",{textContent:v(this.amount)})}updateOnGain(e){e>0&&this.player.talents.coinGain.gainEXP(e)}};var Rr="coins",vt=(r,e)=>{var u,f;let n=(u=x(r,Rr))!=null?u:x(e,Rr);return new pt((f=n==null?void 0:n.amount)!=null?f:0,e)};var bt=class extends Le{updateHTML(){m("fragment-amount",{textContent:v(this.amount)}),m("fragment-bonus",{textContent:v(this.amount)}),m("fragment-gain",{textContent:v(this.getAmountOnRefresh())})}getAmountOnRefresh(){let e=this.player.barLevel,n=100*Math.pow(1.07,-5);return n*=Math.pow(1.07,e),n*=Math.pow(3,Math.floor(e/100)),n*=1+this.player.criticalHitsThisRefresh*this.player.coinUpgrades.barAgitation.upgradeEffect(),n*=1+this.player.coinUpgrades.barReinforcement.upgradeEffect()*this.player.barLevel,Math.floor(n)}unspentBonus(){return 1+1/100*this.amount}updateOnGain(){}};var Ar="barFragments",gt=(r,e)=>{var u,f;let n=(u=x(r,Ar))!=null?u:x(e,Ar);return new bt((f=n==null?void 0:n.amount)!=null?f:0,e)};var xe=class{constructor(e,n,u){this.level=e;this.cost=n;this.player=u}};var ne=class extends xe{constructor(e,n,u){super(e,n,u);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(e,n){n.shiftKey&&(e=-1,e=Math.floor(this.player.coins.amount/this.cost)),this.maxLevel!==-1&&(e=Math.min(e,this.maxLevel-this.level)),this.cost*e<=this.player.coins.amount&&(this.player.coins.spend(this.cost*e),this.level+=e,this.updateHTML())}valueOf(){return{level:this.level,cost:this.cost,maxLevel:this.maxLevel}}},W={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4,barAdoption:250,barEmpowerment:1e4,barReinforcement:2e4,barResonance:2e3},yt=class extends ne{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){m("coin-bar-speed-effect",{textContent:`+${v(this.upgradeEffect(),2)} Progress Per Second`}),m("coin-bar-speed-name",{textContent:`Bar Speed ${v(this.level)}`})}},St=class extends ne{constructor(e,n,u){super(e,n,u);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?Math.pow(100,1/10)-1:(.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level))*((Math.pow(100,1/10)-1)/.5)}updateHTML(){m("coin-bar-momentum-effect",{textContent:`Up to ${v(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel?(m("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),C("coin-bar-momentum-name",{color:"orchid"})):m("coin-bar-momentum-name",{textContent:`Bar Momentum ${v(this.level)}/${v(this.maxLevel)}`})}},Et=class extends ne{constructor(e,n,u){super(e,n,u);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.01:.009*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+2e-4*Math.min(5,this.level)}updateHTML(){m("coin-bar-reverberation-effect",{textContent:`+${v(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel?(m("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),C("coin-bar-reverberation-name",{color:"orchid"})):m("coin-bar-reverberation-name",{textContent:`Bar Reverberation ${v(this.level)}/${v(this.maxLevel)}`})}},Tt=class extends ne{constructor(e,n,u){super(e,n,u);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?2e3:100+1700*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+20*Math.min(10,this.level)}updateHTML(){m("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${v(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel?(m("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),C("coin-bar-vibration-name",{color:"orchid"})):m("coin-bar-vibration-name",{textContent:`Bar Vibration ${v(this.level)}/${v(this.maxLevel)}`})}},Mt=class extends ne{constructor(e,n,u){super(e,n,u);this.maxLevel=-1;this.updateHTML()}upgradeEffect(){return this.level/500}updateHTML(){m("coin-bar-agitation-effect",{textContent:`+${v(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT.`}),m("coin-bar-agitation-name",{textContent:`Bar Agitation ${v(this.level)}`})}},Pt=class extends ne{constructor(e,n,u){super(e,n,u);this.maxLevel=200;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/100}updateHTML(){m("coin-bar-adoption-effect",{textContent:`+${v(100*this.upgradeEffect())}% Talent EXP`}),this.level===this.maxLevel?(m("coin-bar-adoption-name",{textContent:"Bar Adoption [MAX LEVEL]"}),C("coin-bar-adoption-name",{color:"orchid"})):m("coin-bar-adoption-name",{textContent:`Bar Adoption ${v(this.level)}/${v(this.maxLevel)}`})}},Lt=class extends ne{constructor(e,n,u){super(e,n,u);this.maxLevel=100;this.capLevel(),this.updateHTML()}upgradeEffect(){return .02*this.level/100}updateHTML(){m("coin-bar-empowerment-effect",{textContent:`+${v(100*this.upgradeEffect(),2)}% Progress Speed per bar level: (1+x)^(level)`}),this.level===this.maxLevel?(m("coin-bar-empowerment-name",{textContent:"Bar Empowerment [MAX LEVEL]"}),C("coin-bar-empowerment-name",{color:"orchid"})):m("coin-bar-empowerment-name",{textContent:`Bar Empowerment ${v(this.level)}/${v(this.maxLevel)}`})}},xt=class extends ne{constructor(e,n,u){super(e,n,u);this.maxLevel=-1;this.updateHTML()}upgradeEffect(){return this.level/1e3}updateHTML(){m("coin-bar-reinforcement-effect",{textContent:`+${v(100*this.upgradeEffect(),2)}% Bar Fragments per bar level (1 + x * level)`}),m("coin-bar-reinforcement-name",{textContent:`Bar Reinforcement ${v(this.level)}`})}},Ct=class extends ne{constructor(e,n,u){super(e,n,u);this.expoDivisor=500;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.maxLevel=100*Math.round(this.maxLevel/100),this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?1:1-Math.pow(Math.E,-this.level/this.expoDivisor)}updateHTML(){m("coin-bar-resonance-effect",{textContent:`On CRIT, ${v(100*this.upgradeEffect(),2)}% chance of SUPER
                             CRIT (3x damage and earn coins)`}),this.level===this.maxLevel?(m("coin-bar-resonance-name",{textContent:"Bar Resonance [MAX LEVEL]"}),C("coin-bar-resonance-name",{color:"orchid"})):m("coin-bar-resonance-name",{textContent:`Bar Resonance ${v(this.level)}/${v(this.maxLevel)}`})}};var Hr="coinUpgrades.barSpeed",wt=(r,e)=>{var u,f;let n=(u=x(r,Hr))!=null?u:x(e,Hr);return new yt((f=n==null?void 0:n.level)!=null?f:0,W.barSpeed,e)};var Ir="coinUpgrades.barMomentum",Rt=(r,e)=>{var u,f;let n=(u=x(r,Ir))!=null?u:x(e,Ir);return new St((f=n==null?void 0:n.level)!=null?f:0,W.barMomentum,e)};var Dr="coinUpgrades.barReverberation",At=(r,e)=>{var u,f;let n=(u=x(r,Dr))!=null?u:x(e,Dr);return new Et((f=n==null?void 0:n.level)!=null?f:0,W.barReverberation,e)};var _r="coinUpgrades.barVibration",Ht=(r,e)=>{var u,f;let n=(u=x(r,_r))!=null?u:x(e,_r);return new Tt((f=n==null?void 0:n.level)!=null?f:0,W.barVibration,e)};var Br="coinUpgrades.barAgitation",It=(r,e)=>{var u,f;let n=(u=x(r,Br))!=null?u:x(e,Br);return new Mt((f=n==null?void 0:n.level)!=null?f:0,W.barAgitation,e)};var kr="coinUpgrades.barAdoption",Dt=(r,e)=>{var u,f;let n=(u=x(r,kr))!=null?u:x(e,kr);return new Pt((f=n==null?void 0:n.level)!=null?f:0,W.barAdoption,e)};var Nr="coinUpgrades.barEmpowerment",_t=(r,e)=>{var u,f;let n=(u=x(r,Nr))!=null?u:x(e,Nr);return new Lt((f=n==null?void 0:n.level)!=null?f:0,W.barEmpowerment,e)};var Ur="coinUpgrades.barReinforcement",Bt=(r,e)=>{var u,f;let n=(u=x(r,Ur))!=null?u:x(e,Ur);return new xt((f=n==null?void 0:n.level)!=null?f:0,W.barReinforcement,e)};var Fr="coinUpgrades.barResonance",kt=(r,e)=>{var u,f;let n=(u=x(r,Fr))!=null?u:x(e,Fr);return new Ct((f=n==null?void 0:n.level)!=null?f:0,W.barResonance,e)};var Fe=(r,e)=>{if(r==="Refresh"&&e.barLevel>=5){if(e.refreshTime<Ce)return void te(`Currently, refreshes have a ${v(Ce)} second cooldown. Sorry!`);e.barFragments.set(e.barFragments.getAmountOnRefresh()),e.barEXP=0,e.barLevel=0,e.barTNL=Pe(e),ge(de(e.barEXP,e.barTNL)),e.barFragments.updateHTML(),e.talents.barCriticalChance.convertToPerm(),e.talents.barCriticalChance.updateHTML("Initialize"),e.talents.barSpeed.convertToPerm(),e.talents.barSpeed.updateHTML("Initialize"),e.talents.coinGain.convertToPerm(),e.talents.coinGain.updateHTML("Initialize"),e.refreshCount+=1,e.refreshTime=0,e.criticalHitsThisRefresh=0,e.coinValueCache=dt(e),ke(e,!1),Ne(e)}else return void te("You cannot refresh yet. Get to level 5 lol")};var Nt=r=>r.barLevel>=20,$e=class extends xe{constructor(e,n,u,f,S,E){super(e,n,E);this.investedFragments=u,this.permLevel=f,this.currEXP=S,this.currTNL=this.calculateTNL()}calculateTNL(){let e=Lr(this.cost,this.level,this.level+1,2),n=[50,100,200,500,1e3,2e3,5e3,1e4];for(let u of n)this.level>=u&&(e*=2);return e}setEXP(e){this.currEXP=e,this.updateHTML("GainEXP")}globalTalentEXPMultipliers(){let e=1;return e*=this.sacrificeBoost(),e*=1+this.player.coinUpgrades.barAdoption.upgradeEffect(),e}gainEXP(e){if(!Nt(this.player))return;let n=this.calculateEXPGain(e);this.currEXP+=n,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}subEXP(e){!Nt(this.player)||(this.currEXP-=e)}levelUp(){let e=0;for(;this.currEXP>=this.currTNL&&!(e>=10);)this.level+=1,this.subEXP(this.currTNL),this.currTNL=this.calculateTNL(),e++;this.updateHTML("LevelUp")}computePermLevelGain(e){let n=0;return n+=Math.sqrt(e),n*=Math.min(4,Math.pow(this.player.refreshTime/300,2)),n=Math.min(e,n),Math.floor(n)}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}sacrificeBoost(){return 1+1/100*Math.pow(Math.log2(1+this.investedFragments/4),2)}async sacrificeFragments(){if(this.player.barFragments.amount<1e3)return void te("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(this.player.barFragments.amount<=this.investedFragments)return void te(`This bar needs more fragments than you can invest. You need ${v(this.investedFragments)}.`);await _e(`You will sacrifice ${v(this.player.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=this.player.barFragments.amount,this.player.refreshTime+=Ce,Fe("Refresh",this.player),this.player.barFragments.set(0),this.updateHTML("Sacrifice"))}updateHTML(e){if(this.idHTML!==void 0){if(e==="Initialize"||e==="GainEXP"||e==="LevelUp"||e==="PermLevelUp"){m(`talent${this.idHTML}EXP`,{textContent:`EXP: ${v(this.currEXP)}/${v(this.currTNL)}`});let n=`${this.getBarWidth()}%`;C(`talent${this.idHTML}Progression`,{width:n})}(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp")&&m(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${v(this.level)}`}),(e==="Initialize"||e==="PermLevelUp")&&m(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${v(this.permLevel)}`}),(e==="Initialize"||e==="Time"||e==="LevelUp")&&m(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${v(this.computePermLevelGain(this.level))}`}),(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp"||e==="Level20")&&m(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()}),(e==="Initialize"||e==="Sacrifice")&&(m(`talent${this.idHTML}SacrificeAmount`,{textContent:v(this.investedFragments)}),m(`talent${this.idHTML}SacrificeMultiplier`,{textContent:v(this.sacrificeBoost(),3)}))}}valueOf(){return{level:this.level,cost:this.cost,investedFragments:this.investedFragments,permLevel:this.permLevel,currEXP:this.currEXP,idHTML:this.idHTML}}},ye={talentCriticalChance:10,talentProgressSpeed:10,talentCoinGain:1e3},Ut=class extends $e{constructor(e,n,u,f,S,E){super(e,n,u,f,S,E);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(e){let n=5;return n*=e*1e3/we,n*=this.player.barLevel/10-1,n*=this.globalTalentEXPMultipliers(),n}talentEffect(){return Nt(this.player)?.0025*(1-Math.pow(Math.E,-this.level/2500))+.0025*Math.min(250,this.level)/250+.0025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.0025*Math.min(500,this.level)/500:0}displayEffect(){return`+${v(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Ft=class extends $e{constructor(e,n,u,f,S,E){super(e,n,u,f,S,E);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(e){let n=Math.log10(1+e);return n*=this.player.barLevel/10-1,n*=this.globalTalentEXPMultipliers(),n}talentEffect(){return(1+this.level/25)*(1+this.permLevel/50)}displayEffect(){return`Progress Speed +${v(100*(this.talentEffect()-1),2)}%`}},$t=class extends $e{constructor(e,n,u,f,S,E){super(e,n,u,f,S,E);this.idHTML="CoinGain";this.updateHTML("Initialize")}calculateEXPGain(e){let n=2+Math.floor(Math.pow(e,2)/100+4*e);return n*=this.globalTalentEXPMultipliers(),n}talentEffect(){return Math.min(.4,this.level/1e3)+Math.min(.4,this.permLevel/2e3)+.2*(this.level*25+this.permLevel)/(2500+this.level*25+this.permLevel)+1*(this.level*25+this.permLevel)/(5e4+this.level*25+this.permLevel)}displayEffect(){return`Progress bar grants +${v(100*this.talentEffect(),2)}% coins!`}};var $r="talents.barCriticalChance",Ot=(r,e)=>{var u,f,S,E,R;let n=(u=x(r,$r))!=null?u:x(e,$r);return new Ut((f=n==null?void 0:n.level)!=null?f:0,ye.talentCriticalChance,(S=n==null?void 0:n.investedFragments)!=null?S:0,(E=n==null?void 0:n.permLevel)!=null?E:0,(R=n==null?void 0:n.currEXP)!=null?R:0,e)};var Or="talents.barSpeed",Gt=(r,e)=>{var u,f,S,E,R;let n=(u=x(r,Or))!=null?u:x(e,Or);return new Ft((f=n==null?void 0:n.level)!=null?f:0,ye.talentProgressSpeed,(S=n==null?void 0:n.investedFragments)!=null?S:0,(E=n==null?void 0:n.permLevel)!=null?E:0,(R=n==null?void 0:n.currEXP)!=null?R:0,e)};var Gr="talents.coinGain",Xt=(r,e)=>{var u,f,S,E,R;let n=(u=x(r,Gr))!=null?u:x(e,Gr);return new $t((f=n==null?void 0:n.level)!=null?f:0,ye.talentCoinGain,(S=n==null?void 0:n.investedFragments)!=null?S:0,(E=n==null?void 0:n.permLevel)!=null?E:0,(R=n==null?void 0:n.currEXP)!=null?R:0,e)};var M={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0,coinValueCache:0},Wr=Object.assign({},M),ya=async r=>{var u;let e=gr(se({},r),{coins:r.coins.valueOf(),coinUpgrades:{barSpeed:r.coinUpgrades.barSpeed.valueOf(),barMomentum:r.coinUpgrades.barMomentum.valueOf(),barReverberation:r.coinUpgrades.barReverberation.valueOf(),barVibration:r.coinUpgrades.barVibration.valueOf(),barAgitation:r.coinUpgrades.barAgitation.valueOf(),barAdoption:r.coinUpgrades.barAdoption.valueOf(),barEmpowerment:r.coinUpgrades.barEmpowerment.valueOf(),barReinforcement:r.coinUpgrades.barReinforcement.valueOf(),barResonance:r.coinUpgrades.barResonance.valueOf()},talents:{barCriticalChance:r.talents.barCriticalChance.valueOf(),barSpeed:r.talents.barSpeed.valueOf(),coinGain:r.talents.coinGain.valueOf()},barFragments:r.barFragments.valueOf()}),n=btoa(JSON.stringify(e));if(await Ge.default.setItem("UPBSave",n),typeof((u=navigator.storage)==null?void 0:u.estimate)=="function"){let{usage:f,quota:S}=await navigator.storage.estimate();S&&f&&f/S*100>95&&te("You are very close to running out of space on this computer which may cause your save to getautomatically deleted soon! Clear some other site's data (and tell Khafra that this works please)!")}},Xr=new Map([["coins",vt],["coinUpgrades.barSpeed",wt],["coinUpgrades.barMomentum",Rt],["coinUpgrades.barReverberation",At],["coinUpgrades.barVibration",Ht],["coinUpgrades.barAgitation",It],["coinUpgrades.barAdoption",Dt],["coinUpgrades.barEmpowerment",_t],["coinUpgrades.barReinforcement",Bt],["coinUpgrades.barResonance",kt],["talents.barCriticalChance",Ot],["talents.barSpeed",Gt],["talents.coinGain",Xt],["barFragments",gt]]),Sa=async()=>{let r=await Ge.default.getItem("UPBSave"),e=r?JSON.parse(atob(r)):null;if(e!==null){let n=Object.keys(e);for(let u of n)u in Wr&&(Xr.has(u)||Object.defineProperty(M,u,{value:e[u]}))}for(let[n,u]of Xr)Er(M,n,u(e!=null?e:M,M))},Re=new Set,Oe=new Proxy(setInterval,{apply(r,e,n){let u=r.apply(e,n);return Re.add(u),u}}),Ea=new Proxy(clearInterval,{apply(r,e,n){let u=n[0];return Re.has(u)&&Re.delete(u),r.apply(e,n)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var Wt=0,zt=0,we=24,Ta=6e4,Vt=async()=>{for(let r of Re)Ea(r);Re.clear(),await Sa(),M.barTNL=Pe(M),Object.defineProperty(window,"player",{value:M}),ge(de(M.barEXP,M.barTNL)),M.barFragments.updateHTML(),me("Main"),C("progression",{backgroundColor:be(M)}),m("coinWorth",{textContent:`Worth ${v(M.coinValueCache)} coins`}),M.coinValueCache&&C("coinWorth",{color:"gold"}),Wt=performance.now(),zt=performance.now(),Oe(Ma,1e3/we),Oe(Pa,1e3/we),Oe(wr,1e3,M),Oe(ya,Ta,M),ve()},zr=async()=>{if(await _e("Are you SURE you want to reset the game?")===!1)return te("OK, the game hasn't been reset!");await Ge.default.removeItem("UPBSave");let e=Object.keys(M);for(let n of e){if(typeof M[n]=="object"){delete M[n];continue}Object.defineProperty(M,n,{value:Wr[n]})}await Vt()},Ma=()=>{let e=performance.now()-Wt;Kt(e/1e3),Wt+=e},Pa=async()=>{let e=performance.now()-zt;zt+=e,re.generateAttacks(e/1e3),await Y.decreaseDelay(e/1e3)},Kt=r=>{let e=r;if(e>5){let u=ht(M),f=we*u*5,S=Math.floor(f),E=f-S,R=f*M.coinUpgrades.barResonance.upgradeEffect(),P=Math.floor(R),B=R-P;for(;e>5;){let N=Math.random(),V=0;N<E&&(V=1);let y=S+V;M.criticalHitsThisRefresh+=y;let L=Math.random(),U=0;L<B&&(U+=1);let F=P+U;for(;F>0;)M.coins.gain(Math.floor(M.barLevel/5)+3),F-=1;ft(5,M),e-=5,de(M.barEXP,M.barTNL)>=100&&lt(M),mt(M)}}ft(e,M),M.refreshTime+=r,m("refresh-timer",{textContent:`${v(M.refreshTime,2)}s`});let n=de(M.barEXP,M.barTNL);n<100?ge(n):lt(M),mt(M)},Ce=60;var Vr=r=>{H("main-tab-nav").addEventListener("click",()=>me("Main")),H("upgrade-tab-nav").addEventListener("click",()=>me("Upgrades")),H("talent-tab-nav").addEventListener("click",()=>me("Talents")),H("dueling-tab-nav").addEventListener("click",()=>me("Dueling")),H("buy-coin-bar-speed").addEventListener("click",e=>r.coinUpgrades.barSpeed.purchaseLevels(1,e)),H("buy-coin-bar-momentum").addEventListener("click",e=>r.coinUpgrades.barMomentum.purchaseLevels(1,e)),H("buy-coin-bar-reverberation").addEventListener("click",e=>r.coinUpgrades.barReverberation.purchaseLevels(1,e)),H("buy-coin-bar-vibration").addEventListener("click",e=>r.coinUpgrades.barVibration.purchaseLevels(1,e)),H("buy-coin-bar-agitation").addEventListener("click",e=>r.coinUpgrades.barAgitation.purchaseLevels(1,e)),H("buy-coin-bar-adoption").addEventListener("click",e=>r.coinUpgrades.barAdoption.purchaseLevels(1,e)),H("buy-coin-bar-empowerment").addEventListener("click",e=>r.coinUpgrades.barEmpowerment.purchaseLevels(1,e)),H("buy-coin-bar-reinforcement").addEventListener("click",e=>r.coinUpgrades.barReinforcement.purchaseLevels(1,e)),H("buy-coin-bar-resonance").addEventListener("click",e=>r.coinUpgrades.barResonance.purchaseLevels(1,e)),H("buy-reset").addEventListener("click",()=>Fe("Refresh",r)),H("reset-game").addEventListener("click",()=>void zr()),H("simulate-time").addEventListener("click",()=>void Kt(3600)),H("talentCriticalChanceSacrifice").addEventListener("click",()=>void r.talents.barCriticalChance.sacrificeFragments()),H("talentProgressSpeedSacrifice").addEventListener("click",()=>void r.talents.barSpeed.sacrificeFragments()),H("talentCoinGainSacrifice").addEventListener("click",()=>void r.talents.coinGain.sacrificeFragments()),H("basicAttack").addEventListener("click",()=>void Y.attack()),H("autoAttack").addEventListener("click",()=>void Cr())};window.addEventListener("load",async()=>{var r,e;if(Vr(M),await Vt(),Ne(M),typeof((r=navigator.storage)==null?void 0:r.persist)=="function"&&typeof((e=navigator.storage)==null?void 0:e.persisted)=="function"){let n=await navigator.storage.persisted();n?console.log(`Storage is persistent! (persistent = ${n})`):await navigator.storage.persist()&&te("Data on this page is now persistent! If you do not know what this means, you can safely ignore it.")}});document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(M.coins.updateHTML(),M.coinUpgrades.barMomentum.updateHTML(),M.coinUpgrades.barSpeed.updateHTML(),M.coinUpgrades.barReverberation.updateHTML(),M.coinUpgrades.barVibration.updateHTML(),M.coinUpgrades.barAgitation.updateHTML(),M.barFragments.updateHTML(),M.talents.barCriticalChance.updateHTML("Initialize"),M.talents.barSpeed.updateHTML("Initialize"),m("coinWorth",{textContent:`Worth ${v(M.coinValueCache)} coins`}),M.coinValueCache>0?C("coinWorth",{color:"gold"}):C("coinWorth",{color:"grey"}))});})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
