(()=>{var qt=Object.create;var Ke=Object.defineProperty;var Zt=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var en=Object.getPrototypeOf,rn=Object.prototype.hasOwnProperty;var tn=s=>Ke(s,"__esModule",{value:!0});var he=(s=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(s,{get:(n,l)=>(typeof require!="undefined"?require:n)[l]}):s)(function(s){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+s+'" is not supported')});var nn=(s,n)=>()=>(n||s((n={exports:{}}).exports,n),n.exports);var on=(s,n,l,p)=>{if(n&&typeof n=="object"||typeof n=="function")for(let g of jt(n))!rn.call(s,g)&&(l||g!=="default")&&Ke(s,g,{get:()=>n[g],enumerable:!(p=Zt(n,g))||p.enumerable});return s},an=(s,n)=>on(tn(Ke(s!=null?qt(en(s)):{},"default",!n&&s&&s.__esModule?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var Mr=nn((Pr,Qe)=>{(function(s){if(typeof Pr=="object"&&typeof Qe<"u")Qe.exports=s();else if(typeof define=="function"&&define.amd)define([],s);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.localforage=s()}})(function(){var s,n,l;return function p(g,x,w){function $(X,J){if(!x[X]){if(!g[X]){var b=typeof he=="function"&&he;if(!J&&b)return b(X,!0);if(_)return _(X,!0);var E=new Error("Cannot find module '"+X+"'");throw E.code="MODULE_NOT_FOUND",E}var N=x[X]={exports:{}};g[X][0].call(N.exports,function(U){var q=g[X][1][U];return $(q||U)},N,N.exports,p,g,x,w)}return x[X].exports}for(var _=typeof he=="function"&&he,D=0;D<w.length;D++)$(w[D]);return $}({1:[function(p,g,x){(function(w){"use strict";var $=w.MutationObserver||w.WebKitMutationObserver,_;if($){var D=0,X=new $(U),J=w.document.createTextNode("");X.observe(J,{characterData:!0}),_=function(){J.data=D=++D%2}}else if(!w.setImmediate&&typeof w.MessageChannel<"u"){var b=new w.MessageChannel;b.port1.onmessage=U,_=function(){b.port2.postMessage(0)}}else"document"in w&&"onreadystatechange"in w.document.createElement("script")?_=function(){var O=w.document.createElement("script");O.onreadystatechange=function(){U(),O.onreadystatechange=null,O.parentNode.removeChild(O),O=null},w.document.documentElement.appendChild(O)}:_=function(){setTimeout(U,0)};var E,N=[];function U(){E=!0;for(var O,Z,F=N.length;F;){for(Z=N,N=[],O=-1;++O<F;)Z[O]();F=N.length}E=!1}g.exports=q;function q(O){N.push(O)===1&&!E&&_()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(p,g,x){"use strict";var w=p(1);function $(){}var _={},D=["REJECTED"],X=["FULFILLED"],J=["PENDING"];g.exports=b;function b(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=J,this.queue=[],this.outcome=void 0,v!==$&&q(this,v)}b.prototype.catch=function(v){return this.then(null,v)},b.prototype.then=function(v,C){if(typeof v!="function"&&this.state===X||typeof C!="function"&&this.state===D)return this;var S=new this.constructor($);if(this.state!==J){var R=this.state===X?v:C;N(S,R,this.outcome)}else this.queue.push(new E(S,v,C));return S};function E(v,C,S){this.promise=v,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}E.prototype.callFulfilled=function(v){_.resolve(this.promise,v)},E.prototype.otherCallFulfilled=function(v){N(this.promise,this.onFulfilled,v)},E.prototype.callRejected=function(v){_.reject(this.promise,v)},E.prototype.otherCallRejected=function(v){N(this.promise,this.onRejected,v)};function N(v,C,S){w(function(){var R;try{R=C(S)}catch(k){return _.reject(v,k)}R===v?_.reject(v,new TypeError("Cannot resolve promise with itself")):_.resolve(v,R)})}_.resolve=function(v,C){var S=O(U,C);if(S.status==="error")return _.reject(v,S.value);var R=S.value;if(R)q(v,R);else{v.state=X,v.outcome=C;for(var k=-1,Y=v.queue.length;++k<Y;)v.queue[k].callFulfilled(C)}return v},_.reject=function(v,C){v.state=D,v.outcome=C;for(var S=-1,R=v.queue.length;++S<R;)v.queue[S].callRejected(C);return v};function U(v){var C=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof C=="function")return function(){C.apply(v,arguments)}}function q(v,C){var S=!1;function R(K){S||(S=!0,_.reject(v,K))}function k(K){S||(S=!0,_.resolve(v,K))}function Y(){C(k,R)}var V=O(Y);V.status==="error"&&R(V.value)}function O(v,C){var S={};try{S.value=v(C),S.status="success"}catch(R){S.status="error",S.value=R}return S}b.resolve=Z;function Z(v){return v instanceof this?v:_.resolve(new this($),v)}b.reject=F;function F(v){var C=new this($);return _.reject(C,v)}b.all=Oe;function Oe(v){var C=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,R=!1;if(!S)return this.resolve([]);for(var k=new Array(S),Y=0,V=-1,K=new this($);++V<S;)j(v[V],V);return K;function j(de,Pe){C.resolve(de).then(Fe,function(ie){R||(R=!0,_.reject(K,ie))});function Fe(ie){k[Pe]=ie,++Y===S&&!R&&(R=!0,_.resolve(K,k))}}}b.race=oe;function oe(v){var C=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,R=!1;if(!S)return this.resolve([]);for(var k=-1,Y=new this($);++k<S;)V(v[k]);return Y;function V(K){C.resolve(K).then(function(j){R||(R=!0,_.resolve(Y,j))},function(j){R||(R=!0,_.reject(Y,j))})}}},{"1":1}],3:[function(p,g,x){(function(w){"use strict";typeof w.Promise!="function"&&(w.Promise=p(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(p,g,x){"use strict";var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(e){return}}var D=_();function X(){try{if(!D||!D.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||t)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(r){return!1}}function J(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if(o.name!=="TypeError")throw o;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,a=new r,i=0;i<e.length;i+=1)a.append(e[i]);return a.getBlob(t.type)}}typeof Promise>"u"&&p(3);var b=Promise;function E(e,t){t&&e.then(function(r){t(null,r)},function(r){t(r)})}function N(e,t,r){typeof t=="function"&&e.then(t),typeof r=="function"&&e.catch(r)}function U(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var O="local-forage-detect-blob-support",Z=void 0,F={},Oe=Object.prototype.toString,oe="readonly",v="readwrite";function C(e){for(var t=e.length,r=new ArrayBuffer(t),a=new Uint8Array(r),i=0;i<t;i++)a[i]=e.charCodeAt(i);return r}function S(e){return new b(function(t){var r=e.transaction(O,v),a=J([""]);r.objectStore(O).put(a,"key"),r.onabort=function(i){i.preventDefault(),i.stopPropagation(),t(!1)},r.oncomplete=function(){var i=navigator.userAgent.match(/Chrome\/(\d+)/),o=navigator.userAgent.match(/Edge\//);t(o||!i||parseInt(i[1],10)>=43)}}).catch(function(){return!1})}function R(e){return typeof Z=="boolean"?b.resolve(Z):S(e).then(function(t){return Z=t,Z})}function k(e){var t=F[e.name],r={};r.promise=new b(function(a,i){r.resolve=a,r.reject=i}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function Y(e){var t=F[e.name],r=t.deferredOperations.pop();if(r)return r.resolve(),r.promise}function V(e,t){var r=F[e.name],a=r.deferredOperations.pop();if(a)return a.reject(t),a.promise}function K(e,t){return new b(function(r,a){if(F[e.name]=F[e.name]||ur(),e.db)if(t)k(e),e.db.close();else return r(e.db);var i=[e.name];t&&i.push(e.version);var o=D.open.apply(D,i);t&&(o.onupgradeneeded=function(u){var c=o.result;try{c.createObjectStore(e.storeName),u.oldVersion<=1&&c.createObjectStore(O)}catch(d){if(d.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+u.oldVersion+" to version "+u.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw d}}),o.onerror=function(u){u.preventDefault(),a(o.error)},o.onsuccess=function(){var u=o.result;u.onversionchange=function(c){c.target.close()},r(u),Y(e)}})}function j(e){return K(e,!1)}function de(e){return K(e,!0)}function Pe(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),a=e.version<e.db.version,i=e.version>e.db.version;if(a&&(e.version!==t&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function Fe(e){return new b(function(t,r){var a=new FileReader;a.onerror=r,a.onloadend=function(i){var o=btoa(i.target.result||"");t({__local_forage_encoded_blob:!0,data:o,type:e.type})},a.readAsBinaryString(e)})}function ie(e){var t=C(atob(e.data));return J([t],{type:e.type})}function fr(e){return e&&e.__local_forage_encoded_blob}function Zr(e){var t=this,r=t._initReady().then(function(){var a=F[t._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return N(r,e,e),r}function jr(e){k(e);for(var t=F[e.name],r=t.forages,a=0;a<r.length;a++){var i=r[a];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,j(e).then(function(o){return e.db=o,Pe(e)?de(e):o}).then(function(o){e.db=t.db=o;for(var u=0;u<r.length;u++)r[u]._dbInfo.db=o}).catch(function(o){throw V(e,o),o})}function ee(e,t,r,a){a===void 0&&(a=1);try{var i=e.db.transaction(e.storeName,t);r(null,i)}catch(o){if(a>0&&(!e.db||o.name==="InvalidStateError"||o.name==="NotFoundError"))return b.resolve().then(function(){if(!e.db||o.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),de(e)}).then(function(){return jr(e).then(function(){ee(e,t,r,a-1)})}).catch(r);r(o)}}function ur(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function et(e){var t=this,r={db:null};if(e)for(var a in e)r[a]=e[a];var i=F[r.name];i||(i=ur(),F[r.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=Zr);var o=[];function u(){return b.resolve()}for(var c=0;c<i.forages.length;c++){var d=i.forages[c];d!==t&&o.push(d._initReady().catch(u))}var m=i.forages.slice(0);return b.all(o).then(function(){return r.db=i.db,j(r)}).then(function(h){return r.db=h,Pe(r,t._defaultConfig.version)?de(r):h}).then(function(h){r.db=i.db=h,t._dbInfo=r;for(var y=0;y<m.length;y++){var L=m[y];L!==t&&(L._dbInfo.db=r.db,L._dbInfo.version=r.version)}})}function rt(e,t){var r=this;e=U(e);var a=new b(function(i,o){r.ready().then(function(){ee(r._dbInfo,oe,function(u,c){if(u)return o(u);try{var d=c.objectStore(r._dbInfo.storeName),m=d.get(e);m.onsuccess=function(){var h=m.result;h===void 0&&(h=null),fr(h)&&(h=ie(h)),i(h)},m.onerror=function(){o(m.error)}}catch(h){o(h)}})}).catch(o)});return E(a,t),a}function tt(e,t){var r=this,a=new b(function(i,o){r.ready().then(function(){ee(r._dbInfo,oe,function(u,c){if(u)return o(u);try{var d=c.objectStore(r._dbInfo.storeName),m=d.openCursor(),h=1;m.onsuccess=function(){var y=m.result;if(y){var L=y.value;fr(L)&&(L=ie(L));var P=e(L,y.key,h++);P!==void 0?i(P):y.continue()}else i()},m.onerror=function(){o(m.error)}}catch(y){o(y)}})}).catch(o)});return E(a,t),a}function nt(e,t,r){var a=this;e=U(e);var i=new b(function(o,u){var c;a.ready().then(function(){return c=a._dbInfo,Oe.call(t)==="[object Blob]"?R(c.db).then(function(d){return d?t:Fe(t)}):t}).then(function(d){ee(a._dbInfo,v,function(m,h){if(m)return u(m);try{var y=h.objectStore(a._dbInfo.storeName);d===null&&(d=void 0);var L=y.put(d,e);h.oncomplete=function(){d===void 0&&(d=null),o(d)},h.onabort=h.onerror=function(){var P=L.error?L.error:L.transaction.error;u(P)}}catch(P){u(P)}})}).catch(u)});return E(i,r),i}function ot(e,t){var r=this;e=U(e);var a=new b(function(i,o){r.ready().then(function(){ee(r._dbInfo,v,function(u,c){if(u)return o(u);try{var d=c.objectStore(r._dbInfo.storeName),m=d.delete(e);c.oncomplete=function(){i()},c.onerror=function(){o(m.error)},c.onabort=function(){var h=m.error?m.error:m.transaction.error;o(h)}}catch(h){o(h)}})}).catch(o)});return E(a,t),a}function at(e){var t=this,r=new b(function(a,i){t.ready().then(function(){ee(t._dbInfo,v,function(o,u){if(o)return i(o);try{var c=u.objectStore(t._dbInfo.storeName),d=c.clear();u.oncomplete=function(){a()},u.onabort=u.onerror=function(){var m=d.error?d.error:d.transaction.error;i(m)}}catch(m){i(m)}})}).catch(i)});return E(r,e),r}function it(e){var t=this,r=new b(function(a,i){t.ready().then(function(){ee(t._dbInfo,oe,function(o,u){if(o)return i(o);try{var c=u.objectStore(t._dbInfo.storeName),d=c.count();d.onsuccess=function(){a(d.result)},d.onerror=function(){i(d.error)}}catch(m){i(m)}})}).catch(i)});return E(r,e),r}function st(e,t){var r=this,a=new b(function(i,o){if(e<0){i(null);return}r.ready().then(function(){ee(r._dbInfo,oe,function(u,c){if(u)return o(u);try{var d=c.objectStore(r._dbInfo.storeName),m=!1,h=d.openKeyCursor();h.onsuccess=function(){var y=h.result;if(!y){i(null);return}e===0||m?i(y.key):(m=!0,y.advance(e))},h.onerror=function(){o(h.error)}}catch(y){o(y)}})}).catch(o)});return E(a,t),a}function ft(e){var t=this,r=new b(function(a,i){t.ready().then(function(){ee(t._dbInfo,oe,function(o,u){if(o)return i(o);try{var c=u.objectStore(t._dbInfo.storeName),d=c.openKeyCursor(),m=[];d.onsuccess=function(){var h=d.result;if(!h){a(m);return}m.push(h.key),h.continue()},d.onerror=function(){i(d.error)}}catch(h){i(h)}})}).catch(i)});return E(r,e),r}function ut(e,t){t=q.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var a=this,i;if(!e.name)i=b.reject("Invalid arguments");else{var o=e.name===r.name&&a._dbInfo.db,u=o?b.resolve(a._dbInfo.db):j(e).then(function(c){var d=F[e.name],m=d.forages;d.db=c;for(var h=0;h<m.length;h++)m[h]._dbInfo.db=c;return c});e.storeName?i=u.then(function(c){if(!!c.objectStoreNames.contains(e.storeName)){var d=c.version+1;k(e);var m=F[e.name],h=m.forages;c.close();for(var y=0;y<h.length;y++){var L=h[y];L._dbInfo.db=null,L._dbInfo.version=d}var P=new b(function(M,A){var B=D.open(e.name,d);B.onerror=function(Q){var pe=B.result;pe.close(),A(Q)},B.onupgradeneeded=function(){var Q=B.result;Q.deleteObjectStore(e.storeName)},B.onsuccess=function(){var Q=B.result;Q.close(),M(Q)}});return P.then(function(M){m.db=M;for(var A=0;A<h.length;A++){var B=h[A];B._dbInfo.db=M,Y(B._dbInfo)}}).catch(function(M){throw(V(e,M)||b.resolve()).catch(function(){}),M})}}):i=u.then(function(c){k(e);var d=F[e.name],m=d.forages;c.close();for(var h=0;h<m.length;h++){var y=m[h];y._dbInfo.db=null}var L=new b(function(P,M){var A=D.deleteDatabase(e.name);A.onerror=function(){var B=A.result;B&&B.close(),M(A.error)},A.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},A.onsuccess=function(){var B=A.result;B&&B.close(),P(B)}});return L.then(function(P){d.db=P;for(var M=0;M<m.length;M++){var A=m[M];Y(A._dbInfo)}}).catch(function(P){throw(V(e,P)||b.resolve()).catch(function(){}),P})})}return E(i,t),i}var ct={_driver:"asyncStorage",_initStorage:et,_support:X(),iterate:tt,getItem:rt,setItem:nt,removeItem:ot,clear:at,length:it,key:st,keys:ft,dropInstance:ut};function lt(){return typeof openDatabase=="function"}var re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dt="~~local_forage_type~",cr=/^~~local_forage_type~([^~]+)~/,Me="__lfsc__:",He=Me.length,$e="arbf",Xe="blob",lr="si08",dr="ui08",mr="uic8",pr="si16",hr="si32",vr="ur16",br="ui32",yr="fl32",gr="fl64",Er=He+$e.length,wr=Object.prototype.toString;function Tr(e){var t=e.length*.75,r=e.length,a,i=0,o,u,c,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var m=new ArrayBuffer(t),h=new Uint8Array(m);for(a=0;a<r;a+=4)o=re.indexOf(e[a]),u=re.indexOf(e[a+1]),c=re.indexOf(e[a+2]),d=re.indexOf(e[a+3]),h[i++]=o<<2|u>>4,h[i++]=(u&15)<<4|c>>2,h[i++]=(c&3)<<6|d&63;return m}function ke(e){var t=new Uint8Array(e),r="",a;for(a=0;a<t.length;a+=3)r+=re[t[a]>>2],r+=re[(t[a]&3)<<4|t[a+1]>>4],r+=re[(t[a+1]&15)<<2|t[a+2]>>6],r+=re[t[a+2]&63];return t.length%3===2?r=r.substring(0,r.length-1)+"=":t.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function mt(e,t){var r="";if(e&&(r=wr.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&wr.call(e.buffer)==="[object ArrayBuffer]")){var a,i=Me;e instanceof ArrayBuffer?(a=e,i+=$e):(a=e.buffer,r==="[object Int8Array]"?i+=lr:r==="[object Uint8Array]"?i+=dr:r==="[object Uint8ClampedArray]"?i+=mr:r==="[object Int16Array]"?i+=pr:r==="[object Uint16Array]"?i+=vr:r==="[object Int32Array]"?i+=hr:r==="[object Uint32Array]"?i+=br:r==="[object Float32Array]"?i+=yr:r==="[object Float64Array]"?i+=gr:t(new Error("Failed to get type for BinaryArray"))),t(i+ke(a))}else if(r==="[object Blob]"){var o=new FileReader;o.onload=function(){var u=dt+e.type+"~"+ke(this.result);t(Me+Xe+u)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(u){console.error("Couldn't convert value into a JSON string: ",e),t(null,u)}}function pt(e){if(e.substring(0,He)!==Me)return JSON.parse(e);var t=e.substring(Er),r=e.substring(He,Er),a;if(r===Xe&&cr.test(t)){var i=t.match(cr);a=i[1],t=t.substring(i[0].length)}var o=Tr(t);switch(r){case $e:return o;case Xe:return J([o],{type:a});case lr:return new Int8Array(o);case dr:return new Uint8Array(o);case mr:return new Uint8ClampedArray(o);case pr:return new Int16Array(o);case vr:return new Uint16Array(o);case hr:return new Int32Array(o);case br:return new Uint32Array(o);case yr:return new Float32Array(o);case gr:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var We={serialize:mt,deserialize:pt,stringToBuffer:Tr,bufferToString:ke};function xr(e,t,r,a){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,a)}function ht(e){var t=this,r={db:null};if(e)for(var a in e)r[a]=typeof e[a]!="string"?e[a].toString():e[a];var i=new b(function(o,u){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(c){return u(c)}r.db.transaction(function(c){xr(c,r,function(){t._dbInfo=r,o()},function(d,m){u(m)})},u)});return r.serializer=We,i}function te(e,t,r,a,i,o){e.executeSql(r,a,i,function(u,c){c.code===c.SYNTAX_ERR?u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(d,m){m.rows.length?o(d,c):xr(d,t,function(){d.executeSql(r,a,i,o)},o)},o):o(u,c)},o)}function vt(e,t){var r=this;e=U(e);var a=new b(function(i,o){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(c){te(c,u,"SELECT * FROM "+u.storeName+" WHERE key = ? LIMIT 1",[e],function(d,m){var h=m.rows.length?m.rows.item(0).value:null;h&&(h=u.serializer.deserialize(h)),i(h)},function(d,m){o(m)})})}).catch(o)});return E(a,t),a}function bt(e,t){var r=this,a=new b(function(i,o){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(c){te(c,u,"SELECT * FROM "+u.storeName,[],function(d,m){for(var h=m.rows,y=h.length,L=0;L<y;L++){var P=h.item(L),M=P.value;if(M&&(M=u.serializer.deserialize(M)),M=e(M,P.key,L+1),M!==void 0){i(M);return}}i()},function(d,m){o(m)})})}).catch(o)});return E(a,t),a}function Lr(e,t,r,a){var i=this;e=U(e);var o=new b(function(u,c){i.ready().then(function(){t===void 0&&(t=null);var d=t,m=i._dbInfo;m.serializer.serialize(t,function(h,y){y?c(y):m.db.transaction(function(L){te(L,m,"INSERT OR REPLACE INTO "+m.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){u(d)},function(P,M){c(M)})},function(L){if(L.code===L.QUOTA_ERR){if(a>0){u(Lr.apply(i,[e,d,r,a-1]));return}c(L)}})})}).catch(c)});return E(o,r),o}function yt(e,t,r){return Lr.apply(this,[e,t,r,1])}function gt(e,t){var r=this;e=U(e);var a=new b(function(i,o){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(c){te(c,u,"DELETE FROM "+u.storeName+" WHERE key = ?",[e],function(){i()},function(d,m){o(m)})})}).catch(o)});return E(a,t),a}function Et(e){var t=this,r=new b(function(a,i){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(u){te(u,o,"DELETE FROM "+o.storeName,[],function(){a()},function(c,d){i(d)})})}).catch(i)});return E(r,e),r}function wt(e){var t=this,r=new b(function(a,i){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(u){te(u,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(c,d){var m=d.rows.item(0).c;a(m)},function(c,d){i(d)})})}).catch(i)});return E(r,e),r}function Tt(e,t){var r=this,a=new b(function(i,o){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(c){te(c,u,"SELECT key FROM "+u.storeName+" WHERE id = ? LIMIT 1",[e+1],function(d,m){var h=m.rows.length?m.rows.item(0).key:null;i(h)},function(d,m){o(m)})})}).catch(o)});return E(a,t),a}function xt(e){var t=this,r=new b(function(a,i){t.ready().then(function(){var o=t._dbInfo;o.db.transaction(function(u){te(u,o,"SELECT key FROM "+o.storeName,[],function(c,d){for(var m=[],h=0;h<d.rows.length;h++)m.push(d.rows.item(h).key);a(m)},function(c,d){i(d)})})}).catch(i)});return E(r,e),r}function Lt(e){return new b(function(t,r){e.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(i,o){for(var u=[],c=0;c<o.rows.length;c++)u.push(o.rows.item(c).name);t({db:e,storeNames:u})},function(i,o){r(o)})},function(a){r(a)})})}function St(e,t){t=q.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var a=this,i;return e.name?i=new b(function(o){var u;e.name===r.name?u=a._dbInfo.db:u=openDatabase(e.name,"","",0),e.storeName?o({db:u,storeNames:[e.storeName]}):o(Lt(u))}).then(function(o){return new b(function(u,c){o.db.transaction(function(d){function m(P){return new b(function(M,A){d.executeSql("DROP TABLE IF EXISTS "+P,[],function(){M()},function(B,Q){A(Q)})})}for(var h=[],y=0,L=o.storeNames.length;y<L;y++)h.push(m(o.storeNames[y]));b.all(h).then(function(){u()}).catch(function(P){c(P)})},function(d){c(d)})})}):i=b.reject("Invalid arguments"),E(i,t),i}var _t={_driver:"webSQLStorage",_initStorage:ht,_support:lt(),iterate:bt,getItem:vt,setItem:yt,removeItem:gt,clear:Et,length:wt,key:Tt,keys:xt,dropInstance:St};function It(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Sr(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function Ct(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(t){return!0}}function Pt(){return!Ct()||localStorage.length>0}function Mt(e){var t=this,r={};if(e)for(var a in e)r[a]=e[a];return r.keyPrefix=Sr(e,t._defaultConfig),Pt()?(t._dbInfo=r,r.serializer=We,b.resolve()):b.reject()}function Rt(e){var t=this,r=t.ready().then(function(){for(var a=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var o=localStorage.key(i);o.indexOf(a)===0&&localStorage.removeItem(o)}});return E(r,e),r}function Bt(e,t){var r=this;e=U(e);var a=r.ready().then(function(){var i=r._dbInfo,o=localStorage.getItem(i.keyPrefix+e);return o&&(o=i.serializer.deserialize(o)),o});return E(a,t),a}function Nt(e,t){var r=this,a=r.ready().then(function(){for(var i=r._dbInfo,o=i.keyPrefix,u=o.length,c=localStorage.length,d=1,m=0;m<c;m++){var h=localStorage.key(m);if(h.indexOf(o)===0){var y=localStorage.getItem(h);if(y&&(y=i.serializer.deserialize(y)),y=e(y,h.substring(u),d++),y!==void 0)return y}}});return E(a,t),a}function At(e,t){var r=this,a=r.ready().then(function(){var i=r._dbInfo,o;try{o=localStorage.key(e)}catch(u){o=null}return o&&(o=o.substring(i.keyPrefix.length)),o});return E(a,t),a}function Dt(e){var t=this,r=t.ready().then(function(){for(var a=t._dbInfo,i=localStorage.length,o=[],u=0;u<i;u++){var c=localStorage.key(u);c.indexOf(a.keyPrefix)===0&&o.push(c.substring(a.keyPrefix.length))}return o});return E(r,e),r}function Ut(e){var t=this,r=t.keys().then(function(a){return a.length});return E(r,e),r}function Ot(e,t){var r=this;e=U(e);var a=r.ready().then(function(){var i=r._dbInfo;localStorage.removeItem(i.keyPrefix+e)});return E(a,t),a}function Ft(e,t,r){var a=this;e=U(e);var i=a.ready().then(function(){t===void 0&&(t=null);var o=t;return new b(function(u,c){var d=a._dbInfo;d.serializer.serialize(t,function(m,h){if(h)c(h);else try{localStorage.setItem(d.keyPrefix+e,m),u(o)}catch(y){(y.name==="QuotaExceededError"||y.name==="NS_ERROR_DOM_QUOTA_REACHED")&&c(y),c(y)}})})});return E(i,r),i}function Ht(e,t){if(t=q.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var a=this,i;return e.name?i=new b(function(o){e.storeName?o(Sr(e,a._defaultConfig)):o(e.name+"/")}).then(function(o){for(var u=localStorage.length-1;u>=0;u--){var c=localStorage.key(u);c.indexOf(o)===0&&localStorage.removeItem(c)}}):i=b.reject("Invalid arguments"),E(i,t),i}var $t={_driver:"localStorageWrapper",_initStorage:Mt,_support:It(),iterate:Nt,getItem:Bt,setItem:Ft,removeItem:Ot,clear:Rt,length:Ut,key:At,keys:Dt,dropInstance:Ht},Xt=function(t,r){return t===r||typeof t=="number"&&typeof r=="number"&&isNaN(t)&&isNaN(r)},kt=function(t,r){for(var a=t.length,i=0;i<a;){if(Xt(t[i],r))return!0;i++}return!1},_r=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},me={},Ir={},se={INDEXEDDB:ct,WEBSQL:_t,LOCALSTORAGE:$t},Wt=[se.INDEXEDDB._driver,se.WEBSQL._driver,se.LOCALSTORAGE._driver],Re=["dropInstance"],ze=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Re),zt={description:"",driver:Wt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Yt(e,t){e[t]=function(){var r=arguments;return e.ready().then(function(){return e[t].apply(e,r)})}}function Ye(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(_r(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var Gt=function(){function e(t){$(this,e);for(var r in se)if(se.hasOwnProperty(r)){var a=se[r],i=a._driver;this[r]=i,me[i]||this.defineDriver(a)}this._defaultConfig=Ye({},zt),this._config=Ye({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(r){if((typeof r>"u"?"undefined":w(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in r){if(a==="storeName"&&(r[a]=r[a].replace(/\W/g,"_")),a==="version"&&typeof r[a]!="number")return new Error("Database version must be a number.");this._config[a]=r[a]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},e.prototype.defineDriver=function(r,a,i){var o=new b(function(u,c){try{var d=r._driver,m=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){c(m);return}for(var h=ze.concat("_initStorage"),y=0,L=h.length;y<L;y++){var P=h[y],M=!kt(Re,P);if((M||r[P])&&typeof r[P]!="function"){c(m);return}}var A=function(){for(var pe=function(Qt){return function(){var Jt=new Error("Method "+Qt+" is not implemented by the current driver"),Cr=b.reject(Jt);return E(Cr,arguments[arguments.length-1]),Cr}},Ge=0,Kt=Re.length;Ge<Kt;Ge++){var Ve=Re[Ge];r[Ve]||(r[Ve]=pe(Ve))}};A();var B=function(pe){me[d]&&console.info("Redefining LocalForage driver: "+d),me[d]=r,Ir[d]=pe,u()};"_support"in r?r._support&&typeof r._support=="function"?r._support().then(B,c):B(!!r._support):B(!0)}catch(Q){c(Q)}});return N(o,a,i),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(r,a,i){var o=me[r]?b.resolve(me[r]):b.reject(new Error("Driver not found."));return N(o,a,i),o},e.prototype.getSerializer=function(r){var a=b.resolve(We);return N(a,r),a},e.prototype.ready=function(r){var a=this,i=a._driverSet.then(function(){return a._ready===null&&(a._ready=a._initDriver()),a._ready});return N(i,r,r),i},e.prototype.setDriver=function(r,a,i){var o=this;_r(r)||(r=[r]);var u=this._getSupportedDrivers(r);function c(){o._config.driver=o.driver()}function d(y){return o._extend(y),c(),o._ready=o._initStorage(o._config),o._ready}function m(y){return function(){var L=0;function P(){for(;L<y.length;){var M=y[L];return L++,o._dbInfo=null,o._ready=null,o.getDriver(M).then(d).catch(P)}c();var A=new Error("No available storage method found.");return o._driverSet=b.reject(A),o._driverSet}return P()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=h.then(function(){var y=u[0];return o._dbInfo=null,o._ready=null,o.getDriver(y).then(function(L){o._driver=L._driver,c(),o._wrapLibraryMethodsWithReady(),o._initDriver=m(u)})}).catch(function(){c();var y=new Error("No available storage method found.");return o._driverSet=b.reject(y),o._driverSet}),N(this._driverSet,a,i),this._driverSet},e.prototype.supports=function(r){return!!Ir[r]},e.prototype._extend=function(r){Ye(this,r)},e.prototype._getSupportedDrivers=function(r){for(var a=[],i=0,o=r.length;i<o;i++){var u=r[i];this.supports(u)&&a.push(u)}return a},e.prototype._wrapLibraryMethodsWithReady=function(){for(var r=0,a=ze.length;r<a;r++)Yt(this,ze[r])},e.prototype.createInstance=function(r){return new e(r)},e}(),Vt=new Gt;g.exports=Vt},{"3":3}]},{},[4])(4)})});var le=an(Mr());var qe=s=>{let n=typeof s;return s!==null&&(n==="object"||n==="function")},Je=new Set(["__proto__","prototype","constructor"]),sn=new Set("0123456789");function Rr(s){let n=[],l="",p="start",g=!1;for(let x of s)switch(x){case"\\":if(p==="index")throw new Error("Invalid character in an index");if(p==="indexEnd")throw new Error("Invalid character after an index");g&&(l+=x),p="property",g=!g;break;case".":if(p==="index")throw new Error("Invalid character in an index");if(p==="indexEnd"){p="property";break}if(g){g=!1,l+=x;break}if(Je.has(l))return[];n.push(l),l="",p="property";break;case"[":if(p==="index")throw new Error("Invalid character in an index");if(p==="indexEnd"){p="index";break}if(g){g=!1,l+=x;break}if(p==="property"){if(Je.has(l))return[];n.push(l),l=""}p="index";break;case"]":if(p==="index"){n.push(Number.parseInt(l,10)),l="",p="indexEnd";break}if(p==="indexEnd")throw new Error("Invalid character after an index");default:if(p==="index"&&!sn.has(x))throw new Error("Invalid character in an index");if(p==="indexEnd")throw new Error("Invalid character after an index");p==="start"&&(p="property"),g&&(g=!1,l+="\\"),l+=x}switch(g&&(l+="\\"),p){case"property":{if(Je.has(l))return[];n.push(l);break}case"index":throw new Error("Index was not closed");case"start":{n.push("");break}}return n}function Br(s,n){if(typeof n!="number"&&Array.isArray(s)){let l=Number.parseInt(n,10);return Number.isInteger(l)&&s[l]===s[n]}return!1}function fn(s,n){if(Br(s,n))throw new Error("Cannot use string index")}function H(s,n,l){if(!qe(s)||typeof n!="string")return l===void 0?s:l;let p=Rr(n);if(p.length===0)return l;for(let g=0;g<p.length;g++){let x=p[g];if(Br(s,x)?s=g===p.length-1?void 0:null:s=s[x],s==null){if(g!==p.length-1)return l;break}}return s===void 0?l:s}function Nr(s,n,l){if(!qe(s)||typeof n!="string")return s;let p=s,g=Rr(n);for(let x=0;x<g.length;x++){let w=g[x];fn(s,w),x===g.length-1?s[w]=l:qe(s[w])||(s[w]=typeof g[x+1]=="number"?[]:{}),s=s[w]}return p}var T=(s,n=0)=>{if(s<0)return"-"+T(-s,n);if(s>=1e6){let D=Math.floor(Math.log10(s));return s/=Math.pow(10,D),T(s,2)+"e"+T(D)}let l=Math.floor(s),p=s-l,g=l.toLocaleString(),x=n>0&&s!==0,w=Math.pow(10,n)*p,$=1e-6;Math.ceil(w)-w<$&&(w=Math.ceil(w));let _=x?Math.floor(w).toString():"";if(_!==""){for(;_.length<n;)_="0"+_;_="."+_}return g+_};var un=10,Be=0,Ne=0,ve=()=>{let s=0;return s+=un*Math.pow(f.barLevel+1,2),s*=Math.min(1,(f.barLevel+20)/40),s*=Math.max(1,1+(f.barLevel-20)/10),f.barLevel>40&&(s*=Math.pow(2,1/10*(f.barLevel-40))),f.barLevel>100&&(s*=Math.pow(2,1/10*(f.barLevel-100))),f.barLevel>200&&(s*=Math.pow(2,1/10*(f.barLevel-200))),s},cn=()=>{let s=0;return f.barLevel>=5&&(s=.2),f.barLevel>=10&&(s+=.8*(1-Math.pow(Math.E,-(f.barLevel-10)/90))),s},ln=()=>{let s=cn();return 1-Math.max(0,s*(1-f.barEXP/f.barTNL))},Ar=s=>{if(s==null)return;let n=1;n+=f.coinUpgrades.barSpeed.upgradeEffect(),n*=f.barFragments.unspentBonus(),n*=Math.pow(1+f.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,f.barEXP/f.barTNL))),n*=ln(),n*=f.talents.barSpeed.talentEffect(),Math.random()<f.coinUpgrades.barReverberation.upgradeEffect()+f.talents.barCriticalChance.talentEffect()&&(n*=f.coinUpgrades.barVibration.upgradeEffect(),Fr(),f.talents.barCriticalChance.gainEXP());let p=n*s;f.barEXP+=p,Be+=p,I("perSecCurr",{textContent:`+${T(Be,2)} this sec`})},fe=(s,n)=>Math.min(100,.1*Math.floor(1e3*s/n)),ue=s=>{z("progression",{width:`${s}%`})},be=()=>{let s=(128+f.barLevel).toString(16),n=(2*f.barLevel).toString(16),l=(128+f.barLevel).toString(16);return f.barLevel<128?`#${s}${n}${l}`:"#ffffff"},Dr=()=>{f.coins.gain(ne()),f.barEXP-=f.barTNL,f.barLevel+=1,f.barLevel>f.highestBarLevel&&(f.highestBarLevel=f.barLevel);let s=be();z("progression",{backgroundColor:s}),f.barTNL=ve(),f.barEXP/=10,f.barEXP=Math.min(f.barEXP,Math.floor(f.barTNL/10));let n=fe(f.barEXP,f.barTNL);ue(n),I("coinWorth",{textContent:`Worth ${T(ne())} coins`}),f.barFragments.updateHTML(),f.barLevel===20&&(f.talents.barCriticalChance.updateHTML("Level20"),f.talents.barSpeed.updateHTML("Level20"))},Ur=()=>{I("level",{textContent:`Level: ${f.barLevel}`}),I("exp",{textContent:`EXP: ${T(f.barEXP)}/${T(f.barTNL)}`})},Or=()=>{Ne=Be,Be=0,I("perSecPrev",{textContent:`+${T(Ne,2)} prev sec`}),f.talents.barCriticalChance.updateHTML("Time"),f.talents.barSpeed.gainEXP()},ne=()=>{let s=0,n=1+f.barLevel;n>f.highestBarLevel&&(s+=3),n%5===0&&(s+=Math.floor(n/5)+3),n%10===0&&(s+=Math.floor(n/2)),n%50===0&&(s+=Math.floor(n/2)),n%100===0&&(s+=Math.floor(n));let l=W("coinWorth");return l.style.color=s>0?"gold":"grey",s};var ce=s=>{z("mainTab",{display:"none"}),z("upgradeTab",{display:"none"}),z("talentsTab",{display:"none"}),s==="Main"?z("mainTab",{display:"block"}):s==="Upgrades"?z("upgradeTab",{display:"block"}):s==="Talents"&&z("talentsTab",{display:"block"})},W=s=>document.getElementById(s),Fr=()=>{z("progression",{backgroundColor:"gold"}),setTimeout(()=>{z("progression",{backgroundColor:be()})},250)};var Hr=(s,n)=>{if(document.visibilityState==="hidden")return!1;let l=Object.entries(n);for(let[p,g]of l)s[p]=g;return!0},I=(s,n)=>document.visibilityState==="hidden"?!1:Hr(W(s),n),z=(s,n)=>document.visibilityState==="hidden"?!1:Hr(W(s).style,n);var ye=class{constructor(n=0){this.amount=n,this.updateHTML()}spend(n){this.amount>=n&&(this.amount-=n,this.updateHTML())}gain(n){this.amount+=n,this.updateHTML()}set(n){this.amount=n,this.updateHTML()}};var Ae=class extends ye{updateHTML(){I("gold-amount",{textContent:T(this.amount)})}};var De=class extends ye{updateHTML(){I("fragment-amount",{textContent:T(this.amount)}),I("fragment-bonus",{textContent:T(this.amount)}),I("fragment-gain",{textContent:T(this.getAmountOnRefresh())})}getAmountOnRefresh(n=0){f!==void 0&&(n=f.barLevel);let l=100*Math.pow(1.07,-5);return l*=Math.pow(1.07,n),l*=Math.pow(1.07,Math.floor(n/5)),Math.floor(l)}unspentBonus(){return 1+1/100*this.amount}};var ge=class{constructor(n,l){this.level=n,this.cost=l}};var Ee=class extends ge{constructor(n,l){super(n,l);this.updateHTML()}purchaseLevels(n,l){l.shiftKey&&(n=-1),n===-1&&(n=Math.floor(f.coins.amount/this.cost)),this.cost*n<=f.coins.amount&&(f.coins.spend(this.cost*n),this.level+=n,this.updateHTML())}},G={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50},we=class extends Ee{upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){I("coin-bar-speed-effect",{textContent:`+${T(this.upgradeEffect(),2)} Progress Per Second`})}},Te=class extends Ee{upgradeEffect(){return .45*(1-Math.pow(Math.E,-this.level/400))+1/200*Math.min(10,this.level)}updateHTML(){I("coin-bar-momentum-effect",{textContent:`Up to ${T(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`})}},xe=class extends Ee{upgradeEffect(){return .09*(1-Math.pow(Math.E,-this.level/100))+.002*Math.min(5,this.level)}updateHTML(){I("coin-bar-reverberation-effect",{textContent:`+${T(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`})}},Le=class extends Ee{upgradeEffect(){return 20+960*(1-Math.pow(Math.E,-this.level/980))+Math.min(20,this.level)}updateHTML(){I("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${T(this.upgradeEffect(),2)}x faster`})}};var $r="coinUpgrades.barSpeed",Ze=s=>{var l,p;let n=(l=H(s,$r))!=null?l:H(f,$r);return new we((p=n==null?void 0:n.level)!=null?p:0,G.barSpeed)};var Xr="coinUpgrades.barMomentum",je=s=>{var l,p;let n=(l=H(s,Xr))!=null?l:H(f,Xr);return new Te((p=n==null?void 0:n.level)!=null?p:0,G.barMomentum)};var kr="coinUpgrades.barReverberation",er=s=>{var l,p;let n=(l=H(s,kr))!=null?l:H(f,kr);return new xe((p=n==null?void 0:n.level)!=null?p:0,G.barReverberation)};var Wr="coinUpgrades.barVibration",rr=s=>{var l,p;let n=(l=H(s,Wr))!=null?l:H(f,Wr);return new Le((p=n==null?void 0:n.level)!=null?p:0,G.barVibration)};var zr=(s,n,l,p=1)=>Math.ceil(s*(Math.pow(l,p)-Math.pow(n,p)));var Ue=s=>{if(s==="Refresh"&&f.barLevel>=5){if(f.refreshTime<Se)return alert(`Currently, refreshes have a ${T(Se)} second cooldown. Sorry!`);f.barFragments.set(f.barFragments.getAmountOnRefresh()),f.barEXP=0,f.barLevel=0,f.barTNL=ve(),ue(fe(f.barEXP,f.barTNL)),I("coinWorth",{textContent:`Worth ${T(ne())} coins`}),f.barFragments.updateHTML(),f.talents.barCriticalChance.convertToPerm(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.convertToPerm(),f.talents.barSpeed.updateHTML("Initialize"),f.refreshCount+=1,f.refreshTime=0,I("refresh-counter",{textContent:T(f.refreshCount)})}else alert("You cannot refresh yet. Get to level 5 lol")};var tr=()=>f.barLevel>=20,nr=class extends ge{constructor(n,l,p,g,x){super(n,l);this.investedFragments=p,this.permLevel=g,this.currEXP=x,this.currTNL=this.calculateTNL()}calculateTNL(){return zr(this.cost,this.level,this.level+1,2)}setEXP(n){this.currEXP=n,this.updateHTML("GainEXP")}gainEXP(){if(!tr())return;let n=this.calculateEXPGain();this.currEXP+=n,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}levelUp(){this.level+=1,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("LevelUp")}computePermLevelGain(n){if(f!==void 0){let l=0;return l+=Math.sqrt(n),l*=Math.min(4,Math.pow(f.refreshTime/300,2)),l=Math.min(n,l),Math.floor(l)}else return 0}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}sacrificeFragments(){if(f!==void 0){if(f.barFragments.amount<1e3)return alert("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(f.barFragments.amount<=this.investedFragments)return alert(`This bar needs more fragments than you can invest. You need ${T(this.investedFragments)}.`);confirm(`You will sacrifice ${T(f.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=f.barFragments.amount,f.refreshTime+=Se,Ue("Refresh"),f.barFragments.set(0))}}updateHTML(n){if(this.idHTML!==void 0){if(n==="Initialize"||n==="GainEXP"||n==="LevelUp"||n==="PermLevelUp"){I(`talent${this.idHTML}EXP`,{textContent:`EXP: ${T(this.currEXP)}/${T(this.currTNL)}`});let l=`${this.getBarWidth()}%`;z(`talent${this.idHTML}Progression`,{width:l})}(n==="Initialize"||n==="LevelUp"||n==="PermLevelUp")&&I(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${T(this.level)}`}),(n==="Initialize"||n==="PermLevelUp")&&I(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${T(this.permLevel)}`}),(n==="Initialize"||n==="Time"||n==="LevelUp")&&I(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${T(this.computePermLevelGain(this.level))}`}),(n==="Initialize"||n==="LevelUp"||n==="PermLevelUp"||n==="Level20")&&I(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}},ae={talentCriticalChance:10,talentProgressSpeed:10},_e=class extends nr{constructor(n,l,p,g,x){super(n,l,p,g,x);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(){let n=1;return f!==void 0&&(n*=f.barLevel/10-1),n*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),n}talentEffect(){return f!==void 0&&tr()?.1*(1-Math.pow(Math.E,-this.level/500))+.1*Math.min(100,this.level)/100+.1*(1-Math.pow(Math.E,-this.permLevel/1e3))+.1*Math.min(200,this.level)/200:0}displayEffect(){return`+${T(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Ie=class extends nr{constructor(n,l,p,g,x){super(n,l,p,g,x);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(){let n=Math.log10(1+Ne);return f!==void 0&&(n*=f.barLevel/10-1),n*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),n}talentEffect(){return f!==void 0&&tr?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${T(100*(this.talentEffect()-1),2)}%`}};var Yr="talents.barCriticalChance",or=s=>{var l,p,g,x,w;let n=(l=H(s,Yr))!=null?l:H(f,Yr);return new _e((p=n==null?void 0:n.level)!=null?p:0,ae.talentCriticalChance,(g=n==null?void 0:n.investedFragments)!=null?g:0,(x=n==null?void 0:n.permLevel)!=null?x:0,(w=n==null?void 0:n.currEXP)!=null?w:0)};var Gr="talents.barSpeed",ar=s=>{var l,p,g,x,w;let n=(l=H(s,Gr))!=null?l:H(f,Gr);return new Ie((p=n==null?void 0:n.level)!=null?p:0,ae.talentCriticalChance,(g=n==null?void 0:n.investedFragments)!=null?g:0,(x=n==null?void 0:n.permLevel)!=null?x:0,(w=n==null?void 0:n.currEXP)!=null?w:0)};document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(f.coins.updateHTML(),f.coinUpgrades.barMomentum.updateHTML(),f.coinUpgrades.barSpeed.updateHTML(),f.barFragments.updateHTML(),I("coinWorth",{textContent:`Worth ${T(ne())} coins`}))});var Vr=()=>{W("main-tab-nav").addEventListener("click",()=>ce("Main")),W("upgrade-tab-nav").addEventListener("click",()=>ce("Upgrades")),W("talent-tab-nav").addEventListener("click",()=>ce("Talents")),W("buy-coin-bar-speed").addEventListener("click",s=>f.coinUpgrades.barSpeed.purchaseLevels(1,s)),W("buy-coin-bar-momentum").addEventListener("click",s=>f.coinUpgrades.barMomentum.purchaseLevels(1,s)),W("buy-coin-bar-reverberation").addEventListener("click",s=>f.coinUpgrades.barReverberation.purchaseLevels(1,s)),W("buy-coin-bar-vibration").addEventListener("click",s=>f.coinUpgrades.barVibration.purchaseLevels(1,s)),W("buy-reset").addEventListener("click",()=>Ue("Refresh")),W("reset-game").addEventListener("click",()=>void Kr()),W("talentCriticalChanceSacrifice").addEventListener("click",()=>f.talents.barCriticalChance.sacrificeFragments())};var f={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,coins:new Ae,coinUpgrades:{barSpeed:new we(0,G.barSpeed),barMomentum:new Te(0,G.barMomentum),barReverberation:new xe(0,G.barReverberation),barVibration:new Le(0,G.barVibration)},talents:{barCriticalChance:new _e(0,ae.talentCriticalChance,0,0,0),barSpeed:new Ie(0,ae.talentProgressSpeed,0,0,0)},barFragments:new De,refreshCount:0,refreshTime:0},Jr=Object.assign({},f),mn=async()=>{let s=Object.assign({},f,{});await le.default.removeItem("UPBSave");let n=btoa(JSON.stringify(s));n!==null&&await le.default.setItem("UPBSave",n)},Qr=new Map([["coins",s=>new Ae(Number(s.coins.amount))],["barFragments",s=>new De(Number(s.barFragments.amount))],["coinUpgrades.barSpeed",Ze],["coinUpgrades.barMomentum",je],["coinUpgrades.barReverberation",er],["coinUpgrades.barVibration",rr],["talents.barCriticalChance",or],["talents.barSpeed",ar]]),pn=async()=>{console.log("load attempted");let s=await le.default.getItem("UPBSave"),n=s?JSON.parse(atob(s)):null;if(!n)return;let l=Object.keys(n);for(let p of l)p in Jr&&(Qr.has(p)||Object.defineProperty(f,p,{value:n[p]}));for(let[p,g]of Qr)Nr(f,p,g(n))},Ce=new Set,ir=new Proxy(setInterval,{apply(s,n,l){let p=s.apply(n,l);return Ce.add(p),p}}),hn=new Proxy(clearInterval,{apply(s,n,l){let p=l[0];return Ce.has(p)&&Ce.delete(p),s.apply(n,l)}});window.addEventListener("load",()=>{Vr(),qr()});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var sr=0,vn=24,bn=5e3,qr=async()=>{for(let s of Ce)hn(s);Ce.clear(),await pn(),f.barTNL=ve(),Object.defineProperty(window,"player",{value:f}),ue(fe(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),ce("Main"),z("progression",{backgroundColor:be()}),I("coinWorth",{textContent:`Worth ${T(ne())} coins`}),sr=performance.now(),ir(yn,1e3/vn),ir(Or,1e3),ir(mn,bn)},Kr=async()=>{await le.default.removeItem("UPBSave");let s=btoa(JSON.stringify(Jr));await le.default.setItem("UPBSave",s),await qr()},yn=()=>{let n=performance.now()-sr;gn(n/1e3),sr+=n},gn=s=>{Ar(s),f.refreshTime+=s,I("refresh-timer",{textContent:`${T(f.refreshTime,2)}s`});let n=fe(f.barEXP,f.barTNL);n<100?ue(n):Dr(),Ur()},Se=60;})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
