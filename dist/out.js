(()=>{var tn=Object.create;var Qe=Object.defineProperty;var rn=Object.getOwnPropertyDescriptor;var nn=Object.getOwnPropertyNames;var an=Object.getPrototypeOf,on=Object.prototype.hasOwnProperty;var sn=i=>Qe(i,"__esModule",{value:!0});var ve=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(r,u)=>(typeof require!="undefined"?require:r)[u]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var fn=(i,r)=>()=>(r||i((r={exports:{}}).exports,r),r.exports);var un=(i,r,u,d)=>{if(r&&typeof r=="object"||typeof r=="function")for(let y of nn(r))!on.call(i,y)&&(u||y!=="default")&&Qe(i,y,{get:()=>r[y],enumerable:!(d=rn(r,y))||d.enumerable});return i},cn=(i,r)=>un(sn(Qe(i!=null?tn(an(i)):{},"default",!r&&i&&i.__esModule?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var Nt=fn((At,Je)=>{(function(i){if(typeof At=="object"&&typeof Je<"u")Je.exports=i();else if(typeof define=="function"&&define.amd)define([],i);else{var r;typeof window<"u"?r=window:typeof global<"u"?r=global:typeof self<"u"?r=self:r=this,r.localforage=i()}})(function(){var i,r,u;return function d(y,T,x){function $(k,J){if(!T[k]){if(!y[k]){var b=typeof ve=="function"&&ve;if(!J&&b)return b(k,!0);if(_)return _(k,!0);var E=new Error("Cannot find module '"+k+"'");throw E.code="MODULE_NOT_FOUND",E}var D=T[k]={exports:{}};y[k][0].call(D.exports,function(O){var q=y[k][1][O];return $(q||O)},D,D.exports,d,y,T,x)}return T[k].exports}for(var _=typeof ve=="function"&&ve,H=0;H<x.length;H++)$(x[H]);return $}({1:[function(d,y,T){(function(x){"use strict";var $=x.MutationObserver||x.WebKitMutationObserver,_;if($){var H=0,k=new $(O),J=x.document.createTextNode("");k.observe(J,{characterData:!0}),_=function(){J.data=H=++H%2}}else if(!x.setImmediate&&typeof x.MessageChannel<"u"){var b=new x.MessageChannel;b.port1.onmessage=O,_=function(){b.port2.postMessage(0)}}else"document"in x&&"onreadystatechange"in x.document.createElement("script")?_=function(){var F=x.document.createElement("script");F.onreadystatechange=function(){O(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},x.document.documentElement.appendChild(F)}:_=function(){setTimeout(O,0)};var E,D=[];function O(){E=!0;for(var F,Z,X=D.length;X;){for(Z=D,D=[],F=-1;++F<X;)Z[F]();X=D.length}E=!1}y.exports=q;function q(F){D.push(F)===1&&!E&&_()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(d,y,T){"use strict";var x=d(1);function $(){}var _={},H=["REJECTED"],k=["FULFILLED"],J=["PENDING"];y.exports=b;function b(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=J,this.queue=[],this.outcome=void 0,v!==$&&q(this,v)}b.prototype.catch=function(v){return this.then(null,v)},b.prototype.then=function(v,C){if(typeof v!="function"&&this.state===k||typeof C!="function"&&this.state===H)return this;var S=new this.constructor($);if(this.state!==J){var R=this.state===k?v:C;D(S,R,this.outcome)}else this.queue.push(new E(S,v,C));return S};function E(v,C,S){this.promise=v,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}E.prototype.callFulfilled=function(v){_.resolve(this.promise,v)},E.prototype.otherCallFulfilled=function(v){D(this.promise,this.onFulfilled,v)},E.prototype.callRejected=function(v){_.reject(this.promise,v)},E.prototype.otherCallRejected=function(v){D(this.promise,this.onRejected,v)};function D(v,C,S){x(function(){var R;try{R=C(S)}catch(W){return _.reject(v,W)}R===v?_.reject(v,new TypeError("Cannot resolve promise with itself")):_.resolve(v,R)})}_.resolve=function(v,C){var S=F(O,C);if(S.status==="error")return _.reject(v,S.value);var R=S.value;if(R)q(v,R);else{v.state=k,v.outcome=C;for(var W=-1,Y=v.queue.length;++W<Y;)v.queue[W].callFulfilled(C)}return v},_.reject=function(v,C){v.state=H,v.outcome=C;for(var S=-1,R=v.queue.length;++S<R;)v.queue[S].callRejected(C);return v};function O(v){var C=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof C=="function")return function(){C.apply(v,arguments)}}function q(v,C){var S=!1;function R(K){S||(S=!0,_.reject(v,K))}function W(K){S||(S=!0,_.resolve(v,K))}function Y(){C(W,R)}var G=F(Y);G.status==="error"&&R(G.value)}function F(v,C){var S={};try{S.value=v(C),S.status="success"}catch(R){S.status="error",S.value=R}return S}b.resolve=Z;function Z(v){return v instanceof this?v:_.resolve(new this($),v)}b.reject=X;function X(v){var C=new this($);return _.reject(C,v)}b.all=Oe;function Oe(v){var C=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,R=!1;if(!S)return this.resolve([]);for(var W=new Array(S),Y=0,G=-1,K=new this($);++G<S;)j(v[G],G);return K;function j(me,Pe){C.resolve(me).then(Fe,function(ie){R||(R=!0,_.reject(K,ie))});function Fe(ie){W[Pe]=ie,++Y===S&&!R&&(R=!0,_.resolve(K,W))}}}b.race=ne;function ne(v){var C=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,R=!1;if(!S)return this.resolve([]);for(var W=-1,Y=new this($);++W<S;)G(v[W]);return Y;function G(K){C.resolve(K).then(function(j){R||(R=!0,_.resolve(Y,j))},function(j){R||(R=!0,_.reject(Y,j))})}}},{"1":1}],3:[function(d,y,T){(function(x){"use strict";typeof x.Promise!="function"&&(x.Promise=d(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(d,y,T){"use strict";var x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function $(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(e){return}}var H=_();function k(){try{if(!H||!H.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(t){return!1}}function J(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(a){if(a.name!=="TypeError")throw a;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,o=new t,s=0;s<e.length;s+=1)o.append(e[s]);return o.getBlob(n.type)}}typeof Promise>"u"&&d(3);var b=Promise;function E(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function D(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function O(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var F="local-forage-detect-blob-support",Z=void 0,X={},Oe=Object.prototype.toString,ne="readonly",v="readwrite";function C(e){for(var n=e.length,t=new ArrayBuffer(n),o=new Uint8Array(t),s=0;s<n;s++)o[s]=e.charCodeAt(s);return t}function S(e){return new b(function(n){var t=e.transaction(F,v),o=J([""]);t.objectStore(F).put(o,"key"),t.onabort=function(s){s.preventDefault(),s.stopPropagation(),n(!1)},t.oncomplete=function(){var s=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);n(a||!s||parseInt(s[1],10)>=43)}}).catch(function(){return!1})}function R(e){return typeof Z=="boolean"?b.resolve(Z):S(e).then(function(n){return Z=n,Z})}function W(e){var n=X[e.name],t={};t.promise=new b(function(o,s){t.resolve=o,t.reject=s}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function Y(e){var n=X[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function G(e,n){var t=X[e.name],o=t.deferredOperations.pop();if(o)return o.reject(n),o.promise}function K(e,n){return new b(function(t,o){if(X[e.name]=X[e.name]||mt(),e.db)if(n)W(e),e.db.close();else return t(e.db);var s=[e.name];n&&s.push(e.version);var a=H.open.apply(H,s);n&&(a.onupgradeneeded=function(c){var l=a.result;try{l.createObjectStore(e.storeName),c.oldVersion<=1&&l.createObjectStore(F)}catch(m){if(m.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw m}}),a.onerror=function(c){c.preventDefault(),o(a.error)},a.onsuccess=function(){var c=a.result;c.onversionchange=function(l){l.target.close()},t(c),Y(e)}})}function j(e){return K(e,!1)}function me(e){return K(e,!0)}function Pe(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,s=e.version>e.db.version;if(o&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function Fe(e){return new b(function(n,t){var o=new FileReader;o.onerror=t,o.onloadend=function(s){var a=btoa(s.target.result||"");n({__local_forage_encoded_blob:!0,data:a,type:e.type})},o.readAsBinaryString(e)})}function ie(e){var n=C(atob(e.data));return J([n],{type:e.type})}function dt(e){return e&&e.__local_forage_encoded_blob}function rr(e){var n=this,t=n._initReady().then(function(){var o=X[n._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return D(t,e,e),t}function nr(e){W(e);for(var n=X[e.name],t=n.forages,o=0;o<t.length;o++){var s=t[o];s._dbInfo.db&&(s._dbInfo.db.close(),s._dbInfo.db=null)}return e.db=null,j(e).then(function(a){return e.db=a,Pe(e)?me(e):a}).then(function(a){e.db=n.db=a;for(var c=0;c<t.length;c++)t[c]._dbInfo.db=a}).catch(function(a){throw G(e,a),a})}function ee(e,n,t,o){o===void 0&&(o=1);try{var s=e.db.transaction(e.storeName,n);t(null,s)}catch(a){if(o>0&&(!e.db||a.name==="InvalidStateError"||a.name==="NotFoundError"))return b.resolve().then(function(){if(!e.db||a.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),me(e)}).then(function(){return nr(e).then(function(){ee(e,n,t,o-1)})}).catch(t);t(a)}}function mt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ar(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var s=X[t.name];s||(s=mt(),X[t.name]=s),s.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=rr);var a=[];function c(){return b.resolve()}for(var l=0;l<s.forages.length;l++){var m=s.forages[l];m!==n&&a.push(m._initReady().catch(c))}var p=s.forages.slice(0);return b.all(a).then(function(){return t.db=s.db,j(t)}).then(function(h){return t.db=h,Pe(t,n._defaultConfig.version)?me(t):h}).then(function(h){t.db=s.db=h,n._dbInfo=t;for(var g=0;g<p.length;g++){var w=p[g];w!==n&&(w._dbInfo.db=t.db,w._dbInfo.version=t.version)}})}function or(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,ne,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.get(e);p.onsuccess=function(){var h=p.result;h===void 0&&(h=null),dt(h)&&(h=ie(h)),s(h)},p.onerror=function(){a(p.error)}}catch(h){a(h)}})}).catch(a)});return E(o,n),o}function ir(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,ne,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.openCursor(),h=1;p.onsuccess=function(){var g=p.result;if(g){var w=g.value;dt(w)&&(w=ie(w));var I=e(w,g.key,h++);I!==void 0?s(I):g.continue()}else s()},p.onerror=function(){a(p.error)}}catch(g){a(g)}})}).catch(a)});return E(o,n),o}function sr(e,n,t){var o=this;e=O(e);var s=new b(function(a,c){var l;o.ready().then(function(){return l=o._dbInfo,Oe.call(n)==="[object Blob]"?R(l.db).then(function(m){return m?n:Fe(n)}):n}).then(function(m){ee(o._dbInfo,v,function(p,h){if(p)return c(p);try{var g=h.objectStore(o._dbInfo.storeName);m===null&&(m=void 0);var w=g.put(m,e);h.oncomplete=function(){m===void 0&&(m=null),a(m)},h.onabort=h.onerror=function(){var I=w.error?w.error:w.transaction.error;c(I)}}catch(I){c(I)}})}).catch(c)});return E(s,t),s}function fr(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){ee(t._dbInfo,v,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=m.delete(e);l.oncomplete=function(){s()},l.onerror=function(){a(p.error)},l.onabort=function(){var h=p.error?p.error:p.transaction.error;a(h)}}catch(h){a(h)}})}).catch(a)});return E(o,n),o}function ur(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,v,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.clear();c.oncomplete=function(){o()},c.onabort=c.onerror=function(){var p=m.error?m.error:m.transaction.error;s(p)}}catch(p){s(p)}})}).catch(s)});return E(t,e),t}function cr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,ne,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.count();m.onsuccess=function(){o(m.result)},m.onerror=function(){s(m.error)}}catch(p){s(p)}})}).catch(s)});return E(t,e),t}function lr(e,n){var t=this,o=new b(function(s,a){if(e<0){s(null);return}t.ready().then(function(){ee(t._dbInfo,ne,function(c,l){if(c)return a(c);try{var m=l.objectStore(t._dbInfo.storeName),p=!1,h=m.openKeyCursor();h.onsuccess=function(){var g=h.result;if(!g){s(null);return}e===0||p?s(g.key):(p=!0,g.advance(e))},h.onerror=function(){a(h.error)}}catch(g){a(g)}})}).catch(a)});return E(o,n),o}function dr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){ee(n._dbInfo,ne,function(a,c){if(a)return s(a);try{var l=c.objectStore(n._dbInfo.storeName),m=l.openKeyCursor(),p=[];m.onsuccess=function(){var h=m.result;if(!h){o(p);return}p.push(h.key),h.continue()},m.onerror=function(){s(m.error)}}catch(h){s(h)}})}).catch(s)});return E(t,e),t}function mr(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,s;if(!e.name)s=b.reject("Invalid arguments");else{var a=e.name===t.name&&o._dbInfo.db,c=a?b.resolve(o._dbInfo.db):j(e).then(function(l){var m=X[e.name],p=m.forages;m.db=l;for(var h=0;h<p.length;h++)p[h]._dbInfo.db=l;return l});e.storeName?s=c.then(function(l){if(!!l.objectStoreNames.contains(e.storeName)){var m=l.version+1;W(e);var p=X[e.name],h=p.forages;l.close();for(var g=0;g<h.length;g++){var w=h[g];w._dbInfo.db=null,w._dbInfo.version=m}var I=new b(function(P,U){var B=H.open(e.name,m);B.onerror=function(Q){var he=B.result;he.close(),U(Q)},B.onupgradeneeded=function(){var Q=B.result;Q.deleteObjectStore(e.storeName)},B.onsuccess=function(){var Q=B.result;Q.close(),P(Q)}});return I.then(function(P){p.db=P;for(var U=0;U<h.length;U++){var B=h[U];B._dbInfo.db=P,Y(B._dbInfo)}}).catch(function(P){throw(G(e,P)||b.resolve()).catch(function(){}),P})}}):s=c.then(function(l){W(e);var m=X[e.name],p=m.forages;l.close();for(var h=0;h<p.length;h++){var g=p[h];g._dbInfo.db=null}var w=new b(function(I,P){var U=H.deleteDatabase(e.name);U.onerror=function(){var B=U.result;B&&B.close(),P(U.error)},U.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},U.onsuccess=function(){var B=U.result;B&&B.close(),I(B)}});return w.then(function(I){m.db=I;for(var P=0;P<p.length;P++){var U=p[P];Y(U._dbInfo)}}).catch(function(I){throw(G(e,I)||b.resolve()).catch(function(){}),I})})}return E(s,n),s}var pr={_driver:"asyncStorage",_initStorage:ar,_support:k(),iterate:ir,getItem:or,setItem:sr,removeItem:fr,clear:ur,length:cr,key:lr,keys:dr,dropInstance:mr};function hr(){return typeof openDatabase=="function"}var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vr="~~local_forage_type~",pt=/^~~local_forage_type~([^~]+)~/,Re="__lfsc__:",Xe=Re.length,$e="arbf",ke="blob",ht="si08",vt="ui08",bt="uic8",gt="si16",yt="si32",Et="ur16",Lt="ui32",xt="fl32",Tt="fl64",wt=Xe+$e.length,St=Object.prototype.toString;function _t(e){var n=e.length*.75,t=e.length,o,s=0,a,c,l,m;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var p=new ArrayBuffer(n),h=new Uint8Array(p);for(o=0;o<t;o+=4)a=te.indexOf(e[o]),c=te.indexOf(e[o+1]),l=te.indexOf(e[o+2]),m=te.indexOf(e[o+3]),h[s++]=a<<2|c>>4,h[s++]=(c&15)<<4|l>>2,h[s++]=(l&3)<<6|m&63;return p}function We(e){var n=new Uint8Array(e),t="",o;for(o=0;o<n.length;o+=3)t+=te[n[o]>>2],t+=te[(n[o]&3)<<4|n[o+1]>>4],t+=te[(n[o+1]&15)<<2|n[o+2]>>6],t+=te[n[o+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function br(e,n){var t="";if(e&&(t=St.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&St.call(e.buffer)==="[object ArrayBuffer]")){var o,s=Re;e instanceof ArrayBuffer?(o=e,s+=$e):(o=e.buffer,t==="[object Int8Array]"?s+=ht:t==="[object Uint8Array]"?s+=vt:t==="[object Uint8ClampedArray]"?s+=bt:t==="[object Int16Array]"?s+=gt:t==="[object Uint16Array]"?s+=Et:t==="[object Int32Array]"?s+=yt:t==="[object Uint32Array]"?s+=Lt:t==="[object Float32Array]"?s+=xt:t==="[object Float64Array]"?s+=Tt:n(new Error("Failed to get type for BinaryArray"))),n(s+We(o))}else if(t==="[object Blob]"){var a=new FileReader;a.onload=function(){var c=vr+e.type+"~"+We(this.result);n(Re+ke+c)},a.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(c){console.error("Couldn't convert value into a JSON string: ",e),n(null,c)}}function gr(e){if(e.substring(0,Xe)!==Re)return JSON.parse(e);var n=e.substring(wt),t=e.substring(Xe,wt),o;if(t===ke&&pt.test(n)){var s=n.match(pt);o=s[1],n=n.substring(s[0].length)}var a=_t(n);switch(t){case $e:return a;case ke:return J([a],{type:o});case ht:return new Int8Array(a);case vt:return new Uint8Array(a);case bt:return new Uint8ClampedArray(a);case gt:return new Int16Array(a);case Et:return new Uint16Array(a);case yt:return new Int32Array(a);case Lt:return new Uint32Array(a);case xt:return new Float32Array(a);case Tt:return new Float64Array(a);default:throw new Error("Unkown type: "+t)}}var ze={serialize:br,deserialize:gr,stringToBuffer:_t,bufferToString:We};function Mt(e,n,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function yr(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var s=new b(function(a,c){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(l){return c(l)}t.db.transaction(function(l){Mt(l,t,function(){n._dbInfo=t,a()},function(m,p){c(p)})},c)});return t.serializer=ze,s}function re(e,n,t,o,s,a){e.executeSql(t,o,s,function(c,l){l.code===l.SYNTAX_ERR?c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(m,p){p.rows.length?a(m,l):Mt(m,n,function(){m.executeSql(t,o,s,a)},a)},a):a(c,l)},a)}function Er(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[e],function(m,p){var h=p.rows.length?p.rows.item(0).value:null;h&&(h=c.serializer.deserialize(h)),s(h)},function(m,p){a(p)})})}).catch(a)});return E(o,n),o}function Lr(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT * FROM "+c.storeName,[],function(m,p){for(var h=p.rows,g=h.length,w=0;w<g;w++){var I=h.item(w),P=I.value;if(P&&(P=c.serializer.deserialize(P)),P=e(P,I.key,w+1),P!==void 0){s(P);return}}s()},function(m,p){a(p)})})}).catch(a)});return E(o,n),o}function Ct(e,n,t,o){var s=this;e=O(e);var a=new b(function(c,l){s.ready().then(function(){n===void 0&&(n=null);var m=n,p=s._dbInfo;p.serializer.serialize(n,function(h,g){g?l(g):p.db.transaction(function(w){re(w,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){c(m)},function(I,P){l(P)})},function(w){if(w.code===w.QUOTA_ERR){if(o>0){c(Ct.apply(s,[e,m,t,o-1]));return}l(w)}})})}).catch(l)});return E(a,t),a}function xr(e,n,t){return Ct.apply(this,[e,n,t,1])}function Tr(e,n){var t=this;e=O(e);var o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"DELETE FROM "+c.storeName+" WHERE key = ?",[e],function(){s()},function(m,p){a(p)})})}).catch(a)});return E(o,n),o}function wr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"DELETE FROM "+a.storeName,[],function(){o()},function(l,m){s(m)})})}).catch(s)});return E(t,e),t}function Sr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"SELECT COUNT(key) as c FROM "+a.storeName,[],function(l,m){var p=m.rows.item(0).c;o(p)},function(l,m){s(m)})})}).catch(s)});return E(t,e),t}function _r(e,n){var t=this,o=new b(function(s,a){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(l){re(l,c,"SELECT key FROM "+c.storeName+" WHERE id = ? LIMIT 1",[e+1],function(m,p){var h=p.rows.length?p.rows.item(0).key:null;s(h)},function(m,p){a(p)})})}).catch(a)});return E(o,n),o}function Mr(e){var n=this,t=new b(function(o,s){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(c){re(c,a,"SELECT key FROM "+a.storeName,[],function(l,m){for(var p=[],h=0;h<m.rows.length;h++)p.push(m.rows.item(h).key);o(p)},function(l,m){s(m)})})}).catch(s)});return E(t,e),t}function Cr(e){return new b(function(n,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(s,a){for(var c=[],l=0;l<a.rows.length;l++)c.push(a.rows.item(l).name);n({db:e,storeNames:c})},function(s,a){t(a)})},function(o){t(o)})})}function Ir(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,s;return e.name?s=new b(function(a){var c;e.name===t.name?c=o._dbInfo.db:c=openDatabase(e.name,"","",0),e.storeName?a({db:c,storeNames:[e.storeName]}):a(Cr(c))}).then(function(a){return new b(function(c,l){a.db.transaction(function(m){function p(I){return new b(function(P,U){m.executeSql("DROP TABLE IF EXISTS "+I,[],function(){P()},function(B,Q){U(Q)})})}for(var h=[],g=0,w=a.storeNames.length;g<w;g++)h.push(p(a.storeNames[g]));b.all(h).then(function(){c()}).catch(function(I){l(I)})},function(m){l(m)})})}):s=b.reject("Invalid arguments"),E(s,n),s}var Pr={_driver:"webSQLStorage",_initStorage:yr,_support:hr(),iterate:Lr,getItem:Er,setItem:xr,removeItem:Tr,clear:wr,length:Sr,key:_r,keys:Mr,dropInstance:Ir};function Rr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function It(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Br(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function Ar(){return!Br()||localStorage.length>0}function Nr(e){var n=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=It(e,n._defaultConfig),Ar()?(n._dbInfo=t,t.serializer=ze,b.resolve()):b.reject()}function Dr(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var a=localStorage.key(s);a.indexOf(o)===0&&localStorage.removeItem(a)}});return E(t,e),t}function Ur(e,n){var t=this;e=O(e);var o=t.ready().then(function(){var s=t._dbInfo,a=localStorage.getItem(s.keyPrefix+e);return a&&(a=s.serializer.deserialize(a)),a});return E(o,n),o}function Hr(e,n){var t=this,o=t.ready().then(function(){for(var s=t._dbInfo,a=s.keyPrefix,c=a.length,l=localStorage.length,m=1,p=0;p<l;p++){var h=localStorage.key(p);if(h.indexOf(a)===0){var g=localStorage.getItem(h);if(g&&(g=s.serializer.deserialize(g)),g=e(g,h.substring(c),m++),g!==void 0)return g}}});return E(o,n),o}function Or(e,n){var t=this,o=t.ready().then(function(){var s=t._dbInfo,a;try{a=localStorage.key(e)}catch(c){a=null}return a&&(a=a.substring(s.keyPrefix.length)),a});return E(o,n),o}function Fr(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo,s=localStorage.length,a=[],c=0;c<s;c++){var l=localStorage.key(c);l.indexOf(o.keyPrefix)===0&&a.push(l.substring(o.keyPrefix.length))}return a});return E(t,e),t}function Xr(e){var n=this,t=n.keys().then(function(o){return o.length});return E(t,e),t}function $r(e,n){var t=this;e=O(e);var o=t.ready().then(function(){var s=t._dbInfo;localStorage.removeItem(s.keyPrefix+e)});return E(o,n),o}function kr(e,n,t){var o=this;e=O(e);var s=o.ready().then(function(){n===void 0&&(n=null);var a=n;return new b(function(c,l){var m=o._dbInfo;m.serializer.serialize(n,function(p,h){if(h)l(h);else try{localStorage.setItem(m.keyPrefix+e,p),c(a)}catch(g){(g.name==="QuotaExceededError"||g.name==="NS_ERROR_DOM_QUOTA_REACHED")&&l(g),l(g)}})})});return E(s,t),s}function Wr(e,n){if(n=q.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,s;return e.name?s=new b(function(a){e.storeName?a(It(e,o._defaultConfig)):a(e.name+"/")}).then(function(a){for(var c=localStorage.length-1;c>=0;c--){var l=localStorage.key(c);l.indexOf(a)===0&&localStorage.removeItem(l)}}):s=b.reject("Invalid arguments"),E(s,n),s}var zr={_driver:"localStorageWrapper",_initStorage:Nr,_support:Rr(),iterate:Hr,getItem:Ur,setItem:kr,removeItem:$r,clear:Dr,length:Xr,key:Or,keys:Fr,dropInstance:Wr},Vr=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},Yr=function(n,t){for(var o=n.length,s=0;s<o;){if(Vr(n[s],t))return!0;s++}return!1},Pt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},pe={},Rt={},se={INDEXEDDB:pr,WEBSQL:Pr,LOCALSTORAGE:zr},Gr=[se.INDEXEDDB._driver,se.WEBSQL._driver,se.LOCALSTORAGE._driver],Be=["dropInstance"],Ve=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Be),Kr={description:"",driver:Gr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Qr(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function Ye(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(Pt(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var Jr=function(){function e(n){$(this,e);for(var t in se)if(se.hasOwnProperty(t)){var o=se[t],s=o._driver;this[t]=s,pe[s]||this.defineDriver(o)}this._defaultConfig=Ye({},Kr),this._config=Ye({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":x(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,s){var a=new b(function(c,l){try{var m=t._driver,p=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){l(p);return}for(var h=Ve.concat("_initStorage"),g=0,w=h.length;g<w;g++){var I=h[g],P=!Yr(Be,I);if((P||t[I])&&typeof t[I]!="function"){l(p);return}}var U=function(){for(var he=function(jr){return function(){var en=new Error("Method "+jr+" is not implemented by the current driver"),Bt=b.reject(en);return E(Bt,arguments[arguments.length-1]),Bt}},Ge=0,Zr=Be.length;Ge<Zr;Ge++){var Ke=Be[Ge];t[Ke]||(t[Ke]=he(Ke))}};U();var B=function(he){pe[m]&&console.info("Redefining LocalForage driver: "+m),pe[m]=t,Rt[m]=he,c()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(B,l):B(!!t._support):B(!0)}catch(Q){l(Q)}});return D(a,o,s),a},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,s){var a=pe[t]?b.resolve(pe[t]):b.reject(new Error("Driver not found."));return D(a,o,s),a},e.prototype.getSerializer=function(t){var o=b.resolve(ze);return D(o,t),o},e.prototype.ready=function(t){var o=this,s=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return D(s,t,t),s},e.prototype.setDriver=function(t,o,s){var a=this;Pt(t)||(t=[t]);var c=this._getSupportedDrivers(t);function l(){a._config.driver=a.driver()}function m(g){return a._extend(g),l(),a._ready=a._initStorage(a._config),a._ready}function p(g){return function(){var w=0;function I(){for(;w<g.length;){var P=g[w];return w++,a._dbInfo=null,a._ready=null,a.getDriver(P).then(m).catch(I)}l();var U=new Error("No available storage method found.");return a._driverSet=b.reject(U),a._driverSet}return I()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=h.then(function(){var g=c[0];return a._dbInfo=null,a._ready=null,a.getDriver(g).then(function(w){a._driver=w._driver,l(),a._wrapLibraryMethodsWithReady(),a._initDriver=p(c)})}).catch(function(){l();var g=new Error("No available storage method found.");return a._driverSet=b.reject(g),a._driverSet}),D(this._driverSet,o,s),this._driverSet},e.prototype.supports=function(t){return!!Rt[t]},e.prototype._extend=function(t){Ye(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],s=0,a=t.length;s<a;s++){var c=t[s];this.supports(c)&&o.push(c)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Ve.length;t<o;t++)Qr(this,Ve[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),qr=new Jr;y.exports=qr},{"3":3}]},{},[4])(4)})});var de=cn(Nt());var Ze=i=>{let r=typeof i;return i!==null&&(r==="object"||r==="function")},qe=new Set(["__proto__","prototype","constructor"]),ln=new Set("0123456789");function Dt(i){let r=[],u="",d="start",y=!1;for(let T of i)switch(T){case"\\":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");y&&(u+=T),d="property",y=!y;break;case".":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="property";break}if(y){y=!1,u+=T;break}if(qe.has(u))return[];r.push(u),u="",d="property";break;case"[":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="index";break}if(y){y=!1,u+=T;break}if(d==="property"){if(qe.has(u))return[];r.push(u),u=""}d="index";break;case"]":if(d==="index"){r.push(Number.parseInt(u,10)),u="",d="indexEnd";break}if(d==="indexEnd")throw new Error("Invalid character after an index");default:if(d==="index"&&!ln.has(T))throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");d==="start"&&(d="property"),y&&(y=!1,u+="\\"),u+=T}switch(y&&(u+="\\"),d){case"property":{if(qe.has(u))return[];r.push(u);break}case"index":throw new Error("Index was not closed");case"start":{r.push("");break}}return r}function Ut(i,r){if(typeof r!="number"&&Array.isArray(i)){let u=Number.parseInt(r,10);return Number.isInteger(u)&&i[u]===i[r]}return!1}function dn(i,r){if(Ut(i,r))throw new Error("Cannot use string index")}function A(i,r,u){if(!Ze(i)||typeof r!="string")return u===void 0?i:u;let d=Dt(r);if(d.length===0)return u;for(let y=0;y<d.length;y++){let T=d[y];if(Ut(i,T)?i=y===d.length-1?void 0:null:i=i[T],i==null){if(y!==d.length-1)return u;break}}return i===void 0?u:i}function Ht(i,r,u){if(!Ze(i)||typeof r!="string")return i;let d=i,y=Dt(r);for(let T=0;T<y.length;T++){let x=y[T];dn(i,x),T===y.length-1?i[x]=u:Ze(i[x])||(i[x]=typeof y[T+1]=="number"?[]:{}),i=i[x]}return d}var L=(i,r=0)=>{if(i<0)return"-"+L(-i,r);if(i>=1e6){let H=Math.floor(Math.log10(i));return i/=Math.pow(10,H),L(i,2)+"e"+L(H)}let u=Math.floor(i),d=i-u,y=u.toLocaleString(),T=r>0&&i!==0,x=Math.pow(10,r)*d,$=1e-6;Math.ceil(x)-x<$&&(x=Math.ceil(x));let _=T?Math.floor(x).toString():"";if(_!==""){for(;_.length<r;)_="0"+_;_="."+_}return y+_};var mn=10,Ae=0,je=0,be=()=>{let i=0;return i+=mn*Math.pow(f.barLevel+1,2),i*=Math.min(1,(f.barLevel+20)/40),i*=Math.max(1,1+(f.barLevel-20)/10),f.barLevel>40&&(i*=Math.pow(2,1/10*(f.barLevel-40))),f.barLevel>100&&(i*=Math.pow(2,1/10*(f.barLevel-100))),f.barLevel>200&&(i*=Math.pow(2,1/10*(f.barLevel-200))),i},pn=()=>{let i=0;return f.barLevel>=5&&(i=.1),f.barLevel>=10&&(i+=.9*(1-Math.pow(Math.E,-f.barLevel/200))),i>=.9999?1e4:1/(1-i)},hn=()=>pn()*(1-f.barEXP/f.barTNL),Ot=i=>{if(i==null)return;let r=1;r+=f.coinUpgrades.barSpeed.upgradeEffect(),r*=f.barFragments.unspentBonus(),r*=Math.pow(1+f.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,f.barEXP/f.barTNL))),r/=hn(),r*=f.talents.barSpeed.talentEffect(),Math.random()<f.coinUpgrades.barReverberation.upgradeEffect()+f.talents.barCriticalChance.talentEffect()&&(r*=f.coinUpgrades.barVibration.upgradeEffect(),f.talents.barCriticalChance.gainEXP(i),f.criticalHits+=1,f.criticalHitsThisRefresh+=1,Ne());let d=r*i;f.barEXP+=d,Ae+=d,M("perSecCurr",{textContent:`+${L(Ae,2)} this sec`})},fe=(i,r)=>Math.min(100,.1*Math.floor(1e3*i/r)),ue=i=>{N("progression",{width:`${i}%`})},ge=()=>{let i=(128+f.barLevel).toString(16),r=(2*f.barLevel).toString(16),u=(128+f.barLevel).toString(16);return f.barLevel<128?`#${i}${r}${u}`:"#ffffff"},Ft=()=>{f.coins.gain(ae()),f.barEXP-=f.barTNL,f.barLevel+=1,f.barLevel>f.highestBarLevel&&(f.highestBarLevel=f.barLevel);let i=ge();N("progression",{backgroundColor:i}),f.barTNL=be(),f.barEXP/=10,f.barEXP=Math.min(f.barEXP,Math.floor(f.barTNL/10));let r=fe(f.barEXP,f.barTNL);ue(r),M("coinWorth",{textContent:`Worth ${L(ae())} coins`}),f.barFragments.updateHTML(),f.barLevel===20&&(f.talents.barCriticalChance.updateHTML("Level20"),f.talents.barSpeed.updateHTML("Level20"))},Xt=()=>{M("level",{textContent:`Level: ${f.barLevel}`}),M("exp",{textContent:`EXP: ${L(f.barEXP)}/${L(f.barTNL)}`})},$t=()=>{je=Ae,Ae=0,M("perSecPrev",{textContent:`+${L(je,2)} prev sec`}),f.talents.barCriticalChance.updateHTML("Time"),f.talents.barSpeed.gainEXP(je)},ae=()=>{let i=0,r=1+f.barLevel;r>f.highestBarLevel&&(i+=3),r%5===0&&(i+=Math.floor(r/5)+3),r%10===0&&(i+=Math.floor(r/2)),r%50===0&&(i+=Math.floor(r/2)),r%100===0&&(i+=Math.floor(r));let u=z("coinWorth");return u.style.color=i>0?"gold":"grey",i};var ce=i=>{N("mainTab",{display:"none"}),N("upgradeTab",{display:"none"}),N("talentsTab",{display:"none"}),i==="Main"?N("mainTab",{display:"block"}):i==="Upgrades"?N("upgradeTab",{display:"block"}):i==="Talents"&&N("talentsTab",{display:"block"})},z=i=>document.getElementById(i),Ne=()=>{N("progression",{backgroundColor:"gold"}),setTimeout(()=>{N("progression",{backgroundColor:ge()})},250),M("refresh-crit-counter",{textContent:L(f.criticalHitsThisRefresh)}),f.barFragments.updateHTML()};var kt=(i,r)=>{if(document.visibilityState==="hidden")return!1;let u=Object.entries(r);for(let[d,y]of u)i[d]=y;return!0},M=(i,r)=>document.visibilityState==="hidden"?!1:kt(z(i),r),N=(i,r)=>document.visibilityState==="hidden"?!1:kt(z(i).style,r);var ye=class{constructor(r=0){this.amount=r,this.updateHTML()}spend(r){this.amount>=r&&(this.amount-=r,this.updateHTML())}gain(r){this.amount+=r,this.updateHTML()}set(r){this.amount=r,this.updateHTML()}};var De=class extends ye{updateHTML(){M("gold-amount",{textContent:L(this.amount)})}};var Ue=class extends ye{updateHTML(){M("fragment-amount",{textContent:L(this.amount)}),M("fragment-bonus",{textContent:L(this.amount)}),M("fragment-gain",{textContent:L(this.getAmountOnRefresh())})}getAmountOnRefresh(){if(f!==void 0){let r=f.barLevel,u=100*Math.pow(1.07,-5);return u*=Math.pow(1.07,r),u*=Math.pow(3,Math.floor(r/100)),u*=1+f.criticalHitsThisRefresh*f.coinUpgrades.barAgitation.upgradeEffect(),Math.floor(u)}else return 0}unspentBonus(){return 1+1/100*this.amount}};var Ee=class{constructor(r,u){this.level=r,this.cost=u}};var le=class extends Ee{constructor(r,u){super(r,u);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(r,u){u.shiftKey&&(r=-1),r===-1&&(r=Math.floor(f.coins.amount/this.cost)),this.maxLevel!==-1&&(r=Math.min(r,this.maxLevel-this.level)),this.cost*r<=f.coins.amount&&(f.coins.spend(this.cost*r),this.level+=r,this.updateHTML())}},V={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4},Le=class extends le{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){M("coin-bar-speed-effect",{textContent:`+${L(this.upgradeEffect(),2)} Progress Per Second`})}},xe=class extends le{constructor(r,u){super(r,u);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?.5:.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level)}updateHTML(){M("coin-bar-momentum-effect",{textContent:`Up to ${L(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel&&(M("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),N("coin-bar-momentum-name",{color:"orchid"}))}},Te=class extends le{constructor(r,u){super(r,u);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.1:.09*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+.002*Math.min(5,this.level)}updateHTML(){M("coin-bar-reverberation-effect",{textContent:`+${L(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel&&(M("coin-bar-reverberation-name",{textContent:"Bar Momentum [MAX LEVEL]"}),N("coin-bar-reverberation-name",{color:"orchid"}))}},we=class extends le{constructor(r,u){super(r,u);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?200:20+170*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+Math.min(10,this.level)}updateHTML(){M("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${L(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel&&(M("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),N("coin-bar-vibration-name",{color:"orchid"}))}},Se=class extends le{constructor(r,u){super(r,u);this.maxLevel=10;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/5e3}updateHTML(){M("coin-bar-agitation-effect",{textContent:`+${L(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT`}),this.level===this.maxLevel&&(M("coin-bar-agitation-name",{textContent:"Bar Agitation [MAX LEVEL]"}),N("coin-bar-agitation-name",{color:"orchid"}))}};var Wt="coinUpgrades.barSpeed",et=i=>{var u,d;let r=(u=A(i,Wt))!=null?u:A(f,Wt);return new Le((d=r==null?void 0:r.level)!=null?d:0,V.barSpeed)};var zt="coinUpgrades.barMomentum",tt=i=>{var u,d;let r=(u=A(i,zt))!=null?u:A(f,zt);return new xe((d=r==null?void 0:r.level)!=null?d:0,V.barMomentum)};var Vt="coinUpgrades.barReverberation",rt=i=>{var u,d;let r=(u=A(i,Vt))!=null?u:A(f,Vt);return new Te((d=r==null?void 0:r.level)!=null?d:0,V.barReverberation)};var Yt="coinUpgrades.barVibration",nt=i=>{var u,d;let r=(u=A(i,Yt))!=null?u:A(f,Yt);return new we((d=r==null?void 0:r.level)!=null?d:0,V.barVibration)};var Gt="coinUpgrades.barAgitation",at=i=>{var u,d;let r=(u=A(i,Gt))!=null?u:A(f,Gt);return new Se((d=r==null?void 0:r.level)!=null?d:0,V.barAgitation)};var Kt=(i,r,u,d=1)=>Math.ceil(i*(Math.pow(u,d)-Math.pow(r,d)));var He=i=>{if(i==="Refresh"&&f.barLevel>=5){if(f.refreshTime<_e)return alert(`Currently, refreshes have a ${L(_e)} second cooldown. Sorry!`);f.barFragments.set(f.barFragments.getAmountOnRefresh()),f.barEXP=0,f.barLevel=0,f.barTNL=be(),ue(fe(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),f.talents.barCriticalChance.convertToPerm(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.convertToPerm(),f.talents.barSpeed.updateHTML("Initialize"),f.refreshCount+=1,f.refreshTime=0,f.criticalHitsThisRefresh=0,Ne()}else alert("You cannot refresh yet. Get to level 5 lol")};var ot=()=>f.barLevel>=20,it=class extends Ee{constructor(r,u,d,y,T){super(r,u);this.investedFragments=d,this.permLevel=y,this.currEXP=T,this.currTNL=this.calculateTNL()}calculateTNL(){return Kt(this.cost,this.level,this.level+1,2)}setEXP(r){this.currEXP=r,this.updateHTML("GainEXP")}gainEXP(r){if(!ot())return;let u=this.calculateEXPGain(r);this.currEXP+=u,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}levelUp(){this.level+=1,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("LevelUp")}computePermLevelGain(r){if(f!==void 0){let u=0;return u+=Math.sqrt(r),u*=Math.min(4,Math.pow(f.refreshTime/300,2)),u=Math.min(r,u),Math.floor(u)}else return 0}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}sacrificeFragments(){if(f!==void 0){if(f.barFragments.amount<1e3)return alert("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(f.barFragments.amount<=this.investedFragments)return alert(`This bar needs more fragments than you can invest. You need ${L(this.investedFragments)}.`);confirm(`You will sacrifice ${L(f.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=f.barFragments.amount,f.refreshTime+=_e,He("Refresh"),f.barFragments.set(0))}}updateHTML(r){if(this.idHTML!==void 0){if(r==="Initialize"||r==="GainEXP"||r==="LevelUp"||r==="PermLevelUp"){M(`talent${this.idHTML}EXP`,{textContent:`EXP: ${L(this.currEXP)}/${L(this.currTNL)}`});let u=`${this.getBarWidth()}%`;N(`talent${this.idHTML}Progression`,{width:u})}(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp")&&M(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${L(this.level)}`}),(r==="Initialize"||r==="PermLevelUp")&&M(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${L(this.permLevel)}`}),(r==="Initialize"||r==="Time"||r==="LevelUp")&&M(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${L(this.computePermLevelGain(this.level))}`}),(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp"||r==="Level20")&&M(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}},oe={talentCriticalChance:10,talentProgressSpeed:10},Me=class extends it{constructor(r,u,d,y,T){super(r,u,d,y,T);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(r){let u=1;return u*=r*1e3/st,f!==void 0&&(u*=f.barLevel/10-1),u*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),u}talentEffect(){return f!==void 0&&ot()?.025*(1-Math.pow(Math.E,-this.level/2500))+.025*Math.min(250,this.level)/250+.025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.025*Math.min(500,this.level)/500:0}displayEffect(){return`+${L(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Ce=class extends it{constructor(r,u,d,y,T){super(r,u,d,y,T);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(r){let u=Math.log10(1+r);return f!==void 0&&(u*=f.barLevel/10-1),u*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),u}talentEffect(){return f!==void 0&&ot?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${L(100*(this.talentEffect()-1),2)}%`}};var Qt="talents.barCriticalChance",ft=i=>{var u,d,y,T,x;let r=(u=A(i,Qt))!=null?u:A(f,Qt);return new Me((d=r==null?void 0:r.level)!=null?d:0,oe.talentCriticalChance,(y=r==null?void 0:r.investedFragments)!=null?y:0,(T=r==null?void 0:r.permLevel)!=null?T:0,(x=r==null?void 0:r.currEXP)!=null?x:0)};var Jt="talents.barSpeed",ut=i=>{var u,d,y,T,x;let r=(u=A(i,Jt))!=null?u:A(f,Jt);return new Ce((d=r==null?void 0:r.level)!=null?d:0,oe.talentCriticalChance,(y=r==null?void 0:r.investedFragments)!=null?y:0,(T=r==null?void 0:r.permLevel)!=null?T:0,(x=r==null?void 0:r.currEXP)!=null?x:0)};document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(f.coins.updateHTML(),f.coinUpgrades.barMomentum.updateHTML(),f.coinUpgrades.barSpeed.updateHTML(),f.coinUpgrades.barReverberation.updateHTML(),f.coinUpgrades.barVibration.updateHTML(),f.coinUpgrades.barAgitation.updateHTML(),f.barFragments.updateHTML(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.updateHTML("Initialize"),M("coinWorth",{textContent:`Worth ${L(ae())} coins`}))});var qt=()=>{z("main-tab-nav").addEventListener("click",()=>ce("Main")),z("upgrade-tab-nav").addEventListener("click",()=>ce("Upgrades")),z("talent-tab-nav").addEventListener("click",()=>ce("Talents")),z("buy-coin-bar-speed").addEventListener("click",i=>f.coinUpgrades.barSpeed.purchaseLevels(1,i)),z("buy-coin-bar-momentum").addEventListener("click",i=>f.coinUpgrades.barMomentum.purchaseLevels(1,i)),z("buy-coin-bar-reverberation").addEventListener("click",i=>f.coinUpgrades.barReverberation.purchaseLevels(1,i)),z("buy-coin-bar-vibration").addEventListener("click",i=>f.coinUpgrades.barVibration.purchaseLevels(1,i)),z("buy-coin-bar-agitation").addEventListener("click",i=>f.coinUpgrades.barAgitation.purchaseLevels(1,i)),z("buy-reset").addEventListener("click",()=>He("Refresh")),z("reset-game").addEventListener("click",()=>void Zt()),z("talentCriticalChanceSacrifice").addEventListener("click",()=>f.talents.barCriticalChance.sacrificeFragments())};var f={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,coins:new De,coinUpgrades:{barSpeed:new Le(0,V.barSpeed),barMomentum:new xe(0,V.barMomentum),barReverberation:new Te(0,V.barReverberation),barVibration:new we(0,V.barVibration),barAgitation:new Se(0,V.barAgitation)},talents:{barCriticalChance:new Me(0,oe.talentCriticalChance,0,0,0),barSpeed:new Ce(0,oe.talentProgressSpeed,0,0,0)},barFragments:new Ue,refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0},er=Object.assign({},f),bn=async()=>{let i=Object.assign({},f,{});await de.default.removeItem("UPBSave");let r=btoa(JSON.stringify(i));r!==null&&await de.default.setItem("UPBSave",r)},jt=new Map([["coins",i=>new De(Number(i.coins.amount))],["coinUpgrades.barSpeed",et],["coinUpgrades.barMomentum",tt],["coinUpgrades.barReverberation",rt],["coinUpgrades.barVibration",nt],["coinUpgrades.barAgitation",at],["talents.barCriticalChance",ft],["talents.barSpeed",ut],["barFragments",i=>new Ue(Number(i.barFragments.amount))]]),gn=async()=>{console.log("load attempted");let i=await de.default.getItem("UPBSave"),r=i?JSON.parse(atob(i)):null;if(!r)return;let u=Object.keys(r);for(let d of u)d in er&&(jt.has(d)||Object.defineProperty(f,d,{value:r[d]}));for(let[d,y]of jt)Ht(f,d,y(r))},Ie=new Set,ct=new Proxy(setInterval,{apply(i,r,u){let d=i.apply(r,u);return Ie.add(d),d}}),yn=new Proxy(clearInterval,{apply(i,r,u){let d=u[0];return Ie.has(d)&&Ie.delete(d),i.apply(r,u)}});window.addEventListener("load",()=>{qt(),tr()});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var lt=0,st=24,En=5e3,tr=async()=>{for(let i of Ie)yn(i);Ie.clear(),await gn(),f.barTNL=be(),Object.defineProperty(window,"player",{value:f}),ue(fe(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),ce("Main"),N("progression",{backgroundColor:ge()}),M("coinWorth",{textContent:`Worth ${L(ae())} coins`}),lt=performance.now(),ct(Ln,1e3/st),ct($t,1e3),ct(bn,En)},Zt=async()=>{await de.default.removeItem("UPBSave");let i=btoa(JSON.stringify(er));await de.default.setItem("UPBSave",i),await tr()},Ln=()=>{let r=performance.now()-lt;xn(r/1e3),lt+=r},xn=i=>{Ot(i),f.refreshTime+=i,M("refresh-timer",{textContent:`${L(f.refreshTime,2)}s`});let r=fe(f.barEXP,f.barTNL);r<100?ue(r):Ft(),Xt()},_e=60;})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
