(()=>{var Tn=Object.create;var _e=Object.defineProperty,Pn=Object.defineProperties,wn=Object.getOwnPropertyDescriptor,Cn=Object.getOwnPropertyDescriptors,Mn=Object.getOwnPropertyNames,zt=Object.getOwnPropertySymbols,Sn=Object.getPrototypeOf,Kt=Object.prototype.hasOwnProperty,_n=Object.prototype.propertyIsEnumerable;var Yt=(n,e,o)=>e in n?_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,Qt=(n,e)=>{for(var o in e||(e={}))Kt.call(e,o)&&Yt(n,o,e[o]);if(zt)for(var o of zt(e))_n.call(e,o)&&Yt(n,o,e[o]);return n},Jt=(n,e)=>Pn(n,Cn(e)),In=n=>_e(n,"__esModule",{value:!0});var ge=(n=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(n,{get:(e,o)=>(typeof require!="undefined"?require:e)[o]}):n)(function(n){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var Rn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Bn=(n,e,o,f)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of Mn(e))!Kt.call(n,l)&&(o||l!=="default")&&_e(n,l,{get:()=>e[l],enumerable:!(f=wn(e,l))||f.enumerable});return n},An=(n,e)=>Bn(In(_e(n!=null?Tn(Sn(n)):{},"default",!e&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var tr=Rn((er,Qe)=>{(function(n){if(typeof er=="object"&&typeof Qe<"u")Qe.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=n()}})(function(){var n,e,o;return function f(l,L,E){function S(H,z){if(!L[H]){if(!l[H]){var b=typeof ge=="function"&&ge;if(!z&&b)return b(H,!0);if(T)return T(H,!0);var P=new Error("Cannot find module '"+H+"'");throw P.code="MODULE_NOT_FOUND",P}var O=L[H]={exports:{}};l[H][0].call(O.exports,function($){var q=l[H][1][$];return S(q||$)},O,O.exports,f,l,L,E)}return L[H].exports}for(var T=typeof ge=="function"&&ge,D=0;D<E.length;D++)S(E[D]);return S}({1:[function(f,l,L){(function(E){"use strict";var S=E.MutationObserver||E.WebKitMutationObserver,T;if(S){var D=0,H=new S($),z=E.document.createTextNode("");H.observe(z,{characterData:!0}),T=function(){z.data=D=++D%2}}else if(!E.setImmediate&&typeof E.MessageChannel<"u"){var b=new E.MessageChannel;b.port1.onmessage=$,T=function(){b.port2.postMessage(0)}}else"document"in E&&"onreadystatechange"in E.document.createElement("script")?T=function(){var X=E.document.createElement("script");X.onreadystatechange=function(){$(),X.onreadystatechange=null,X.parentNode.removeChild(X),X=null},E.document.documentElement.appendChild(X)}:T=function(){setTimeout($,0)};var P,O=[];function $(){P=!0;for(var X,j,G=O.length;G;){for(j=O,O=[],X=-1;++X<G;)j[X]();G=O.length}P=!1}l.exports=q;function q(X){O.push(X)===1&&!P&&T()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(f,l,L){"use strict";var E=f(1);function S(){}var T={},D=["REJECTED"],H=["FULFILLED"],z=["PENDING"];l.exports=b;function b(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,v!==S&&q(this,v)}b.prototype.catch=function(v){return this.then(null,v)},b.prototype.then=function(v,I){if(typeof v!="function"&&this.state===H||typeof I!="function"&&this.state===D)return this;var C=new this.constructor(S);if(this.state!==z){var A=this.state===H?v:I;O(C,A,this.outcome)}else this.queue.push(new P(C,v,I));return C};function P(v,I,C){this.promise=v,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}P.prototype.callFulfilled=function(v){T.resolve(this.promise,v)},P.prototype.otherCallFulfilled=function(v){O(this.promise,this.onFulfilled,v)},P.prototype.callRejected=function(v){T.reject(this.promise,v)},P.prototype.otherCallRejected=function(v){O(this.promise,this.onRejected,v)};function O(v,I,C){E(function(){var A;try{A=I(C)}catch(W){return T.reject(v,W)}A===v?T.reject(v,new TypeError("Cannot resolve promise with itself")):T.resolve(v,A)})}T.resolve=function(v,I){var C=X($,I);if(C.status==="error")return T.reject(v,C.value);var A=C.value;if(A)q(v,A);else{v.state=H,v.outcome=I;for(var W=-1,Y=v.queue.length;++W<Y;)v.queue[W].callFulfilled(I)}return v},T.reject=function(v,I){v.state=D,v.outcome=I;for(var C=-1,A=v.queue.length;++C<A;)v.queue[C].callRejected(I);return v};function $(v){var I=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof I=="function")return function(){I.apply(v,arguments)}}function q(v,I){var C=!1;function A(Q){C||(C=!0,T.reject(v,Q))}function W(Q){C||(C=!0,T.resolve(v,Q))}function Y(){I(W,A)}var K=X(Y);K.status==="error"&&A(K.value)}function X(v,I){var C={};try{C.value=v(I),C.status="success"}catch(A){C.status="error",C.value=A}return C}b.resolve=j;function j(v){return v instanceof this?v:T.resolve(new this(S),v)}b.reject=G;function G(v){var I=new this(S);return T.reject(I,v)}b.all=De;function De(v){var I=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=v.length,A=!1;if(!C)return this.resolve([]);for(var W=new Array(C),Y=0,K=-1,Q=new this(S);++K<C;)ee(v[K],K);return Q;function ee(he,Ce){I.resolve(he).then(He,function(ce){A||(A=!0,T.reject(Q,ce))});function He(ce){W[Ce]=ce,++Y===C&&!A&&(A=!0,T.resolve(Q,W))}}}b.race=ie;function ie(v){var I=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=v.length,A=!1;if(!C)return this.resolve([]);for(var W=-1,Y=new this(S);++W<C;)K(v[W]);return Y;function K(Q){I.resolve(Q).then(function(ee){A||(A=!0,T.resolve(Y,ee))},function(ee){A||(A=!0,T.reject(Y,ee))})}}},{"1":1}],3:[function(f,l,L){(function(E){"use strict";typeof E.Promise!="function"&&(E.Promise=f(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(f,l,L){"use strict";var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function S(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function T(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(t){return}}var D=T();function H(){try{if(!D||!D.open)return!1;var t=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),a=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||a)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(r){return!1}}function z(t,a){t=t||[],a=a||{};try{return new Blob(t,a)}catch(i){if(i.name!=="TypeError")throw i;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,s=new r,c=0;c<t.length;c+=1)s.append(t[c]);return s.getBlob(a.type)}}typeof Promise>"u"&&f(3);var b=Promise;function P(t,a){a&&t.then(function(r){a(null,r)},function(r){a(r)})}function O(t,a,r){typeof a=="function"&&t.then(a),typeof r=="function"&&t.catch(r)}function $(t){return typeof t!="string"&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var X="local-forage-detect-blob-support",j=void 0,G={},De=Object.prototype.toString,ie="readonly",v="readwrite";function I(t){for(var a=t.length,r=new ArrayBuffer(a),s=new Uint8Array(r),c=0;c<a;c++)s[c]=t.charCodeAt(c);return r}function C(t){return new b(function(a){var r=t.transaction(X,v),s=z([""]);r.objectStore(X).put(s,"key"),r.onabort=function(c){c.preventDefault(),c.stopPropagation(),a(!1)},r.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);a(i||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}function A(t){return typeof j=="boolean"?b.resolve(j):C(t).then(function(a){return j=a,j})}function W(t){var a=G[t.name],r={};r.promise=new b(function(s,c){r.resolve=s,r.reject=c}),a.deferredOperations.push(r),a.dbReady?a.dbReady=a.dbReady.then(function(){return r.promise}):a.dbReady=r.promise}function Y(t){var a=G[t.name],r=a.deferredOperations.pop();if(r)return r.resolve(),r.promise}function K(t,a){var r=G[t.name],s=r.deferredOperations.pop();if(s)return s.reject(a),s.promise}function Q(t,a){return new b(function(r,s){if(G[t.name]=G[t.name]||Ct(),t.db)if(a)W(t),t.db.close();else return r(t.db);var c=[t.name];a&&c.push(t.version);var i=D.open.apply(D,c);a&&(i.onupgradeneeded=function(u){var m=i.result;try{m.createObjectStore(t.storeName),u.oldVersion<=1&&m.createObjectStore(X)}catch(d){if(d.name==="ConstraintError")console.warn('The database "'+t.name+'" has been upgraded from version '+u.oldVersion+" to version "+u.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw d}}),i.onerror=function(u){u.preventDefault(),s(i.error)},i.onsuccess=function(){var u=i.result;u.onversionchange=function(m){m.target.close()},r(u),Y(t)}})}function ee(t){return Q(t,!1)}function he(t){return Q(t,!0)}function Ce(t,a){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),s=t.version<t.db.version,c=t.version>t.db.version;if(s&&(t.version!==a&&console.warn('The database "'+t.name+`" can't be downgraded from version `+t.db.version+" to version "+t.version+"."),t.version=t.db.version),c||r){if(r){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function He(t){return new b(function(a,r){var s=new FileReader;s.onerror=r,s.onloadend=function(c){var i=btoa(c.target.result||"");a({__local_forage_encoded_blob:!0,data:i,type:t.type})},s.readAsBinaryString(t)})}function ce(t){var a=I(atob(t.data));return z([a],{type:t.type})}function wt(t){return t&&t.__local_forage_encoded_blob}function Tr(t){var a=this,r=a._initReady().then(function(){var s=G[a._dbInfo.name];if(s&&s.dbReady)return s.dbReady});return O(r,t,t),r}function Pr(t){W(t);for(var a=G[t.name],r=a.forages,s=0;s<r.length;s++){var c=r[s];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return t.db=null,ee(t).then(function(i){return t.db=i,Ce(t)?he(t):i}).then(function(i){t.db=a.db=i;for(var u=0;u<r.length;u++)r[u]._dbInfo.db=i}).catch(function(i){throw K(t,i),i})}function te(t,a,r,s){s===void 0&&(s=1);try{var c=t.db.transaction(t.storeName,a);r(null,c)}catch(i){if(s>0&&(!t.db||i.name==="InvalidStateError"||i.name==="NotFoundError"))return b.resolve().then(function(){if(!t.db||i.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),he(t)}).then(function(){return Pr(t).then(function(){te(t,a,r,s-1)})}).catch(r);r(i)}}function Ct(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function wr(t){var a=this,r={db:null};if(t)for(var s in t)r[s]=t[s];var c=G[r.name];c||(c=Ct(),G[r.name]=c),c.forages.push(a),a._initReady||(a._initReady=a.ready,a.ready=Tr);var i=[];function u(){return b.resolve()}for(var m=0;m<c.forages.length;m++){var d=c.forages[m];d!==a&&i.push(d._initReady().catch(u))}var p=c.forages.slice(0);return b.all(i).then(function(){return r.db=c.db,ee(r)}).then(function(h){return r.db=h,Ce(r,a._defaultConfig.version)?he(r):h}).then(function(h){r.db=c.db=h,a._dbInfo=r;for(var y=0;y<p.length;y++){var w=p[y];w!==a&&(w._dbInfo.db=r.db,w._dbInfo.version=r.version)}})}function Cr(t,a){var r=this;t=$(t);var s=new b(function(c,i){r.ready().then(function(){te(r._dbInfo,ie,function(u,m){if(u)return i(u);try{var d=m.objectStore(r._dbInfo.storeName),p=d.get(t);p.onsuccess=function(){var h=p.result;h===void 0&&(h=null),wt(h)&&(h=ce(h)),c(h)},p.onerror=function(){i(p.error)}}catch(h){i(h)}})}).catch(i)});return P(s,a),s}function Mr(t,a){var r=this,s=new b(function(c,i){r.ready().then(function(){te(r._dbInfo,ie,function(u,m){if(u)return i(u);try{var d=m.objectStore(r._dbInfo.storeName),p=d.openCursor(),h=1;p.onsuccess=function(){var y=p.result;if(y){var w=y.value;wt(w)&&(w=ce(w));var R=t(w,y.key,h++);R!==void 0?c(R):y.continue()}else c()},p.onerror=function(){i(p.error)}}catch(y){i(y)}})}).catch(i)});return P(s,a),s}function Sr(t,a,r){var s=this;t=$(t);var c=new b(function(i,u){var m;s.ready().then(function(){return m=s._dbInfo,De.call(a)==="[object Blob]"?A(m.db).then(function(d){return d?a:He(a)}):a}).then(function(d){te(s._dbInfo,v,function(p,h){if(p)return u(p);try{var y=h.objectStore(s._dbInfo.storeName);d===null&&(d=void 0);var w=y.put(d,t);h.oncomplete=function(){d===void 0&&(d=null),i(d)},h.onabort=h.onerror=function(){var R=w.error?w.error:w.transaction.error;u(R)}}catch(R){u(R)}})}).catch(u)});return P(c,r),c}function _r(t,a){var r=this;t=$(t);var s=new b(function(c,i){r.ready().then(function(){te(r._dbInfo,v,function(u,m){if(u)return i(u);try{var d=m.objectStore(r._dbInfo.storeName),p=d.delete(t);m.oncomplete=function(){c()},m.onerror=function(){i(p.error)},m.onabort=function(){var h=p.error?p.error:p.transaction.error;i(h)}}catch(h){i(h)}})}).catch(i)});return P(s,a),s}function Ir(t){var a=this,r=new b(function(s,c){a.ready().then(function(){te(a._dbInfo,v,function(i,u){if(i)return c(i);try{var m=u.objectStore(a._dbInfo.storeName),d=m.clear();u.oncomplete=function(){s()},u.onabort=u.onerror=function(){var p=d.error?d.error:d.transaction.error;c(p)}}catch(p){c(p)}})}).catch(c)});return P(r,t),r}function Rr(t){var a=this,r=new b(function(s,c){a.ready().then(function(){te(a._dbInfo,ie,function(i,u){if(i)return c(i);try{var m=u.objectStore(a._dbInfo.storeName),d=m.count();d.onsuccess=function(){s(d.result)},d.onerror=function(){c(d.error)}}catch(p){c(p)}})}).catch(c)});return P(r,t),r}function Br(t,a){var r=this,s=new b(function(c,i){if(t<0){c(null);return}r.ready().then(function(){te(r._dbInfo,ie,function(u,m){if(u)return i(u);try{var d=m.objectStore(r._dbInfo.storeName),p=!1,h=d.openKeyCursor();h.onsuccess=function(){var y=h.result;if(!y){c(null);return}t===0||p?c(y.key):(p=!0,y.advance(t))},h.onerror=function(){i(h.error)}}catch(y){i(y)}})}).catch(i)});return P(s,a),s}function Ar(t){var a=this,r=new b(function(s,c){a.ready().then(function(){te(a._dbInfo,ie,function(i,u){if(i)return c(i);try{var m=u.objectStore(a._dbInfo.storeName),d=m.openKeyCursor(),p=[];d.onsuccess=function(){var h=d.result;if(!h){s(p);return}p.push(h.key),h.continue()},d.onerror=function(){c(d.error)}}catch(h){c(h)}})}).catch(c)});return P(r,t),r}function Nr(t,a){a=q.apply(this,arguments);var r=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName);var s=this,c;if(!t.name)c=b.reject("Invalid arguments");else{var i=t.name===r.name&&s._dbInfo.db,u=i?b.resolve(s._dbInfo.db):ee(t).then(function(m){var d=G[t.name],p=d.forages;d.db=m;for(var h=0;h<p.length;h++)p[h]._dbInfo.db=m;return m});t.storeName?c=u.then(function(m){if(!!m.objectStoreNames.contains(t.storeName)){var d=m.version+1;W(t);var p=G[t.name],h=p.forages;m.close();for(var y=0;y<h.length;y++){var w=h[y];w._dbInfo.db=null,w._dbInfo.version=d}var R=new b(function(B,F){var k=D.open(t.name,d);k.onerror=function(J){var be=k.result;be.close(),F(J)},k.onupgradeneeded=function(){var J=k.result;J.deleteObjectStore(t.storeName)},k.onsuccess=function(){var J=k.result;J.close(),B(J)}});return R.then(function(B){p.db=B;for(var F=0;F<h.length;F++){var k=h[F];k._dbInfo.db=B,Y(k._dbInfo)}}).catch(function(B){throw(K(t,B)||b.resolve()).catch(function(){}),B})}}):c=u.then(function(m){W(t);var d=G[t.name],p=d.forages;m.close();for(var h=0;h<p.length;h++){var y=p[h];y._dbInfo.db=null}var w=new b(function(R,B){var F=D.deleteDatabase(t.name);F.onerror=function(){var k=F.result;k&&k.close(),B(F.error)},F.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},F.onsuccess=function(){var k=F.result;k&&k.close(),R(k)}});return w.then(function(R){d.db=R;for(var B=0;B<p.length;B++){var F=p[B];Y(F._dbInfo)}}).catch(function(R){throw(K(t,R)||b.resolve()).catch(function(){}),R})})}return P(c,a),c}var Ur={_driver:"asyncStorage",_initStorage:wr,_support:H(),iterate:Mr,getItem:Cr,setItem:Sr,removeItem:_r,clear:Ir,length:Rr,key:Br,keys:Ar,dropInstance:Nr};function Dr(){return typeof openDatabase=="function"}var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hr="~~local_forage_type~",Mt=/^~~local_forage_type~([^~]+)~/,Me="__lfsc__:",ke=Me.length,Oe="arbf",Fe="blob",St="si08",_t="ui08",It="uic8",Rt="si16",Bt="si32",At="ur16",Nt="ui32",Ut="fl32",Dt="fl64",Ht=ke+Oe.length,kt=Object.prototype.toString;function Ot(t){var a=t.length*.75,r=t.length,s,c=0,i,u,m,d;t[t.length-1]==="="&&(a--,t[t.length-2]==="="&&a--);var p=new ArrayBuffer(a),h=new Uint8Array(p);for(s=0;s<r;s+=4)i=oe.indexOf(t[s]),u=oe.indexOf(t[s+1]),m=oe.indexOf(t[s+2]),d=oe.indexOf(t[s+3]),h[c++]=i<<2|u>>4,h[c++]=(u&15)<<4|m>>2,h[c++]=(m&3)<<6|d&63;return p}function $e(t){var a=new Uint8Array(t),r="",s;for(s=0;s<a.length;s+=3)r+=oe[a[s]>>2],r+=oe[(a[s]&3)<<4|a[s+1]>>4],r+=oe[(a[s+1]&15)<<2|a[s+2]>>6],r+=oe[a[s+2]&63];return a.length%3===2?r=r.substring(0,r.length-1)+"=":a.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function kr(t,a){var r="";if(t&&(r=kt.call(t)),t&&(r==="[object ArrayBuffer]"||t.buffer&&kt.call(t.buffer)==="[object ArrayBuffer]")){var s,c=Me;t instanceof ArrayBuffer?(s=t,c+=Oe):(s=t.buffer,r==="[object Int8Array]"?c+=St:r==="[object Uint8Array]"?c+=_t:r==="[object Uint8ClampedArray]"?c+=It:r==="[object Int16Array]"?c+=Rt:r==="[object Uint16Array]"?c+=At:r==="[object Int32Array]"?c+=Bt:r==="[object Uint32Array]"?c+=Nt:r==="[object Float32Array]"?c+=Ut:r==="[object Float64Array]"?c+=Dt:a(new Error("Failed to get type for BinaryArray"))),a(c+$e(s))}else if(r==="[object Blob]"){var i=new FileReader;i.onload=function(){var u=Hr+t.type+"~"+$e(this.result);a(Me+Fe+u)},i.readAsArrayBuffer(t)}else try{a(JSON.stringify(t))}catch(u){console.error("Couldn't convert value into a JSON string: ",t),a(null,u)}}function Or(t){if(t.substring(0,ke)!==Me)return JSON.parse(t);var a=t.substring(Ht),r=t.substring(ke,Ht),s;if(r===Fe&&Mt.test(a)){var c=a.match(Mt);s=c[1],a=a.substring(c[0].length)}var i=Ot(a);switch(r){case Oe:return i;case Fe:return z([i],{type:s});case St:return new Int8Array(i);case _t:return new Uint8Array(i);case It:return new Uint8ClampedArray(i);case Rt:return new Int16Array(i);case At:return new Uint16Array(i);case Bt:return new Int32Array(i);case Nt:return new Uint32Array(i);case Ut:return new Float32Array(i);case Dt:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var Xe={serialize:kr,deserialize:Or,stringToBuffer:Ot,bufferToString:$e};function Ft(t,a,r,s){t.executeSql("CREATE TABLE IF NOT EXISTS "+a.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,s)}function Fr(t){var a=this,r={db:null};if(t)for(var s in t)r[s]=typeof t[s]!="string"?t[s].toString():t[s];var c=new b(function(i,u){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(m){return u(m)}r.db.transaction(function(m){Ft(m,r,function(){a._dbInfo=r,i()},function(d,p){u(p)})},u)});return r.serializer=Xe,c}function ae(t,a,r,s,c,i){t.executeSql(r,s,c,function(u,m){m.code===m.SYNTAX_ERR?u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[a.storeName],function(d,p){p.rows.length?i(d,m):Ft(d,a,function(){d.executeSql(r,s,c,i)},i)},i):i(u,m)},i)}function $r(t,a){var r=this;t=$(t);var s=new b(function(c,i){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(m){ae(m,u,"SELECT * FROM "+u.storeName+" WHERE key = ? LIMIT 1",[t],function(d,p){var h=p.rows.length?p.rows.item(0).value:null;h&&(h=u.serializer.deserialize(h)),c(h)},function(d,p){i(p)})})}).catch(i)});return P(s,a),s}function Xr(t,a){var r=this,s=new b(function(c,i){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(m){ae(m,u,"SELECT * FROM "+u.storeName,[],function(d,p){for(var h=p.rows,y=h.length,w=0;w<y;w++){var R=h.item(w),B=R.value;if(B&&(B=u.serializer.deserialize(B)),B=t(B,R.key,w+1),B!==void 0){c(B);return}}c()},function(d,p){i(p)})})}).catch(i)});return P(s,a),s}function $t(t,a,r,s){var c=this;t=$(t);var i=new b(function(u,m){c.ready().then(function(){a===void 0&&(a=null);var d=a,p=c._dbInfo;p.serializer.serialize(a,function(h,y){y?m(y):p.db.transaction(function(w){ae(w,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[t,h],function(){u(d)},function(R,B){m(B)})},function(w){if(w.code===w.QUOTA_ERR){if(s>0){u($t.apply(c,[t,d,r,s-1]));return}m(w)}})})}).catch(m)});return P(i,r),i}function Gr(t,a,r){return $t.apply(this,[t,a,r,1])}function Wr(t,a){var r=this;t=$(t);var s=new b(function(c,i){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(m){ae(m,u,"DELETE FROM "+u.storeName+" WHERE key = ?",[t],function(){c()},function(d,p){i(p)})})}).catch(i)});return P(s,a),s}function Vr(t){var a=this,r=new b(function(s,c){a.ready().then(function(){var i=a._dbInfo;i.db.transaction(function(u){ae(u,i,"DELETE FROM "+i.storeName,[],function(){s()},function(m,d){c(d)})})}).catch(c)});return P(r,t),r}function zr(t){var a=this,r=new b(function(s,c){a.ready().then(function(){var i=a._dbInfo;i.db.transaction(function(u){ae(u,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(m,d){var p=d.rows.item(0).c;s(p)},function(m,d){c(d)})})}).catch(c)});return P(r,t),r}function Yr(t,a){var r=this,s=new b(function(c,i){r.ready().then(function(){var u=r._dbInfo;u.db.transaction(function(m){ae(m,u,"SELECT key FROM "+u.storeName+" WHERE id = ? LIMIT 1",[t+1],function(d,p){var h=p.rows.length?p.rows.item(0).key:null;c(h)},function(d,p){i(p)})})}).catch(i)});return P(s,a),s}function Kr(t){var a=this,r=new b(function(s,c){a.ready().then(function(){var i=a._dbInfo;i.db.transaction(function(u){ae(u,i,"SELECT key FROM "+i.storeName,[],function(m,d){for(var p=[],h=0;h<d.rows.length;h++)p.push(d.rows.item(h).key);s(p)},function(m,d){c(d)})})}).catch(c)});return P(r,t),r}function Qr(t){return new b(function(a,r){t.transaction(function(s){s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,i){for(var u=[],m=0;m<i.rows.length;m++)u.push(i.rows.item(m).name);a({db:t,storeNames:u})},function(c,i){r(i)})},function(s){r(s)})})}function Jr(t,a){a=q.apply(this,arguments);var r=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName);var s=this,c;return t.name?c=new b(function(i){var u;t.name===r.name?u=s._dbInfo.db:u=openDatabase(t.name,"","",0),t.storeName?i({db:u,storeNames:[t.storeName]}):i(Qr(u))}).then(function(i){return new b(function(u,m){i.db.transaction(function(d){function p(R){return new b(function(B,F){d.executeSql("DROP TABLE IF EXISTS "+R,[],function(){B()},function(k,J){F(J)})})}for(var h=[],y=0,w=i.storeNames.length;y<w;y++)h.push(p(i.storeNames[y]));b.all(h).then(function(){u()}).catch(function(R){m(R)})},function(d){m(d)})})}):c=b.reject("Invalid arguments"),P(c,a),c}var qr={_driver:"webSQLStorage",_initStorage:Fr,_support:Dr(),iterate:Xr,getItem:$r,setItem:Gr,removeItem:Wr,clear:Vr,length:zr,key:Yr,keys:Kr,dropInstance:Jr};function Zr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Xt(t,a){var r=t.name+"/";return t.storeName!==a.storeName&&(r+=t.storeName+"/"),r}function jr(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(a){return!0}}function en(){return!jr()||localStorage.length>0}function tn(t){var a=this,r={};if(t)for(var s in t)r[s]=t[s];return r.keyPrefix=Xt(t,a._defaultConfig),en()?(a._dbInfo=r,r.serializer=Xe,b.resolve()):b.reject()}function rn(t){var a=this,r=a.ready().then(function(){for(var s=a._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var i=localStorage.key(c);i.indexOf(s)===0&&localStorage.removeItem(i)}});return P(r,t),r}function nn(t,a){var r=this;t=$(t);var s=r.ready().then(function(){var c=r._dbInfo,i=localStorage.getItem(c.keyPrefix+t);return i&&(i=c.serializer.deserialize(i)),i});return P(s,a),s}function on(t,a){var r=this,s=r.ready().then(function(){for(var c=r._dbInfo,i=c.keyPrefix,u=i.length,m=localStorage.length,d=1,p=0;p<m;p++){var h=localStorage.key(p);if(h.indexOf(i)===0){var y=localStorage.getItem(h);if(y&&(y=c.serializer.deserialize(y)),y=t(y,h.substring(u),d++),y!==void 0)return y}}});return P(s,a),s}function an(t,a){var r=this,s=r.ready().then(function(){var c=r._dbInfo,i;try{i=localStorage.key(t)}catch(u){i=null}return i&&(i=i.substring(c.keyPrefix.length)),i});return P(s,a),s}function sn(t){var a=this,r=a.ready().then(function(){for(var s=a._dbInfo,c=localStorage.length,i=[],u=0;u<c;u++){var m=localStorage.key(u);m.indexOf(s.keyPrefix)===0&&i.push(m.substring(s.keyPrefix.length))}return i});return P(r,t),r}function cn(t){var a=this,r=a.keys().then(function(s){return s.length});return P(r,t),r}function fn(t,a){var r=this;t=$(t);var s=r.ready().then(function(){var c=r._dbInfo;localStorage.removeItem(c.keyPrefix+t)});return P(s,a),s}function un(t,a,r){var s=this;t=$(t);var c=s.ready().then(function(){a===void 0&&(a=null);var i=a;return new b(function(u,m){var d=s._dbInfo;d.serializer.serialize(a,function(p,h){if(h)m(h);else try{localStorage.setItem(d.keyPrefix+t,p),u(i)}catch(y){(y.name==="QuotaExceededError"||y.name==="NS_ERROR_DOM_QUOTA_REACHED")&&m(y),m(y)}})})});return P(c,r),c}function ln(t,a){if(a=q.apply(this,arguments),t=typeof t!="function"&&t||{},!t.name){var r=this.config();t.name=t.name||r.name,t.storeName=t.storeName||r.storeName}var s=this,c;return t.name?c=new b(function(i){t.storeName?i(Xt(t,s._defaultConfig)):i(t.name+"/")}).then(function(i){for(var u=localStorage.length-1;u>=0;u--){var m=localStorage.key(u);m.indexOf(i)===0&&localStorage.removeItem(m)}}):c=b.reject("Invalid arguments"),P(c,a),c}var mn={_driver:"localStorageWrapper",_initStorage:tn,_support:Zr(),iterate:on,getItem:nn,setItem:un,removeItem:fn,clear:rn,length:cn,key:an,keys:sn,dropInstance:ln},dn=function(a,r){return a===r||typeof a=="number"&&typeof r=="number"&&isNaN(a)&&isNaN(r)},pn=function(a,r){for(var s=a.length,c=0;c<s;){if(dn(a[c],r))return!0;c++}return!1},Gt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},ve={},Wt={},fe={INDEXEDDB:Ur,WEBSQL:qr,LOCALSTORAGE:mn},hn=[fe.INDEXEDDB._driver,fe.WEBSQL._driver,fe.LOCALSTORAGE._driver],Se=["dropInstance"],Ge=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Se),vn={description:"",driver:hn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function bn(t,a){t[a]=function(){var r=arguments;return t.ready().then(function(){return t[a].apply(t,r)})}}function We(){for(var t=1;t<arguments.length;t++){var a=arguments[t];if(a)for(var r in a)a.hasOwnProperty(r)&&(Gt(a[r])?arguments[0][r]=a[r].slice():arguments[0][r]=a[r])}return arguments[0]}var gn=function(){function t(a){S(this,t);for(var r in fe)if(fe.hasOwnProperty(r)){var s=fe[r],c=s._driver;this[r]=c,ve[c]||this.defineDriver(s)}this._defaultConfig=We({},vn),this._config=We({},this._defaultConfig,a),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(r){if((typeof r>"u"?"undefined":E(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var s in r){if(s==="storeName"&&(r[s]=r[s].replace(/\W/g,"_")),s==="version"&&typeof r[s]!="number")return new Error("Database version must be a number.");this._config[s]=r[s]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},t.prototype.defineDriver=function(r,s,c){var i=new b(function(u,m){try{var d=r._driver,p=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){m(p);return}for(var h=Ge.concat("_initStorage"),y=0,w=h.length;y<w;y++){var R=h[y],B=!pn(Se,R);if((B||r[R])&&typeof r[R]!="function"){m(p);return}}var F=function(){for(var be=function(Ln){return function(){var xn=new Error("Method "+Ln+" is not implemented by the current driver"),Vt=b.reject(xn);return P(Vt,arguments[arguments.length-1]),Vt}},Ve=0,En=Se.length;Ve<En;Ve++){var ze=Se[Ve];r[ze]||(r[ze]=be(ze))}};F();var k=function(be){ve[d]&&console.info("Redefining LocalForage driver: "+d),ve[d]=r,Wt[d]=be,u()};"_support"in r?r._support&&typeof r._support=="function"?r._support().then(k,m):k(!!r._support):k(!0)}catch(J){m(J)}});return O(i,s,c),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(r,s,c){var i=ve[r]?b.resolve(ve[r]):b.reject(new Error("Driver not found."));return O(i,s,c),i},t.prototype.getSerializer=function(r){var s=b.resolve(Xe);return O(s,r),s},t.prototype.ready=function(r){var s=this,c=s._driverSet.then(function(){return s._ready===null&&(s._ready=s._initDriver()),s._ready});return O(c,r,r),c},t.prototype.setDriver=function(r,s,c){var i=this;Gt(r)||(r=[r]);var u=this._getSupportedDrivers(r);function m(){i._config.driver=i.driver()}function d(y){return i._extend(y),m(),i._ready=i._initStorage(i._config),i._ready}function p(y){return function(){var w=0;function R(){for(;w<y.length;){var B=y[w];return w++,i._dbInfo=null,i._ready=null,i.getDriver(B).then(d).catch(R)}m();var F=new Error("No available storage method found.");return i._driverSet=b.reject(F),i._driverSet}return R()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=h.then(function(){var y=u[0];return i._dbInfo=null,i._ready=null,i.getDriver(y).then(function(w){i._driver=w._driver,m(),i._wrapLibraryMethodsWithReady(),i._initDriver=p(u)})}).catch(function(){m();var y=new Error("No available storage method found.");return i._driverSet=b.reject(y),i._driverSet}),O(this._driverSet,s,c),this._driverSet},t.prototype.supports=function(r){return!!Wt[r]},t.prototype._extend=function(r){We(this,r)},t.prototype._getSupportedDrivers=function(r){for(var s=[],c=0,i=r.length;c<i;c++){var u=r[c];this.supports(u)&&s.push(u)}return s},t.prototype._wrapLibraryMethodsWithReady=function(){for(var r=0,s=Ge.length;r<s;r++)bn(this,Ge[r])},t.prototype.createInstance=function(r){return new t(r)},t}(),yn=new gn;l.exports=yn},{"3":3}]},{},[4])(4)})});var Ke=n=>{let e=typeof n;return n!==null&&(e==="object"||e==="function")},Ye=new Set(["__proto__","prototype","constructor"]),Nn=new Set("0123456789");function qt(n){let e=[],o="",f="start",l=!1;for(let L of n)switch(L){case"\\":if(f==="index")throw new Error("Invalid character in an index");if(f==="indexEnd")throw new Error("Invalid character after an index");l&&(o+=L),f="property",l=!l;break;case".":if(f==="index")throw new Error("Invalid character in an index");if(f==="indexEnd"){f="property";break}if(l){l=!1,o+=L;break}if(Ye.has(o))return[];e.push(o),o="",f="property";break;case"[":if(f==="index")throw new Error("Invalid character in an index");if(f==="indexEnd"){f="index";break}if(l){l=!1,o+=L;break}if(f==="property"){if(Ye.has(o))return[];e.push(o),o=""}f="index";break;case"]":if(f==="index"){e.push(Number.parseInt(o,10)),o="",f="indexEnd";break}if(f==="indexEnd")throw new Error("Invalid character after an index");default:if(f==="index"&&!Nn.has(L))throw new Error("Invalid character in an index");if(f==="indexEnd")throw new Error("Invalid character after an index");f==="start"&&(f="property"),l&&(l=!1,o+="\\"),o+=L}switch(l&&(o+="\\"),f){case"property":{if(Ye.has(o))return[];e.push(o);break}case"index":throw new Error("Index was not closed");case"start":{e.push("");break}}return e}function Zt(n,e){if(typeof e!="number"&&Array.isArray(n)){let o=Number.parseInt(e,10);return Number.isInteger(o)&&n[o]===n[e]}return!1}function Un(n,e){if(Zt(n,e))throw new Error("Cannot use string index")}function _(n,e,o){if(!Ke(n)||typeof e!="string")return o===void 0?n:o;let f=qt(e);if(f.length===0)return o;for(let l=0;l<f.length;l++){let L=f[l];if(Zt(n,L)?n=l===f.length-1?void 0:null:n=n[L],n==null){if(l!==f.length-1)return o;break}}return n===void 0?o:n}function jt(n,e,o){if(!Ke(n)||typeof e!="string")return n;let f=n,l=qt(e);for(let L=0;L<l.length;L++){let E=l[L];Un(n,E),L===l.length-1?n[E]=o:Ke(n[E])||(n[E]=typeof l[L+1]=="number"?[]:{}),n=n[E]}return f}var Pe=An(tr());var N=n=>document.getElementById(n),rr=(n,e)=>{if(document.visibilityState==="hidden")return!1;let o=Object.entries(e);for(let[f,l]of o)n[f]=l;return!0},x=(n,e)=>document.visibilityState==="hidden"?!1:rr(N(n),e),U=(n,e)=>document.visibilityState==="hidden"?!1:rr(N(n).style,e);var re=(n,e)=>n.querySelector(e),Dn=(n,e)=>{let o=N("confirmationBox"),f=N("confirmWrapper"),l=re(document,"#confirm"),L=re(document,"#transparentBG"),E=re(l,"#okConfirm"),S=re(l,"#cancelConfirm");o.style.display="block",f.style.display="block",L.style.display="block",re(l,"p").textContent=n,l.focus();let T=({target:H})=>{let z=H;return E.removeEventListener("click",T),S.removeEventListener("click",T),l.removeEventListener("keyup",D),o.style.display="none",f.style.display="none",L.style.display="none",e(z===E)},D=H=>H.key==="Enter"||H.key===" "?T({target:E}):H.key==="Escape"?T({target:S}):H.preventDefault();E.addEventListener("click",T),S.addEventListener("click",T),l.addEventListener("keyup",D)},Hn=(n,e)=>{let o=N("confirmationBox"),f=N("alertWrapper"),l=re(document,"#transparentBG"),L=re(document,"#alert"),E=re(L,"#okAlert");o.style.display="block",f.style.display="block",l.style.display="block",re(L,"p").textContent=n,L.focus();let S=()=>{E.removeEventListener("click",S),L.removeEventListener("keyup",T),o.style.display="none",f.style.display="none",l.style.display="none",e(void 0)},T=D=>(D.key==="Enter"||D.key===" ")&&S();E.addEventListener("click",S),L.addEventListener("keyup",T)};var Z=n=>new Promise(e=>Hn(n,e));var Ie=n=>new Promise(e=>Dn(n,e));var g=(n,e=0)=>{if(n<0)return"-"+g(-n,e);if(n>=1e6){let D=Math.floor(Math.log10(n));return n/=Math.pow(10,D),g(n,2)+"e"+g(D)}let o=Math.floor(n),f=n-o,l=o.toLocaleString(),L=e>0&&n!==0,E=Math.pow(10,e)*f,S=1e-6;Math.ceil(E)-E<S&&(E=Math.ceil(E));let T=L?Math.floor(E).toString():"";if(T!==""){for(;T.length<e;)T="0"+T;T="."+T}return l+T};var ye=class{constructor(e=0,o){this.amount=e;this.player=o;this.amount=e,this.updateHTML()}spend(e){this.amount>=e&&(this.amount-=e,this.updateHTML())}gain(e){this.amount+=e,this.updateHTML(),this.updateOnGain(e)}set(e){this.amount=e,this.updateHTML()}valueOf(){return{amount:this.amount}}};var Je=class extends ye{updateHTML(){x("gold-amount",{textContent:g(this.amount)})}updateOnGain(e){e>0&&this.player.talents.coinGain.gainEXP(e)}};var qe=class extends ye{updateHTML(){x("fragment-amount",{textContent:g(this.amount)}),x("fragment-bonus",{textContent:g(this.amount)}),x("fragment-gain",{textContent:g(this.getAmountOnRefresh())})}getAmountOnRefresh(){let e=this.player.barLevel,o=100*Math.pow(1.07,-5);return o*=Math.pow(1.07,e),o*=Math.pow(3,Math.floor(e/100)),o*=1+this.player.criticalHitsThisRefresh*this.player.coinUpgrades.barAgitation.upgradeEffect(),o*=1+this.player.coinUpgrades.barReinforcement.upgradeEffect()*this.player.barLevel,Math.floor(o)}unspentBonus(){return 1+1/100*this.amount}updateOnGain(){}};var ue=n=>{U("mainTab",{display:"none"}),U("upgradeTab",{display:"none"}),U("talentsTab",{display:"none"}),n==="Main"?U("mainTab",{display:"block"}):n==="Upgrades"?U("upgradeTab",{display:"block"}):n==="Talents"&&U("talentsTab",{display:"block"})},Re=n=>{U("progression",{backgroundColor:"gold"}),setTimeout(()=>{U("progression",{backgroundColor:le(n)})},250),x("refresh-crit-counter",{textContent:g(n.criticalHitsThisRefresh)}),x("refresh-crit-fragments",{textContent:g(100*n.criticalHitsThisRefresh*n.coinUpgrades.barAgitation.upgradeEffect(),2)}),n.barFragments.updateHTML()},Be=n=>{U("progression",{backgroundColor:"cyan"}),setTimeout(()=>{U("progression",{backgroundColor:le(n)})},1e3),x("coinWorth",{textContent:`Worth ${g(se(n))} coins`}),x("refresh-crit-counter",{textContent:g(n.criticalHitsThisRefresh)}),x("refresh-counter",{textContent:g(n.refreshCount)})};var kn=10,Ae=0,Ze=0,Ee=n=>{let e=0;return e+=kn*Math.pow(n.barLevel+1,2),e*=Math.min(1,(n.barLevel+20)/40),e*=Math.max(1,1+(n.barLevel-20)/10),n.barLevel>40&&(e*=Math.pow(2,1/10*(n.barLevel-40))),n.barLevel>100&&(e*=Math.pow(2,1/10*(n.barLevel-100))),n.barLevel>200&&(e*=Math.pow(2,1/10*(n.barLevel-200))),e},On=n=>{let e=0;return n.barLevel>=5&&(e=.1),n.barLevel>=10&&(e+=.9*(1-Math.pow(Math.E,-n.barLevel/200))),e>=.9999?1e4:1/(1-e)},Fn=n=>On(n)*(1-n.barEXP/n.barTNL),nr=(n,e)=>{if(n==null)return;let o=1;o+=e.coinUpgrades.barSpeed.upgradeEffect(),o*=e.barFragments.unspentBonus(),o*=Math.pow(1+e.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,e.barEXP/e.barTNL))),o/=Fn(e),o*=e.talents.barSpeed.talentEffect(),o*=Math.pow(1+e.coinUpgrades.barEmpowerment.upgradeEffect(),e.barLevel);let f=Math.random(),l=e.coinUpgrades.barReverberation.upgradeEffect()+e.talents.barCriticalChance.talentEffect();f<l&&(o*=e.coinUpgrades.barVibration.upgradeEffect(),e.talents.barCriticalChance.gainEXP(n),e.criticalHits+=1,e.criticalHitsThisRefresh+=1,Re(e));let L=o*n;e.barEXP+=L,Ae+=L,x("perSecCurr",{textContent:`+${g(Ae,2)} this sec`})},me=(n,e)=>Math.min(100,.1*Math.floor(1e3*n/e)),de=n=>{U("progression",{width:`${n}%`})},le=n=>{if(n.barLevel>=128)return"#FFFFFF";let e=(128+n.barLevel).toString(16).padStart(2,"0"),o=(2*n.barLevel).toString(16).padStart(2,"0"),f=(128+n.barLevel).toString(16).padStart(2,"0");return`#${e}${o}${f}`},or=n=>{n.coins.gain(n.coinValueCache),n.coinValueCache=se(n),n.barEXP-=n.barTNL,n.barLevel+=1,n.barLevel>n.highestBarLevel&&(n.highestBarLevel=n.barLevel);let e=le(n);U("progression",{backgroundColor:e}),n.barTNL=Ee(n),n.barEXP/=10,n.barEXP=Math.min(n.barEXP,Math.floor(n.barTNL/10));let o=me(n.barEXP,n.barTNL);de(o),x("coinWorth",{textContent:`Worth ${g(n.coinValueCache)} coins`}),n.barFragments.updateHTML(),n.barLevel===20&&(n.talents.barCriticalChance.updateHTML("Level20"),n.talents.barSpeed.updateHTML("Level20"))},ar=n=>{x("level",{textContent:`Level: ${n.barLevel}`}),x("exp",{textContent:`EXP: ${g(n.barEXP)}/${g(n.barTNL)}`})},ir=n=>{Ze=Ae,Ae=0,x("perSecPrev",{textContent:`+${g(Ze,2)} prev sec`}),n.talents.barCriticalChance.updateHTML("Time"),n.talents.barSpeed.gainEXP(Ze),n.talents.barSpeed.updateHTML("Time"),n.talents.coinGain.updateHTML("Time")},se=n=>{let e=0,o=1+n.barLevel;o>n.highestBarLevel&&(e+=3),o%5===0&&(e+=Math.floor(o/5)+3),o%10===0&&(e+=Math.floor(o/2)),o%50===0&&(e+=Math.floor(o/2)),o%100===0&&(e+=Math.floor(o)),e>100&&(e=10*Math.pow(e,1/2)),e*=1+n.talents.coinGain.talentEffect();let f=e-Math.floor(e);Math.random()<f&&(e+=1),e=Math.floor(e);let l=N("coinWorth");return l.style.color=e>0?"gold":"grey",e};var Le=class{constructor(e,o,f){this.level=e;this.cost=o;this.player=f}};var ne=class extends Le{constructor(e,o,f){super(e,o,f);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(e,o){o.shiftKey&&(e=-1,e=Math.floor(this.player.coins.amount/this.cost)),this.maxLevel!==-1&&(e=Math.min(e,this.maxLevel-this.level)),this.cost*e<=this.player.coins.amount&&(this.player.coins.spend(this.cost*e),this.level+=e,this.updateHTML())}valueOf(){return{level:this.level,cost:this.cost,maxLevel:this.maxLevel}}},V={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4,barAdoption:250,barEmpowerment:1e4,barReinforcement:2e4},je=class extends ne{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){x("coin-bar-speed-effect",{textContent:`+${g(this.upgradeEffect(),2)} Progress Per Second`}),x("coin-bar-speed-name",{textContent:`Bar Speed ${g(this.level)}`})}},et=class extends ne{constructor(e,o,f){super(e,o,f);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?Math.pow(100,1/10)-1:(.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level))*(Math.pow(100,1/10)/.5)}updateHTML(){x("coin-bar-momentum-effect",{textContent:`Up to ${g(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel?(x("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),U("coin-bar-momentum-name",{color:"orchid"})):x("coin-bar-momentum-name",{textContent:`Bar Momentum ${g(this.level)}/${g(this.maxLevel)}`})}},tt=class extends ne{constructor(e,o,f){super(e,o,f);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.1:.09*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+.002*Math.min(5,this.level)}updateHTML(){x("coin-bar-reverberation-effect",{textContent:`+${g(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel?(x("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),U("coin-bar-reverberation-name",{color:"orchid"})):x("coin-bar-reverberation-name",{textContent:`Bar Reverberation ${g(this.level)}/${g(this.maxLevel)}`})}},rt=class extends ne{constructor(e,o,f){super(e,o,f);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?200:20+170*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+Math.min(10,this.level)}updateHTML(){x("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${g(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel?(x("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),U("coin-bar-vibration-name",{color:"orchid"})):x("coin-bar-vibration-name",{textContent:`Bar Vibration ${g(this.level)}/${g(this.maxLevel)}`})}},nt=class extends ne{constructor(e,o,f){super(e,o,f);this.maxLevel=10;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/5e3}updateHTML(){x("coin-bar-agitation-effect",{textContent:`+${g(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT`}),this.level===this.maxLevel?(x("coin-bar-agitation-name",{textContent:"Bar Agitation [MAX LEVEL]"}),U("coin-bar-agitation-name",{color:"orchid"})):x("coin-bar-agitation-name",{textContent:`Bar Agitation ${g(this.level)}/${g(this.maxLevel)}`})}},ot=class extends ne{constructor(e,o,f){super(e,o,f);this.maxLevel=200;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/100}updateHTML(){x("coin-bar-adoption-effect",{textContent:`+${g(100*this.upgradeEffect())}% Talent EXP`}),this.level===this.maxLevel?(x("coin-bar-adoption-name",{textContent:"Bar Adoption [MAX LEVEL]"}),U("coin-bar-adoption-name",{color:"orchid"})):x("coin-bar-adoption-name",{textContent:`Bar Adoption ${g(this.level)}/${g(this.maxLevel)}`})}},at=class extends ne{constructor(e,o,f){super(e,o,f);this.maxLevel=20;this.capLevel(),this.updateHTML()}upgradeEffect(){return .02*this.level/200}updateHTML(){x("coin-bar-empowerment-effect",{textContent:`+${g(100*this.upgradeEffect(),2)}% Progress Speed per level: (1+x)^(level)`}),this.level===this.maxLevel?(x("coin-bar-empowerment-name",{textContent:"Bar Empowerment [MAX LEVEL]"}),U("coin-bar-empowerment-name",{color:"orchid"})):x("coin-bar-empowerment-name",{textContent:`Bar Empowerment ${g(this.level)}/${g(this.maxLevel)}`})}},it=class extends ne{constructor(e,o,f){super(e,o,f);this.maxLevel=-1;this.updateHTML()}upgradeEffect(){return this.level/1e3}updateHTML(){x("coin-bar-reinforcement-effect",{textContent:`+${g(100*this.upgradeEffect(),2)}% Bar Fragments per level (1 + x * level)`}),x("coin-bar-reinforcement-name",{textContent:`Bar Reinforcement ${g(this.level)}`})}};var sr="coinUpgrades.barSpeed",st=(n,e)=>{var f,l;let o=(f=_(n,sr))!=null?f:_(e,sr);return new je((l=o==null?void 0:o.level)!=null?l:0,V.barSpeed,e)};var cr="coinUpgrades.barMomentum",ct=(n,e)=>{var f,l;let o=(f=_(n,cr))!=null?f:_(e,cr);return new et((l=o==null?void 0:o.level)!=null?l:0,V.barMomentum,e)};var fr="coinUpgrades.barReverberation",ft=(n,e)=>{var f,l;let o=(f=_(n,fr))!=null?f:_(e,fr);return new tt((l=o==null?void 0:o.level)!=null?l:0,V.barReverberation,e)};var ur="coinUpgrades.barVibration",ut=(n,e)=>{var f,l;let o=(f=_(n,ur))!=null?f:_(e,ur);return new rt((l=o==null?void 0:o.level)!=null?l:0,V.barVibration,e)};var lr="coinUpgrades.barAgitation",lt=(n,e)=>{var f,l;let o=(f=_(n,lr))!=null?f:_(e,lr);return new nt((l=o==null?void 0:o.level)!=null?l:0,V.barAgitation,e)};var mr="coinUpgrades.barAdoption",mt=(n,e)=>{var f,l;let o=(f=_(n,mr))!=null?f:_(e,mr);return new ot((l=o==null?void 0:o.level)!=null?l:0,V.barAdoption,e)};var dr="coinUpgrades.barEmpowerment",dt=(n,e)=>{var f,l;let o=(f=_(n,dr))!=null?f:_(e,dr);return new at((l=o==null?void 0:o.level)!=null?l:0,V.barEmpowerment,e)};var pr="coinUpgrades.barReinforcement",pt=(n,e)=>{var f,l;let o=(f=_(n,pr))!=null?f:_(e,pr);return new it((l=o==null?void 0:o.level)!=null?l:0,V.barReinforcement,e)};var hr=(n,e,o,f=1)=>Math.ceil(n*(Math.pow(o,f)-Math.pow(e,f)));var Ne=(n,e)=>{if(n==="Refresh"&&e.barLevel>=5){if(e.refreshTime<xe)return void Z(`Currently, refreshes have a ${g(xe)} second cooldown. Sorry!`);e.barFragments.set(e.barFragments.getAmountOnRefresh()),e.barEXP=0,e.barLevel=0,e.barTNL=Ee(e),de(me(e.barEXP,e.barTNL)),e.barFragments.updateHTML(),e.talents.barCriticalChance.convertToPerm(),e.talents.barCriticalChance.updateHTML("Initialize"),e.talents.barSpeed.convertToPerm(),e.talents.barSpeed.updateHTML("Initialize"),e.talents.coinGain.convertToPerm(),e.talents.coinGain.updateHTML("Initialize"),e.refreshCount+=1,e.refreshTime=0,e.criticalHitsThisRefresh=0,e.coinValueCache=se(e),Re(e),Be(e)}else return void Z("You cannot refresh yet. Get to level 5 lol")};var Te=n=>n.barLevel>=20,Ue=class extends Le{constructor(e,o,f,l,L,E){super(e,o,E);this.investedFragments=f,this.permLevel=l,this.currEXP=L,this.currTNL=this.calculateTNL()}calculateTNL(){let e=hr(this.cost,this.level,this.level+1,2),o=[50,100,200,500,1e3,2e3,5e3,1e4];for(let f of o)this.level>=f&&(e*=2);return e}setEXP(e){this.currEXP=e,this.updateHTML("GainEXP")}globalTalentEXPMultipliers(){let e=1;return e*=1+1/100*Math.pow(Math.log2(1+this.investedFragments/125),2),e*=1+this.player.coinUpgrades.barAdoption.upgradeEffect(),e}gainEXP(e){if(!Te(this.player))return;let o=this.calculateEXPGain(e);this.currEXP+=o,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}subEXP(e){!Te(this.player)||(this.currEXP-=e)}levelUp(){let e=0;for(;this.currEXP>=this.currTNL&&!(e>=10);)this.level+=1,this.subEXP(this.currTNL),this.currTNL=this.calculateTNL(),e++;this.updateHTML("LevelUp")}computePermLevelGain(e){let o=0;return o+=Math.sqrt(e),o*=Math.min(4,Math.pow(this.player.refreshTime/300,2)),o=Math.min(e,o),Math.floor(o)}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}async sacrificeFragments(){if(this.player.barFragments.amount<1e3)return void Z("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(this.player.barFragments.amount<=this.investedFragments)return void Z(`This bar needs more fragments than you can invest. You need ${g(this.investedFragments)}.`);await Ie(`You will sacrifice ${g(this.player.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=this.player.barFragments.amount,this.player.refreshTime+=xe,Ne("Refresh",this.player),this.player.barFragments.set(0))}updateHTML(e){if(this.idHTML!==void 0){if(e==="Initialize"||e==="GainEXP"||e==="LevelUp"||e==="PermLevelUp"){x(`talent${this.idHTML}EXP`,{textContent:`EXP: ${g(this.currEXP)}/${g(this.currTNL)}`});let o=`${this.getBarWidth()}%`;U(`talent${this.idHTML}Progression`,{width:o})}(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp")&&x(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${g(this.level)}`}),(e==="Initialize"||e==="PermLevelUp")&&x(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${g(this.permLevel)}`}),(e==="Initialize"||e==="Time"||e==="LevelUp")&&x(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${g(this.computePermLevelGain(this.level))}`}),(e==="Initialize"||e==="LevelUp"||e==="PermLevelUp"||e==="Level20")&&x(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}valueOf(){return{level:this.level,cost:this.cost,investedFragments:this.investedFragments,permLevel:this.permLevel,currEXP:this.currEXP,idHTML:this.idHTML}}},pe={talentCriticalChance:10,talentProgressSpeed:10,talentCoinGain:1e3},ht=class extends Ue{constructor(e,o,f,l,L,E){super(e,o,f,l,L,E);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(e){let o=1;return o*=e*1e3/gt,o*=this.player.barLevel/10-1,o*=this.globalTalentEXPMultipliers(),o}talentEffect(){return Te(this.player)?.025*(1-Math.pow(Math.E,-this.level/2500))+.025*Math.min(250,this.level)/250+.025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.025*Math.min(500,this.level)/500:0}displayEffect(){return`+${g(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},vt=class extends Ue{constructor(e,o,f,l,L,E){super(e,o,f,l,L,E);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(e){let o=Math.log10(1+e);return o*=this.player.barLevel/10-1,o*=this.globalTalentEXPMultipliers(),o}talentEffect(){return Te?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${g(100*(this.talentEffect()-1),2)}%`}},bt=class extends Ue{constructor(e,o,f,l,L,E){super(e,o,f,l,L,E);this.idHTML="CoinGain";this.updateHTML("Initialize")}calculateEXPGain(e){let o=10+Math.floor(Math.pow(e,2)/100+3*e);return o*=this.globalTalentEXPMultipliers(),o}talentEffect(){return Te?Math.min(.4,this.level/1e3)+Math.min(.4,this.permLevel/2e3)+.2*(this.level*25+this.permLevel)/(2500+this.level*25+this.permLevel)+1*(this.level*25+this.permLevel)/(5e4+this.level*25+this.permLevel):0}displayEffect(){return`Progress bar grants +${g(100*this.talentEffect(),2)}% coins!`}};var vr="talents.barCriticalChance",yt=(n,e)=>{var f,l,L,E,S;let o=(f=_(n,vr))!=null?f:_(e,vr);return new ht((l=o==null?void 0:o.level)!=null?l:0,pe.talentCriticalChance,(L=o==null?void 0:o.investedFragments)!=null?L:0,(E=o==null?void 0:o.permLevel)!=null?E:0,(S=o==null?void 0:o.currEXP)!=null?S:0,e)};var br="talents.barSpeed",Et=(n,e)=>{var f,l,L,E,S;let o=(f=_(n,br))!=null?f:_(e,br);return new vt((l=o==null?void 0:o.level)!=null?l:0,pe.talentProgressSpeed,(L=o==null?void 0:o.investedFragments)!=null?L:0,(E=o==null?void 0:o.permLevel)!=null?E:0,(S=o==null?void 0:o.currEXP)!=null?S:0,e)};var gr="talents.coinGain",Lt=(n,e)=>{var f,l,L,E,S;let o=(f=_(n,gr))!=null?f:_(e,gr);return new bt((l=o==null?void 0:o.level)!=null?l:0,pe.talentCoinGain,(L=o==null?void 0:o.investedFragments)!=null?L:0,(E=o==null?void 0:o.permLevel)!=null?E:0,(S=o==null?void 0:o.currEXP)!=null?S:0,e)};var M={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0,coinValueCache:0},Er=Object.assign({},M),Xn=async n=>{let e=Jt(Qt({},n),{coins:n.coins.valueOf(),coinUpgrades:{barSpeed:n.coinUpgrades.barSpeed.valueOf(),barMomentum:n.coinUpgrades.barMomentum.valueOf(),barReverberation:n.coinUpgrades.barReverberation.valueOf(),barVibration:n.coinUpgrades.barVibration.valueOf(),barAgitation:n.coinUpgrades.barAgitation.valueOf(),barAdoption:n.coinUpgrades.barAdoption.valueOf(),barEmpowerment:n.coinUpgrades.barEmpowerment.valueOf(),barReinforcement:n.coinUpgrades.barReinforcement.valueOf()},talents:{barCriticalChance:n.talents.barCriticalChance.valueOf(),barSpeed:n.talents.barSpeed.valueOf(),coinGain:n.talents.coinGain.valueOf()},barFragments:n.barFragments.valueOf()}),o=btoa(JSON.stringify(e));o!==null&&await Pe.default.setItem("UPBSave",o)},yr=new Map([["coins",(n,e)=>{var o,f;return new Je(Number((f=(o=n.coins)==null?void 0:o.amount)!=null?f:0),e)}],["coinUpgrades.barSpeed",st],["coinUpgrades.barMomentum",ct],["coinUpgrades.barReverberation",ft],["coinUpgrades.barVibration",ut],["coinUpgrades.barAgitation",lt],["coinUpgrades.barAdoption",mt],["coinUpgrades.barEmpowerment",dt],["coinUpgrades.barReinforcement",pt],["talents.barCriticalChance",yt],["talents.barSpeed",Et],["talents.coinGain",Lt],["barFragments",(n,e)=>{var o,f;return new qe(Number((f=(o=n.barFragments)==null?void 0:o.amount)!=null?f:0),e)}]]),Gn=async()=>{let n=await Pe.default.getItem("UPBSave"),e=n?JSON.parse(atob(n)):null;if(e!==null){let o=Object.keys(e);for(let f of o)f in Er&&(yr.has(f)||Object.defineProperty(M,f,{value:e[f]}))}for(let[o,f]of yr)jt(M,o,f(e!=null?e:M,M))},we=new Set,xt=new Proxy(setInterval,{apply(n,e,o){let f=n.apply(e,o);return we.add(f),f}}),Wn=new Proxy(clearInterval,{apply(n,e,o){let f=o[0];return we.has(f)&&we.delete(f),n.apply(e,o)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var Tt=0,gt=24,Vn=5e3,Pt=async()=>{for(let n of we)Wn(n);we.clear(),await Gn(),M.barTNL=Ee(M),Object.defineProperty(window,"player",{value:M}),de(me(M.barEXP,M.barTNL)),M.barFragments.updateHTML(),ue("Main"),U("progression",{backgroundColor:le(M)}),x("coinWorth",{textContent:`Worth ${g(M.coinValueCache)} coins`}),M.coinValueCache&&U("coinWorth",{color:"gold"}),Tt=performance.now(),xt(zn,1e3/gt),xt(ir,1e3,M),xt(Xn,Vn,M)},Lr=async()=>{if(await Ie("Are you SURE you want to reset the game?")===!1)return Z("OK, the game hasn't been reset!");await Pe.default.removeItem("UPBSave");let e=btoa(JSON.stringify(Er));await Pe.default.setItem("UPBSave",e),await Pt()},zn=()=>{let e=performance.now()-Tt;Yn(e/1e3),Tt+=e},Yn=n=>{nr(n,M),M.refreshTime+=n,x("refresh-timer",{textContent:`${g(M.refreshTime,2)}s`});let e=me(M.barEXP,M.barTNL);e<100?de(e):or(M),ar(M)},xe=60;var xr=n=>{N("main-tab-nav").addEventListener("click",()=>ue("Main")),N("upgrade-tab-nav").addEventListener("click",()=>ue("Upgrades")),N("talent-tab-nav").addEventListener("click",()=>ue("Talents")),N("buy-coin-bar-speed").addEventListener("click",e=>n.coinUpgrades.barSpeed.purchaseLevels(1,e)),N("buy-coin-bar-momentum").addEventListener("click",e=>n.coinUpgrades.barMomentum.purchaseLevels(1,e)),N("buy-coin-bar-reverberation").addEventListener("click",e=>n.coinUpgrades.barReverberation.purchaseLevels(1,e)),N("buy-coin-bar-vibration").addEventListener("click",e=>n.coinUpgrades.barVibration.purchaseLevels(1,e)),N("buy-coin-bar-agitation").addEventListener("click",e=>n.coinUpgrades.barAgitation.purchaseLevels(1,e)),N("buy-coin-bar-adoption").addEventListener("click",e=>n.coinUpgrades.barAdoption.purchaseLevels(1,e)),N("buy-coin-bar-empowerment").addEventListener("click",e=>n.coinUpgrades.barEmpowerment.purchaseLevels(1,e)),N("buy-coin-bar-reinforcement").addEventListener("click",e=>n.coinUpgrades.barReinforcement.purchaseLevels(1,e)),N("buy-reset").addEventListener("click",()=>Ne("Refresh",n)),N("reset-game").addEventListener("click",()=>void Lr()),N("talentCriticalChanceSacrifice").addEventListener("click",()=>void n.talents.barCriticalChance.sacrificeFragments()),N("talentProgressSpeedSacrifice").addEventListener("click",()=>void n.talents.barSpeed.sacrificeFragments()),N("talentCoinGainSacrifice").addEventListener("click",()=>void n.talents.coinGain.sacrificeFragments())};window.addEventListener("load",async()=>{var n,e;if(xr(M),await Pt(),Be(M),typeof((n=navigator.storage)==null?void 0:n.persist)=="function"&&typeof((e=navigator.storage)==null?void 0:e.persisted)=="function"){let o=await navigator.storage.persisted();o?console.log(`Storage is persistent! (persistent = ${o})`):await navigator.storage.persist()&&Z("Data on this page is now persistent! If you do not know what this means, you can safely ignore it.")}});document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(M.coins.updateHTML(),M.coinUpgrades.barMomentum.updateHTML(),M.coinUpgrades.barSpeed.updateHTML(),M.coinUpgrades.barReverberation.updateHTML(),M.coinUpgrades.barVibration.updateHTML(),M.coinUpgrades.barAgitation.updateHTML(),M.barFragments.updateHTML(),M.talents.barCriticalChance.updateHTML("Initialize"),M.talents.barSpeed.updateHTML("Initialize"),x("coinWorth",{textContent:`Worth ${g(se(M))} coins`}))});})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
