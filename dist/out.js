(()=>{var ln=Object.create;var De=Object.defineProperty,dn=Object.defineProperties,mn=Object.getOwnPropertyDescriptor,pn=Object.getOwnPropertyDescriptors,hn=Object.getOwnPropertyNames,Ht=Object.getOwnPropertySymbols,vn=Object.getPrototypeOf,Ft=Object.prototype.hasOwnProperty,bn=Object.prototype.propertyIsEnumerable;var Ot=(n,r,s)=>r in n?De(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,Xt=(n,r)=>{for(var s in r||(r={}))Ft.call(r,s)&&Ot(n,s,r[s]);if(Ht)for(var s of Ht(r))bn.call(r,s)&&Ot(n,s,r[s]);return n},$t=(n,r)=>dn(n,pn(r)),gn=n=>De(n,"__esModule",{value:!0});var ye=(n=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(n,{get:(r,s)=>(typeof require!="undefined"?require:r)[s]}):n)(function(n){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var yn=(n,r)=>()=>(r||n((r={exports:{}}).exports,r),r.exports);var En=(n,r,s,u)=>{if(r&&typeof r=="object"||typeof r=="function")for(let p of hn(r))!Ft.call(n,p)&&(s||p!=="default")&&De(n,p,{get:()=>r[p],enumerable:!(u=mn(r,p))||u.enumerable});return n},Ln=(n,r)=>En(gn(De(n!=null?ln(vn(n)):{},"default",!r&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var Yt=yn((Gt,rt)=>{(function(n){if(typeof Gt=="object"&&typeof rt<"u")rt.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var r;typeof window<"u"?r=window:typeof global<"u"?r=global:typeof self<"u"?r=self:r=this,r.localforage=n()}})(function(){var n,r,s;return function u(p,E,y){function M(N,G){if(!E[N]){if(!p[N]){var b=typeof ye=="function"&&ye;if(!G&&b)return b(N,!0);if(x)return x(N,!0);var w=new Error("Cannot find module '"+N+"'");throw w.code="MODULE_NOT_FOUND",w}var O=E[N]={exports:{}};p[N][0].call(O.exports,function(X){var q=p[N][1][X];return M(q||X)},O,O.exports,u,p,E,y)}return E[N].exports}for(var x=typeof ye=="function"&&ye,A=0;A<y.length;A++)M(y[A]);return M}({1:[function(u,p,E){(function(y){"use strict";var M=y.MutationObserver||y.WebKitMutationObserver,x;if(M){var A=0,N=new M(X),G=y.document.createTextNode("");N.observe(G,{characterData:!0}),x=function(){G.data=A=++A%2}}else if(!y.setImmediate&&typeof y.MessageChannel<"u"){var b=new y.MessageChannel;b.port1.onmessage=X,x=function(){b.port2.postMessage(0)}}else"document"in y&&"onreadystatechange"in y.document.createElement("script")?x=function(){var $=y.document.createElement("script");$.onreadystatechange=function(){X(),$.onreadystatechange=null,$.parentNode.removeChild($),$=null},y.document.documentElement.appendChild($)}:x=function(){setTimeout(X,0)};var w,O=[];function X(){w=!0;for(var $,j,W=O.length;W;){for(j=O,O=[],$=-1;++$<W;)j[$]();W=O.length}w=!1}p.exports=q;function q($){O.push($)===1&&!w&&x()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(u,p,E){"use strict";var y=u(1);function M(){}var x={},A=["REJECTED"],N=["FULFILLED"],G=["PENDING"];p.exports=b;function b(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=G,this.queue=[],this.outcome=void 0,v!==M&&q(this,v)}b.prototype.catch=function(v){return this.then(null,v)},b.prototype.then=function(v,_){if(typeof v!="function"&&this.state===N||typeof _!="function"&&this.state===A)return this;var C=new this.constructor(M);if(this.state!==G){var B=this.state===N?v:_;O(C,B,this.outcome)}else this.queue.push(new w(C,v,_));return C};function w(v,_,C){this.promise=v,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(v){x.resolve(this.promise,v)},w.prototype.otherCallFulfilled=function(v){O(this.promise,this.onFulfilled,v)},w.prototype.callRejected=function(v){x.reject(this.promise,v)},w.prototype.otherCallRejected=function(v){O(this.promise,this.onRejected,v)};function O(v,_,C){y(function(){var B;try{B=_(C)}catch(z){return x.reject(v,z)}B===v?x.reject(v,new TypeError("Cannot resolve promise with itself")):x.resolve(v,B)})}x.resolve=function(v,_){var C=$(X,_);if(C.status==="error")return x.reject(v,C.value);var B=C.value;if(B)q(v,B);else{v.state=N,v.outcome=_;for(var z=-1,Y=v.queue.length;++z<Y;)v.queue[z].callFulfilled(_)}return v},x.reject=function(v,_){v.state=A,v.outcome=_;for(var C=-1,B=v.queue.length;++C<B;)v.queue[C].callRejected(_);return v};function X(v){var _=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof _=="function")return function(){_.apply(v,arguments)}}function q(v,_){var C=!1;function B(Q){C||(C=!0,x.reject(v,Q))}function z(Q){C||(C=!0,x.resolve(v,Q))}function Y(){_(z,B)}var K=$(Y);K.status==="error"&&B(K.value)}function $(v,_){var C={};try{C.value=v(_),C.status="success"}catch(B){C.status="error",C.value=B}return C}b.resolve=j;function j(v){return v instanceof this?v:x.resolve(new this(M),v)}b.reject=W;function W(v){var _=new this(M);return x.reject(_,v)}b.all=We;function We(v){var _=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=v.length,B=!1;if(!C)return this.resolve([]);for(var z=new Array(C),Y=0,K=-1,Q=new this(M);++K<C;)ee(v[K],K);return Q;function ee(ve,Be){_.resolve(ve).then(ze,function(ce){B||(B=!0,x.reject(Q,ce))});function ze(ce){z[Be]=ce,++Y===C&&!B&&(B=!0,x.resolve(Q,z))}}}b.race=ie;function ie(v){var _=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=v.length,B=!1;if(!C)return this.resolve([]);for(var z=-1,Y=new this(M);++z<C;)K(v[z]);return Y;function K(Q){_.resolve(Q).then(function(ee){B||(B=!0,x.resolve(Y,ee))},function(ee){B||(B=!0,x.reject(Y,ee))})}}},{"1":1}],3:[function(u,p,E){(function(y){"use strict";typeof y.Promise!="function"&&(y.Promise=u(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(u,p,E){"use strict";var y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function M(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function x(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(e){return}}var A=x();function N(){try{if(!A||!A.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),o=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||o)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(t){return!1}}function G(e,o){e=e||[],o=o||{};try{return new Blob(e,o)}catch(a){if(a.name!=="TypeError")throw a;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,i=new t,c=0;c<e.length;c+=1)i.append(e[c]);return i.getBlob(o.type)}}typeof Promise>"u"&&u(3);var b=Promise;function w(e,o){o&&e.then(function(t){o(null,t)},function(t){o(t)})}function O(e,o,t){typeof o=="function"&&e.then(o),typeof t=="function"&&e.catch(t)}function X(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var $="local-forage-detect-blob-support",j=void 0,W={},We=Object.prototype.toString,ie="readonly",v="readwrite";function _(e){for(var o=e.length,t=new ArrayBuffer(o),i=new Uint8Array(t),c=0;c<o;c++)i[c]=e.charCodeAt(c);return t}function C(e){return new b(function(o){var t=e.transaction($,v),i=G([""]);t.objectStore($).put(i,"key"),t.onabort=function(c){c.preventDefault(),c.stopPropagation(),o(!1)},t.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);o(a||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}function B(e){return typeof j=="boolean"?b.resolve(j):C(e).then(function(o){return j=o,j})}function z(e){var o=W[e.name],t={};t.promise=new b(function(i,c){t.resolve=i,t.reject=c}),o.deferredOperations.push(t),o.dbReady?o.dbReady=o.dbReady.then(function(){return t.promise}):o.dbReady=t.promise}function Y(e){var o=W[e.name],t=o.deferredOperations.pop();if(t)return t.resolve(),t.promise}function K(e,o){var t=W[e.name],i=t.deferredOperations.pop();if(i)return i.reject(o),i.promise}function Q(e,o){return new b(function(t,i){if(W[e.name]=W[e.name]||gt(),e.db)if(o)z(e),e.db.close();else return t(e.db);var c=[e.name];o&&c.push(e.version);var a=A.open.apply(A,c);o&&(a.onupgradeneeded=function(f){var l=a.result;try{l.createObjectStore(e.storeName),f.oldVersion<=1&&l.createObjectStore($)}catch(d){if(d.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+f.oldVersion+" to version "+f.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw d}}),a.onerror=function(f){f.preventDefault(),i(a.error)},a.onsuccess=function(){var f=a.result;f.onversionchange=function(l){l.target.close()},t(f),Y(e)}})}function ee(e){return Q(e,!1)}function ve(e){return Q(e,!0)}function Be(e,o){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,c=e.version>e.db.version;if(i&&(e.version!==o&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),c||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function ze(e){return new b(function(o,t){var i=new FileReader;i.onerror=t,i.onloadend=function(c){var a=btoa(c.target.result||"");o({__local_forage_encoded_blob:!0,data:a,type:e.type})},i.readAsBinaryString(e)})}function ce(e){var o=_(atob(e.data));return G([o],{type:e.type})}function bt(e){return e&&e.__local_forage_encoded_blob}function lr(e){var o=this,t=o._initReady().then(function(){var i=W[o._dbInfo.name];if(i&&i.dbReady)return i.dbReady});return O(t,e,e),t}function dr(e){z(e);for(var o=W[e.name],t=o.forages,i=0;i<t.length;i++){var c=t[i];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return e.db=null,ee(e).then(function(a){return e.db=a,Be(e)?ve(e):a}).then(function(a){e.db=o.db=a;for(var f=0;f<t.length;f++)t[f]._dbInfo.db=a}).catch(function(a){throw K(e,a),a})}function te(e,o,t,i){i===void 0&&(i=1);try{var c=e.db.transaction(e.storeName,o);t(null,c)}catch(a){if(i>0&&(!e.db||a.name==="InvalidStateError"||a.name==="NotFoundError"))return b.resolve().then(function(){if(!e.db||a.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),ve(e)}).then(function(){return dr(e).then(function(){te(e,o,t,i-1)})}).catch(t);t(a)}}function gt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function mr(e){var o=this,t={db:null};if(e)for(var i in e)t[i]=e[i];var c=W[t.name];c||(c=gt(),W[t.name]=c),c.forages.push(o),o._initReady||(o._initReady=o.ready,o.ready=lr);var a=[];function f(){return b.resolve()}for(var l=0;l<c.forages.length;l++){var d=c.forages[l];d!==o&&a.push(d._initReady().catch(f))}var m=c.forages.slice(0);return b.all(a).then(function(){return t.db=c.db,ee(t)}).then(function(h){return t.db=h,Be(t,o._defaultConfig.version)?ve(t):h}).then(function(h){t.db=c.db=h,o._dbInfo=t;for(var g=0;g<m.length;g++){var P=m[g];P!==o&&(P._dbInfo.db=t.db,P._dbInfo.version=t.version)}})}function pr(e,o){var t=this;e=X(e);var i=new b(function(c,a){t.ready().then(function(){te(t._dbInfo,ie,function(f,l){if(f)return a(f);try{var d=l.objectStore(t._dbInfo.storeName),m=d.get(e);m.onsuccess=function(){var h=m.result;h===void 0&&(h=null),bt(h)&&(h=ce(h)),c(h)},m.onerror=function(){a(m.error)}}catch(h){a(h)}})}).catch(a)});return w(i,o),i}function hr(e,o){var t=this,i=new b(function(c,a){t.ready().then(function(){te(t._dbInfo,ie,function(f,l){if(f)return a(f);try{var d=l.objectStore(t._dbInfo.storeName),m=d.openCursor(),h=1;m.onsuccess=function(){var g=m.result;if(g){var P=g.value;bt(P)&&(P=ce(P));var I=e(P,g.key,h++);I!==void 0?c(I):g.continue()}else c()},m.onerror=function(){a(m.error)}}catch(g){a(g)}})}).catch(a)});return w(i,o),i}function vr(e,o,t){var i=this;e=X(e);var c=new b(function(a,f){var l;i.ready().then(function(){return l=i._dbInfo,We.call(o)==="[object Blob]"?B(l.db).then(function(d){return d?o:ze(o)}):o}).then(function(d){te(i._dbInfo,v,function(m,h){if(m)return f(m);try{var g=h.objectStore(i._dbInfo.storeName);d===null&&(d=void 0);var P=g.put(d,e);h.oncomplete=function(){d===void 0&&(d=null),a(d)},h.onabort=h.onerror=function(){var I=P.error?P.error:P.transaction.error;f(I)}}catch(I){f(I)}})}).catch(f)});return w(c,t),c}function br(e,o){var t=this;e=X(e);var i=new b(function(c,a){t.ready().then(function(){te(t._dbInfo,v,function(f,l){if(f)return a(f);try{var d=l.objectStore(t._dbInfo.storeName),m=d.delete(e);l.oncomplete=function(){c()},l.onerror=function(){a(m.error)},l.onabort=function(){var h=m.error?m.error:m.transaction.error;a(h)}}catch(h){a(h)}})}).catch(a)});return w(i,o),i}function gr(e){var o=this,t=new b(function(i,c){o.ready().then(function(){te(o._dbInfo,v,function(a,f){if(a)return c(a);try{var l=f.objectStore(o._dbInfo.storeName),d=l.clear();f.oncomplete=function(){i()},f.onabort=f.onerror=function(){var m=d.error?d.error:d.transaction.error;c(m)}}catch(m){c(m)}})}).catch(c)});return w(t,e),t}function yr(e){var o=this,t=new b(function(i,c){o.ready().then(function(){te(o._dbInfo,ie,function(a,f){if(a)return c(a);try{var l=f.objectStore(o._dbInfo.storeName),d=l.count();d.onsuccess=function(){i(d.result)},d.onerror=function(){c(d.error)}}catch(m){c(m)}})}).catch(c)});return w(t,e),t}function Er(e,o){var t=this,i=new b(function(c,a){if(e<0){c(null);return}t.ready().then(function(){te(t._dbInfo,ie,function(f,l){if(f)return a(f);try{var d=l.objectStore(t._dbInfo.storeName),m=!1,h=d.openKeyCursor();h.onsuccess=function(){var g=h.result;if(!g){c(null);return}e===0||m?c(g.key):(m=!0,g.advance(e))},h.onerror=function(){a(h.error)}}catch(g){a(g)}})}).catch(a)});return w(i,o),i}function Lr(e){var o=this,t=new b(function(i,c){o.ready().then(function(){te(o._dbInfo,ie,function(a,f){if(a)return c(a);try{var l=f.objectStore(o._dbInfo.storeName),d=l.openKeyCursor(),m=[];d.onsuccess=function(){var h=d.result;if(!h){i(m);return}m.push(h.key),h.continue()},d.onerror=function(){c(d.error)}}catch(h){c(h)}})}).catch(c)});return w(t,e),t}function xr(e,o){o=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i=this,c;if(!e.name)c=b.reject("Invalid arguments");else{var a=e.name===t.name&&i._dbInfo.db,f=a?b.resolve(i._dbInfo.db):ee(e).then(function(l){var d=W[e.name],m=d.forages;d.db=l;for(var h=0;h<m.length;h++)m[h]._dbInfo.db=l;return l});e.storeName?c=f.then(function(l){if(!!l.objectStoreNames.contains(e.storeName)){var d=l.version+1;z(e);var m=W[e.name],h=m.forages;l.close();for(var g=0;g<h.length;g++){var P=h[g];P._dbInfo.db=null,P._dbInfo.version=d}var I=new b(function(R,F){var k=A.open(e.name,d);k.onerror=function(J){var ge=k.result;ge.close(),F(J)},k.onupgradeneeded=function(){var J=k.result;J.deleteObjectStore(e.storeName)},k.onsuccess=function(){var J=k.result;J.close(),R(J)}});return I.then(function(R){m.db=R;for(var F=0;F<h.length;F++){var k=h[F];k._dbInfo.db=R,Y(k._dbInfo)}}).catch(function(R){throw(K(e,R)||b.resolve()).catch(function(){}),R})}}):c=f.then(function(l){z(e);var d=W[e.name],m=d.forages;l.close();for(var h=0;h<m.length;h++){var g=m[h];g._dbInfo.db=null}var P=new b(function(I,R){var F=A.deleteDatabase(e.name);F.onerror=function(){var k=F.result;k&&k.close(),R(F.error)},F.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},F.onsuccess=function(){var k=F.result;k&&k.close(),I(k)}});return P.then(function(I){d.db=I;for(var R=0;R<m.length;R++){var F=m[R];Y(F._dbInfo)}}).catch(function(I){throw(K(e,I)||b.resolve()).catch(function(){}),I})})}return w(c,o),c}var Tr={_driver:"asyncStorage",_initStorage:mr,_support:N(),iterate:hr,getItem:pr,setItem:vr,removeItem:br,clear:gr,length:yr,key:Er,keys:Lr,dropInstance:xr};function wr(){return typeof openDatabase=="function"}var ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pr="~~local_forage_type~",yt=/^~~local_forage_type~([^~]+)~/,Ae="__lfsc__:",Ve=Ae.length,Ge="arbf",Ye="blob",Et="si08",Lt="ui08",xt="uic8",Tt="si16",wt="si32",Pt="ur16",St="ui32",Ct="fl32",Mt="fl64",_t=Ve+Ge.length,It=Object.prototype.toString;function Rt(e){var o=e.length*.75,t=e.length,i,c=0,a,f,l,d;e[e.length-1]==="="&&(o--,e[e.length-2]==="="&&o--);var m=new ArrayBuffer(o),h=new Uint8Array(m);for(i=0;i<t;i+=4)a=ne.indexOf(e[i]),f=ne.indexOf(e[i+1]),l=ne.indexOf(e[i+2]),d=ne.indexOf(e[i+3]),h[c++]=a<<2|f>>4,h[c++]=(f&15)<<4|l>>2,h[c++]=(l&3)<<6|d&63;return m}function Ke(e){var o=new Uint8Array(e),t="",i;for(i=0;i<o.length;i+=3)t+=ne[o[i]>>2],t+=ne[(o[i]&3)<<4|o[i+1]>>4],t+=ne[(o[i+1]&15)<<2|o[i+2]>>6],t+=ne[o[i+2]&63];return o.length%3===2?t=t.substring(0,t.length-1)+"=":o.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function Sr(e,o){var t="";if(e&&(t=It.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&It.call(e.buffer)==="[object ArrayBuffer]")){var i,c=Ae;e instanceof ArrayBuffer?(i=e,c+=Ge):(i=e.buffer,t==="[object Int8Array]"?c+=Et:t==="[object Uint8Array]"?c+=Lt:t==="[object Uint8ClampedArray]"?c+=xt:t==="[object Int16Array]"?c+=Tt:t==="[object Uint16Array]"?c+=Pt:t==="[object Int32Array]"?c+=wt:t==="[object Uint32Array]"?c+=St:t==="[object Float32Array]"?c+=Ct:t==="[object Float64Array]"?c+=Mt:o(new Error("Failed to get type for BinaryArray"))),o(c+Ke(i))}else if(t==="[object Blob]"){var a=new FileReader;a.onload=function(){var f=Pr+e.type+"~"+Ke(this.result);o(Ae+Ye+f)},a.readAsArrayBuffer(e)}else try{o(JSON.stringify(e))}catch(f){console.error("Couldn't convert value into a JSON string: ",e),o(null,f)}}function Cr(e){if(e.substring(0,Ve)!==Ae)return JSON.parse(e);var o=e.substring(_t),t=e.substring(Ve,_t),i;if(t===Ye&&yt.test(o)){var c=o.match(yt);i=c[1],o=o.substring(c[0].length)}var a=Rt(o);switch(t){case Ge:return a;case Ye:return G([a],{type:i});case Et:return new Int8Array(a);case Lt:return new Uint8Array(a);case xt:return new Uint8ClampedArray(a);case Tt:return new Int16Array(a);case Pt:return new Uint16Array(a);case wt:return new Int32Array(a);case St:return new Uint32Array(a);case Ct:return new Float32Array(a);case Mt:return new Float64Array(a);default:throw new Error("Unkown type: "+t)}}var Qe={serialize:Sr,deserialize:Cr,stringToBuffer:Rt,bufferToString:Ke};function Bt(e,o,t,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,i)}function Mr(e){var o=this,t={db:null};if(e)for(var i in e)t[i]=typeof e[i]!="string"?e[i].toString():e[i];var c=new b(function(a,f){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(l){return f(l)}t.db.transaction(function(l){Bt(l,t,function(){o._dbInfo=t,a()},function(d,m){f(m)})},f)});return t.serializer=Qe,c}function oe(e,o,t,i,c,a){e.executeSql(t,i,c,function(f,l){l.code===l.SYNTAX_ERR?f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[o.storeName],function(d,m){m.rows.length?a(d,l):Bt(d,o,function(){d.executeSql(t,i,c,a)},a)},a):a(f,l)},a)}function _r(e,o){var t=this;e=X(e);var i=new b(function(c,a){t.ready().then(function(){var f=t._dbInfo;f.db.transaction(function(l){oe(l,f,"SELECT * FROM "+f.storeName+" WHERE key = ? LIMIT 1",[e],function(d,m){var h=m.rows.length?m.rows.item(0).value:null;h&&(h=f.serializer.deserialize(h)),c(h)},function(d,m){a(m)})})}).catch(a)});return w(i,o),i}function Ir(e,o){var t=this,i=new b(function(c,a){t.ready().then(function(){var f=t._dbInfo;f.db.transaction(function(l){oe(l,f,"SELECT * FROM "+f.storeName,[],function(d,m){for(var h=m.rows,g=h.length,P=0;P<g;P++){var I=h.item(P),R=I.value;if(R&&(R=f.serializer.deserialize(R)),R=e(R,I.key,P+1),R!==void 0){c(R);return}}c()},function(d,m){a(m)})})}).catch(a)});return w(i,o),i}function At(e,o,t,i){var c=this;e=X(e);var a=new b(function(f,l){c.ready().then(function(){o===void 0&&(o=null);var d=o,m=c._dbInfo;m.serializer.serialize(o,function(h,g){g?l(g):m.db.transaction(function(P){oe(P,m,"INSERT OR REPLACE INTO "+m.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){f(d)},function(I,R){l(R)})},function(P){if(P.code===P.QUOTA_ERR){if(i>0){f(At.apply(c,[e,d,t,i-1]));return}l(P)}})})}).catch(l)});return w(a,t),a}function Rr(e,o,t){return At.apply(this,[e,o,t,1])}function Br(e,o){var t=this;e=X(e);var i=new b(function(c,a){t.ready().then(function(){var f=t._dbInfo;f.db.transaction(function(l){oe(l,f,"DELETE FROM "+f.storeName+" WHERE key = ?",[e],function(){c()},function(d,m){a(m)})})}).catch(a)});return w(i,o),i}function Ar(e){var o=this,t=new b(function(i,c){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(f){oe(f,a,"DELETE FROM "+a.storeName,[],function(){i()},function(l,d){c(d)})})}).catch(c)});return w(t,e),t}function Nr(e){var o=this,t=new b(function(i,c){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(f){oe(f,a,"SELECT COUNT(key) as c FROM "+a.storeName,[],function(l,d){var m=d.rows.item(0).c;i(m)},function(l,d){c(d)})})}).catch(c)});return w(t,e),t}function Dr(e,o){var t=this,i=new b(function(c,a){t.ready().then(function(){var f=t._dbInfo;f.db.transaction(function(l){oe(l,f,"SELECT key FROM "+f.storeName+" WHERE id = ? LIMIT 1",[e+1],function(d,m){var h=m.rows.length?m.rows.item(0).key:null;c(h)},function(d,m){a(m)})})}).catch(a)});return w(i,o),i}function Ur(e){var o=this,t=new b(function(i,c){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(f){oe(f,a,"SELECT key FROM "+a.storeName,[],function(l,d){for(var m=[],h=0;h<d.rows.length;h++)m.push(d.rows.item(h).key);i(m)},function(l,d){c(d)})})}).catch(c)});return w(t,e),t}function kr(e){return new b(function(o,t){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,a){for(var f=[],l=0;l<a.rows.length;l++)f.push(a.rows.item(l).name);o({db:e,storeNames:f})},function(c,a){t(a)})},function(i){t(i)})})}function Hr(e,o){o=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i=this,c;return e.name?c=new b(function(a){var f;e.name===t.name?f=i._dbInfo.db:f=openDatabase(e.name,"","",0),e.storeName?a({db:f,storeNames:[e.storeName]}):a(kr(f))}).then(function(a){return new b(function(f,l){a.db.transaction(function(d){function m(I){return new b(function(R,F){d.executeSql("DROP TABLE IF EXISTS "+I,[],function(){R()},function(k,J){F(J)})})}for(var h=[],g=0,P=a.storeNames.length;g<P;g++)h.push(m(a.storeNames[g]));b.all(h).then(function(){f()}).catch(function(I){l(I)})},function(d){l(d)})})}):c=b.reject("Invalid arguments"),w(c,o),c}var Or={_driver:"webSQLStorage",_initStorage:Mr,_support:wr(),iterate:Ir,getItem:_r,setItem:Rr,removeItem:Br,clear:Ar,length:Nr,key:Dr,keys:Ur,dropInstance:Hr};function Fr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Nt(e,o){var t=e.name+"/";return e.storeName!==o.storeName&&(t+=e.storeName+"/"),t}function Xr(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(o){return!0}}function $r(){return!Xr()||localStorage.length>0}function Wr(e){var o=this,t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=Nt(e,o._defaultConfig),$r()?(o._dbInfo=t,t.serializer=Qe,b.resolve()):b.reject()}function zr(e){var o=this,t=o.ready().then(function(){for(var i=o._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var a=localStorage.key(c);a.indexOf(i)===0&&localStorage.removeItem(a)}});return w(t,e),t}function Vr(e,o){var t=this;e=X(e);var i=t.ready().then(function(){var c=t._dbInfo,a=localStorage.getItem(c.keyPrefix+e);return a&&(a=c.serializer.deserialize(a)),a});return w(i,o),i}function Gr(e,o){var t=this,i=t.ready().then(function(){for(var c=t._dbInfo,a=c.keyPrefix,f=a.length,l=localStorage.length,d=1,m=0;m<l;m++){var h=localStorage.key(m);if(h.indexOf(a)===0){var g=localStorage.getItem(h);if(g&&(g=c.serializer.deserialize(g)),g=e(g,h.substring(f),d++),g!==void 0)return g}}});return w(i,o),i}function Yr(e,o){var t=this,i=t.ready().then(function(){var c=t._dbInfo,a;try{a=localStorage.key(e)}catch(f){a=null}return a&&(a=a.substring(c.keyPrefix.length)),a});return w(i,o),i}function Kr(e){var o=this,t=o.ready().then(function(){for(var i=o._dbInfo,c=localStorage.length,a=[],f=0;f<c;f++){var l=localStorage.key(f);l.indexOf(i.keyPrefix)===0&&a.push(l.substring(i.keyPrefix.length))}return a});return w(t,e),t}function Qr(e){var o=this,t=o.keys().then(function(i){return i.length});return w(t,e),t}function Jr(e,o){var t=this;e=X(e);var i=t.ready().then(function(){var c=t._dbInfo;localStorage.removeItem(c.keyPrefix+e)});return w(i,o),i}function qr(e,o,t){var i=this;e=X(e);var c=i.ready().then(function(){o===void 0&&(o=null);var a=o;return new b(function(f,l){var d=i._dbInfo;d.serializer.serialize(o,function(m,h){if(h)l(h);else try{localStorage.setItem(d.keyPrefix+e,m),f(a)}catch(g){(g.name==="QuotaExceededError"||g.name==="NS_ERROR_DOM_QUOTA_REACHED")&&l(g),l(g)}})})});return w(c,t),c}function Zr(e,o){if(o=q.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var i=this,c;return e.name?c=new b(function(a){e.storeName?a(Nt(e,i._defaultConfig)):a(e.name+"/")}).then(function(a){for(var f=localStorage.length-1;f>=0;f--){var l=localStorage.key(f);l.indexOf(a)===0&&localStorage.removeItem(l)}}):c=b.reject("Invalid arguments"),w(c,o),c}var jr={_driver:"localStorageWrapper",_initStorage:Wr,_support:Fr(),iterate:Gr,getItem:Vr,setItem:qr,removeItem:Jr,clear:zr,length:Qr,key:Yr,keys:Kr,dropInstance:Zr},en=function(o,t){return o===t||typeof o=="number"&&typeof t=="number"&&isNaN(o)&&isNaN(t)},tn=function(o,t){for(var i=o.length,c=0;c<i;){if(en(o[c],t))return!0;c++}return!1},Dt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},be={},Ut={},fe={INDEXEDDB:Tr,WEBSQL:Or,LOCALSTORAGE:jr},rn=[fe.INDEXEDDB._driver,fe.WEBSQL._driver,fe.LOCALSTORAGE._driver],Ne=["dropInstance"],Je=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ne),nn={description:"",driver:rn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function on(e,o){e[o]=function(){var t=arguments;return e.ready().then(function(){return e[o].apply(e,t)})}}function qe(){for(var e=1;e<arguments.length;e++){var o=arguments[e];if(o)for(var t in o)o.hasOwnProperty(t)&&(Dt(o[t])?arguments[0][t]=o[t].slice():arguments[0][t]=o[t])}return arguments[0]}var an=function(){function e(o){M(this,e);for(var t in fe)if(fe.hasOwnProperty(t)){var i=fe[t],c=i._driver;this[t]=c,be[c]||this.defineDriver(i)}this._defaultConfig=qe({},nn),this._config=qe({},this._defaultConfig,o),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":y(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in t){if(i==="storeName"&&(t[i]=t[i].replace(/\W/g,"_")),i==="version"&&typeof t[i]!="number")return new Error("Database version must be a number.");this._config[i]=t[i]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,i,c){var a=new b(function(f,l){try{var d=t._driver,m=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){l(m);return}for(var h=Je.concat("_initStorage"),g=0,P=h.length;g<P;g++){var I=h[g],R=!tn(Ne,I);if((R||t[I])&&typeof t[I]!="function"){l(m);return}}var F=function(){for(var ge=function(fn){return function(){var un=new Error("Method "+fn+" is not implemented by the current driver"),kt=b.reject(un);return w(kt,arguments[arguments.length-1]),kt}},Ze=0,cn=Ne.length;Ze<cn;Ze++){var je=Ne[Ze];t[je]||(t[je]=ge(je))}};F();var k=function(ge){be[d]&&console.info("Redefining LocalForage driver: "+d),be[d]=t,Ut[d]=ge,f()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(k,l):k(!!t._support):k(!0)}catch(J){l(J)}});return O(a,i,c),a},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,i,c){var a=be[t]?b.resolve(be[t]):b.reject(new Error("Driver not found."));return O(a,i,c),a},e.prototype.getSerializer=function(t){var i=b.resolve(Qe);return O(i,t),i},e.prototype.ready=function(t){var i=this,c=i._driverSet.then(function(){return i._ready===null&&(i._ready=i._initDriver()),i._ready});return O(c,t,t),c},e.prototype.setDriver=function(t,i,c){var a=this;Dt(t)||(t=[t]);var f=this._getSupportedDrivers(t);function l(){a._config.driver=a.driver()}function d(g){return a._extend(g),l(),a._ready=a._initStorage(a._config),a._ready}function m(g){return function(){var P=0;function I(){for(;P<g.length;){var R=g[P];return P++,a._dbInfo=null,a._ready=null,a.getDriver(R).then(d).catch(I)}l();var F=new Error("No available storage method found.");return a._driverSet=b.reject(F),a._driverSet}return I()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=h.then(function(){var g=f[0];return a._dbInfo=null,a._ready=null,a.getDriver(g).then(function(P){a._driver=P._driver,l(),a._wrapLibraryMethodsWithReady(),a._initDriver=m(f)})}).catch(function(){l();var g=new Error("No available storage method found.");return a._driverSet=b.reject(g),a._driverSet}),O(this._driverSet,i,c),this._driverSet},e.prototype.supports=function(t){return!!Ut[t]},e.prototype._extend=function(t){qe(this,t)},e.prototype._getSupportedDrivers=function(t){for(var i=[],c=0,a=t.length;c<a;c++){var f=t[c];this.supports(f)&&i.push(f)}return i},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,i=Je.length;t<i;t++)on(this,Je[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),sn=new an;p.exports=sn},{"3":3}]},{},[4])(4)})});var tt=n=>{let r=typeof n;return n!==null&&(r==="object"||r==="function")},et=new Set(["__proto__","prototype","constructor"]),xn=new Set("0123456789");function Wt(n){let r=[],s="",u="start",p=!1;for(let E of n)switch(E){case"\\":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");p&&(s+=E),u="property",p=!p;break;case".":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="property";break}if(p){p=!1,s+=E;break}if(et.has(s))return[];r.push(s),s="",u="property";break;case"[":if(u==="index")throw new Error("Invalid character in an index");if(u==="indexEnd"){u="index";break}if(p){p=!1,s+=E;break}if(u==="property"){if(et.has(s))return[];r.push(s),s=""}u="index";break;case"]":if(u==="index"){r.push(Number.parseInt(s,10)),s="",u="indexEnd";break}if(u==="indexEnd")throw new Error("Invalid character after an index");default:if(u==="index"&&!xn.has(E))throw new Error("Invalid character in an index");if(u==="indexEnd")throw new Error("Invalid character after an index");u==="start"&&(u="property"),p&&(p=!1,s+="\\"),s+=E}switch(p&&(s+="\\"),u){case"property":{if(et.has(s))return[];r.push(s);break}case"index":throw new Error("Index was not closed");case"start":{r.push("");break}}return r}function zt(n,r){if(typeof r!="number"&&Array.isArray(n)){let s=Number.parseInt(r,10);return Number.isInteger(s)&&n[s]===n[r]}return!1}function Tn(n,r){if(zt(n,r))throw new Error("Cannot use string index")}function H(n,r,s){if(!tt(n)||typeof r!="string")return s===void 0?n:s;let u=Wt(r);if(u.length===0)return s;for(let p=0;p<u.length;p++){let E=u[p];if(zt(n,E)?n=p===u.length-1?void 0:null:n=n[E],n==null){if(p!==u.length-1)return s;break}}return n===void 0?s:n}function Vt(n,r,s){if(!tt(n)||typeof r!="string")return n;let u=n,p=Wt(r);for(let E=0;E<p.length;E++){let y=p[E];Tn(n,y),E===p.length-1?n[y]=s:tt(n[y])||(n[y]=typeof p[E+1]=="number"?[]:{}),n=n[y]}return u}var he=Ln(Yt());var U=n=>document.getElementById(n),Kt=(n,r)=>{if(document.visibilityState==="hidden")return!1;let s=Object.entries(r);for(let[u,p]of s)n[u]=p;return!0},S=(n,r)=>document.visibilityState==="hidden"?!1:Kt(U(n),r),D=(n,r)=>document.visibilityState==="hidden"?!1:Kt(U(n).style,r);var re=(n,r)=>n.querySelector(r),wn=(n,r)=>{let s=U("confirmationBox"),u=U("confirmWrapper"),p=re(document,"#confirm"),E=re(document,"#transparentBG"),y=re(p,"#okConfirm"),M=re(p,"#cancelConfirm");s.style.display="block",u.style.display="block",E.style.display="block",re(p,"p").textContent=n,p.focus();let x=({target:N})=>{let G=N;return y.removeEventListener("click",x),M.removeEventListener("click",x),p.removeEventListener("keyup",A),s.style.display="none",u.style.display="none",E.style.display="none",r(G===y)},A=N=>N.key==="Enter"||N.key===" "?x({target:y}):N.key==="Escape"?x({target:M}):N.preventDefault();y.addEventListener("click",x),M.addEventListener("click",x),p.addEventListener("keyup",A)},Pn=(n,r)=>{let s=U("confirmationBox"),u=U("alertWrapper"),p=re(document,"#transparentBG"),E=re(document,"#alert"),y=re(E,"#okAlert");s.style.display="block",u.style.display="block",p.style.display="block",re(E,"p").textContent=n,E.focus();let M=()=>{y.removeEventListener("click",M),E.removeEventListener("keyup",x),s.style.display="none",u.style.display="none",p.style.display="none",r(void 0)},x=A=>(A.key==="Enter"||A.key===" ")&&M();y.addEventListener("click",M),E.addEventListener("keyup",x)};var Z=n=>new Promise(r=>Pn(n,r));var Ue=n=>new Promise(r=>wn(n,r));var T=(n,r=0)=>{if(n<0)return"-"+T(-n,r);if(n>=1e6){let A=Math.floor(Math.log10(n));return n/=Math.pow(10,A),T(n,2)+"e"+T(A)}let s=Math.floor(n),u=n-s,p=s.toLocaleString(),E=r>0&&n!==0,y=Math.pow(10,r)*u,M=1e-6;Math.ceil(y)-y<M&&(y=Math.ceil(y));let x=E?Math.floor(y).toString():"";if(x!==""){for(;x.length<r;)x="0"+x;x="."+x}return p+x};var Ee=class{constructor(r=0,s){this.amount=r;this.player=s;this.amount=r,this.updateHTML()}spend(r){this.amount>=r&&(this.amount-=r,this.updateHTML())}gain(r){this.amount+=r,this.updateHTML()}set(r){this.amount=r,this.updateHTML()}valueOf(){return{amount:this.amount}}};var ke=class extends Ee{updateHTML(){S("gold-amount",{textContent:T(this.amount)})}};var He=class extends Ee{updateHTML(){S("fragment-amount",{textContent:T(this.amount)}),S("fragment-bonus",{textContent:T(this.amount)}),S("fragment-gain",{textContent:T(this.getAmountOnRefresh())})}getAmountOnRefresh(){let r=this.player.barLevel,s=100*Math.pow(1.07,-5);return s*=Math.pow(1.07,r),s*=Math.pow(3,Math.floor(r/100)),s*=1+this.player.criticalHitsThisRefresh*this.player.coinUpgrades.barAgitation.upgradeEffect(),Math.floor(s)}unspentBonus(){return 1+1/100*this.amount}};var ue=n=>{D("mainTab",{display:"none"}),D("upgradeTab",{display:"none"}),D("talentsTab",{display:"none"}),n==="Main"?D("mainTab",{display:"block"}):n==="Upgrades"?D("upgradeTab",{display:"block"}):n==="Talents"&&D("talentsTab",{display:"block"})},Oe=n=>{D("progression",{backgroundColor:"gold"}),setTimeout(()=>{D("progression",{backgroundColor:le(n)})},250),S("refresh-crit-counter",{textContent:T(n.criticalHitsThisRefresh)}),n.barFragments.updateHTML()},Fe=n=>{D("progression",{backgroundColor:"cyan"}),setTimeout(()=>{D("progression",{backgroundColor:le(n)})},1e3),S("coinWorth",{textContent:`Worth ${T(ae(n))} coins`}),S("refresh-crit-counter",{textContent:T(n.criticalHitsThisRefresh)}),S("refresh-counter",{textContent:T(n.refreshCount)})};var Sn=10,Xe=0,nt=0,Le=n=>{let r=0;return r+=Sn*Math.pow(n.barLevel+1,2),r*=Math.min(1,(n.barLevel+20)/40),r*=Math.max(1,1+(n.barLevel-20)/10),n.barLevel>40&&(r*=Math.pow(2,1/10*(n.barLevel-40))),n.barLevel>100&&(r*=Math.pow(2,1/10*(n.barLevel-100))),n.barLevel>200&&(r*=Math.pow(2,1/10*(n.barLevel-200))),r},Cn=n=>{let r=0;return n.barLevel>=5&&(r=.1),n.barLevel>=10&&(r+=.9*(1-Math.pow(Math.E,-n.barLevel/200))),r>=.9999?1e4:1/(1-r)},Mn=n=>Cn(n)*(1-n.barEXP/n.barTNL),Qt=(n,r)=>{if(n==null)return;let s=1;s+=r.coinUpgrades.barSpeed.upgradeEffect(),s*=r.barFragments.unspentBonus(),s*=Math.pow(1+r.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,r.barEXP/r.barTNL))),s/=Mn(r),s*=r.talents.barSpeed.talentEffect();let u=Math.random(),p=r.coinUpgrades.barReverberation.upgradeEffect()+r.talents.barCriticalChance.talentEffect();u<p&&(s*=r.coinUpgrades.barVibration.upgradeEffect(),r.talents.barCriticalChance.gainEXP(n),r.criticalHits+=1,r.criticalHitsThisRefresh+=1,Oe(r));let E=s*n;r.barEXP+=E,Xe+=E,S("perSecCurr",{textContent:`+${T(Xe,2)} this sec`})},de=(n,r)=>Math.min(100,.1*Math.floor(1e3*n/r)),me=n=>{D("progression",{width:`${n}%`})},le=n=>{if(n.barLevel>=128)return"#FFFFFF";let r=(128+n.barLevel).toString(16).padStart(2,"0"),s=(2*n.barLevel).toString(16).padStart(2,"0"),u=(128+n.barLevel).toString(16).padStart(2,"0");return`#${r}${s}${u}`},Jt=n=>{n.coins.gain(ae(n)),n.barEXP-=n.barTNL,n.barLevel+=1,n.barLevel>n.highestBarLevel&&(n.highestBarLevel=n.barLevel);let r=le(n);D("progression",{backgroundColor:r}),n.barTNL=Le(n),n.barEXP/=10,n.barEXP=Math.min(n.barEXP,Math.floor(n.barTNL/10));let s=de(n.barEXP,n.barTNL);me(s),S("coinWorth",{textContent:`Worth ${T(ae(n))} coins`}),n.barFragments.updateHTML(),n.barLevel===20&&(n.talents.barCriticalChance.updateHTML("Level20"),n.talents.barSpeed.updateHTML("Level20"))},qt=n=>{S("level",{textContent:`Level: ${n.barLevel}`}),S("exp",{textContent:`EXP: ${T(n.barEXP)}/${T(n.barTNL)}`})},Zt=n=>{nt=Xe,Xe=0,S("perSecPrev",{textContent:`+${T(nt,2)} prev sec`}),n.talents.barCriticalChance.updateHTML("Time"),n.talents.barSpeed.gainEXP(nt)},ae=n=>{let r=0,s=1+n.barLevel;s>n.highestBarLevel&&(r+=3),s%5===0&&(r+=Math.floor(s/5)+3),s%10===0&&(r+=Math.floor(s/2)),s%50===0&&(r+=Math.floor(s/2)),s%100===0&&(r+=Math.floor(s));let u=U("coinWorth");return u.style.color=r>0?"gold":"grey",r};var xe=class{constructor(r,s,u){this.level=r;this.cost=s;this.player=u}};var pe=class extends xe{constructor(r,s,u){super(r,s,u);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(r,s){s.shiftKey&&(r=-1,r=Math.floor(this.player.coins.amount/this.cost)),this.maxLevel!==-1&&(r=Math.min(r,this.maxLevel-this.level)),this.cost*r<=this.player.coins.amount&&(this.player.coins.spend(this.cost*r),this.level+=r,this.updateHTML())}valueOf(){return{level:this.level,cost:this.cost,maxLevel:this.maxLevel}}},V={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4},Te=class extends pe{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){S("coin-bar-speed-effect",{textContent:`+${T(this.upgradeEffect(),2)} Progress Per Second`})}},we=class extends pe{constructor(r,s,u){super(r,s,u);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?.5:.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level)}updateHTML(){S("coin-bar-momentum-effect",{textContent:`Up to ${T(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel&&(S("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),D("coin-bar-momentum-name",{color:"orchid"}))}},Pe=class extends pe{constructor(r,s,u){super(r,s,u);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.1:.09*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+.002*Math.min(5,this.level)}updateHTML(){S("coin-bar-reverberation-effect",{textContent:`+${T(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel&&(S("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),D("coin-bar-reverberation-name",{color:"orchid"}))}},Se=class extends pe{constructor(r,s,u){super(r,s,u);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?200:20+170*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+Math.min(10,this.level)}updateHTML(){S("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${T(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel&&(S("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),D("coin-bar-vibration-name",{color:"orchid"}))}},Ce=class extends pe{constructor(r,s,u){super(r,s,u);this.maxLevel=10;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/5e3}updateHTML(){S("coin-bar-agitation-effect",{textContent:`+${T(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT`}),this.level===this.maxLevel&&(S("coin-bar-agitation-name",{textContent:"Bar Agitation [MAX LEVEL]"}),D("coin-bar-agitation-name",{color:"orchid"}))}};var jt="coinUpgrades.barSpeed",ot=(n,r)=>{var u,p;let s=(u=H(n,jt))!=null?u:H(r,jt);return new Te((p=s==null?void 0:s.level)!=null?p:0,V.barSpeed,r)};var er="coinUpgrades.barMomentum",at=(n,r)=>{var u,p;let s=(u=H(n,er))!=null?u:H(r,er);return new we((p=s==null?void 0:s.level)!=null?p:0,V.barMomentum,r)};var tr="coinUpgrades.barReverberation",it=(n,r)=>{var u,p;let s=(u=H(n,tr))!=null?u:H(r,tr);return new Pe((p=s==null?void 0:s.level)!=null?p:0,V.barReverberation,r)};var rr="coinUpgrades.barVibration",st=(n,r)=>{var u,p;let s=(u=H(n,rr))!=null?u:H(r,rr);return new Se((p=s==null?void 0:s.level)!=null?p:0,V.barVibration,r)};var nr="coinUpgrades.barAgitation",ct=(n,r)=>{var u,p;let s=(u=H(n,nr))!=null?u:H(r,nr);return new Ce((p=s==null?void 0:s.level)!=null?p:0,V.barAgitation,r)};var or=(n,r,s,u=1)=>Math.ceil(n*(Math.pow(s,u)-Math.pow(r,u)));var $e=(n,r)=>{if(n==="Refresh"&&r.barLevel>=5){if(r.refreshTime<Me)return void Z(`Currently, refreshes have a ${T(Me)} second cooldown. Sorry!`);r.barFragments.set(r.barFragments.getAmountOnRefresh()),r.barEXP=0,r.barLevel=0,r.barTNL=Le(r),me(de(r.barEXP,r.barTNL)),r.barFragments.updateHTML(),r.talents.barCriticalChance.convertToPerm(),r.talents.barCriticalChance.updateHTML("Initialize"),r.talents.barSpeed.convertToPerm(),r.talents.barSpeed.updateHTML("Initialize"),r.refreshCount+=1,r.refreshTime=0,r.criticalHitsThisRefresh=0,Oe(r),Fe(r)}else return void Z("You cannot refresh yet. Get to level 5 lol")};var ft=n=>n.barLevel>=20,ut=class extends xe{constructor(r,s,u,p,E,y){super(r,s,y);this.investedFragments=u,this.permLevel=p,this.currEXP=E,this.currTNL=this.calculateTNL()}calculateTNL(){return or(this.cost,this.level,this.level+1,2)}setEXP(r){this.currEXP=r,this.updateHTML("GainEXP")}gainEXP(r){if(!ft(this.player))return;let s=this.calculateEXPGain(r);this.currEXP+=s,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}levelUp(){this.level+=1,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("LevelUp")}computePermLevelGain(r){let s=0;return s+=Math.sqrt(r),s*=Math.min(4,Math.pow(this.player.refreshTime/300,2)),s=Math.min(r,s),Math.floor(s)}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}async sacrificeFragments(){if(this.player.barFragments.amount<1e3)return void Z("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(this.player.barFragments.amount<=this.investedFragments)return void Z(`This bar needs more fragments than you can invest. You need ${T(this.investedFragments)}.`);await Ue(`You will sacrifice ${T(this.player.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=this.player.barFragments.amount,this.player.refreshTime+=Me,$e("Refresh",this.player),this.player.barFragments.set(0))}updateHTML(r){if(this.idHTML!==void 0){if(r==="Initialize"||r==="GainEXP"||r==="LevelUp"||r==="PermLevelUp"){S(`talent${this.idHTML}EXP`,{textContent:`EXP: ${T(this.currEXP)}/${T(this.currTNL)}`});let s=`${this.getBarWidth()}%`;D(`talent${this.idHTML}Progression`,{width:s})}(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp")&&S(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${T(this.level)}`}),(r==="Initialize"||r==="PermLevelUp")&&S(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${T(this.permLevel)}`}),(r==="Initialize"||r==="Time"||r==="LevelUp")&&S(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${T(this.computePermLevelGain(this.level))}`}),(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp"||r==="Level20")&&S(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}valueOf(){return{level:this.level,cost:this.cost,investedFragments:this.investedFragments,permLevel:this.permLevel,currEXP:this.currEXP,idHTML:this.idHTML}}},se={talentCriticalChance:10,talentProgressSpeed:10},_e=class extends ut{constructor(r,s,u,p,E,y){super(r,s,u,p,E,y);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(r){let s=1;return s*=r*1e3/lt,s*=this.player.barLevel/10-1,s*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),s}talentEffect(){return ft(this.player)?.025*(1-Math.pow(Math.E,-this.level/2500))+.025*Math.min(250,this.level)/250+.025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.025*Math.min(500,this.level)/500:0}displayEffect(){return`+${T(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Ie=class extends ut{constructor(r,s,u,p,E,y){super(r,s,u,p,E,y);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(r){let s=Math.log10(1+r);return s*=this.player.barLevel/10-1,s*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),s}talentEffect(){return ft?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${T(100*(this.talentEffect()-1),2)}%`}};var ar="talents.barCriticalChance",dt=(n,r)=>{var u,p,E,y,M;let s=(u=H(n,ar))!=null?u:H(r,ar);return new _e((p=s==null?void 0:s.level)!=null?p:0,se.talentCriticalChance,(E=s==null?void 0:s.investedFragments)!=null?E:0,(y=s==null?void 0:s.permLevel)!=null?y:0,(M=s==null?void 0:s.currEXP)!=null?M:0,r)};var ir="talents.barSpeed",mt=(n,r)=>{var u,p,E,y,M;let s=(u=H(n,ir))!=null?u:H(r,ir);return new Ie((p=s==null?void 0:s.level)!=null?p:0,se.talentCriticalChance,(E=s==null?void 0:s.investedFragments)!=null?E:0,(y=s==null?void 0:s.permLevel)!=null?y:0,(M=s==null?void 0:s.currEXP)!=null?M:0,r)};var L={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,coins:{},coinUpgrades:{},talents:{},barFragments:{},refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0};L.coins=new ke(0,L);L.coinUpgrades={barSpeed:new Te(0,V.barSpeed,L),barMomentum:new we(0,V.barMomentum,L),barReverberation:new Pe(0,V.barReverberation,L),barVibration:new Se(0,V.barVibration,L),barAgitation:new Ce(0,V.barAgitation,L)};L.talents={barCriticalChance:new _e(0,se.talentCriticalChance,0,0,0,L),barSpeed:new Ie(0,se.talentProgressSpeed,0,0,0,L)};L.barFragments=new He(0,L);var cr=Object.assign({},L),In=async n=>{await he.default.removeItem("UPBSave");let r=$t(Xt({},n),{coins:n.coins.valueOf(),coinUpgrades:{barSpeed:n.coinUpgrades.barSpeed.valueOf(),barMomentum:n.coinUpgrades.barMomentum.valueOf(),barReverberation:n.coinUpgrades.barReverberation.valueOf(),barVibration:n.coinUpgrades.barVibration.valueOf(),barAgitation:n.coinUpgrades.barAgitation.valueOf()},talents:{barCriticalChance:n.talents.barCriticalChance.valueOf(),barSpeed:n.talents.barSpeed.valueOf()},barFragments:n.barFragments.valueOf()}),s=btoa(JSON.stringify(r));s!==null&&await he.default.setItem("UPBSave",s)},sr=new Map([["coins",(n,r)=>new ke(Number(n.coins.amount),r)],["coinUpgrades.barSpeed",ot],["coinUpgrades.barMomentum",at],["coinUpgrades.barReverberation",it],["coinUpgrades.barVibration",st],["coinUpgrades.barAgitation",ct],["talents.barCriticalChance",dt],["talents.barSpeed",mt],["barFragments",(n,r)=>new He(Number(n.barFragments.amount),r)]]),Rn=async()=>{console.log("load attempted");let n=await he.default.getItem("UPBSave"),r=n?JSON.parse(atob(n)):null;if(!r)return;let s=Object.keys(r);for(let u of s)u in cr&&(sr.has(u)||Object.defineProperty(L,u,{value:r[u]}));for(let[u,p]of sr)Vt(L,u,p(r,L))},Re=new Set,pt=new Proxy(setInterval,{apply(n,r,s){let u=n.apply(r,s);return Re.add(u),u}}),Bn=new Proxy(clearInterval,{apply(n,r,s){let u=s[0];return Re.has(u)&&Re.delete(u),n.apply(r,s)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var ht=0,lt=24,An=5e3,vt=async()=>{for(let n of Re)Bn(n);Re.clear(),await Rn(),L.barTNL=Le(L),Object.defineProperty(window,"player",{value:L}),me(de(L.barEXP,L.barTNL)),L.barFragments.updateHTML(),ue("Main"),D("progression",{backgroundColor:le(L)}),S("coinWorth",{textContent:`Worth ${T(ae(L))} coins`}),ht=performance.now(),pt(Nn,1e3/lt),pt(Zt,1e3,L),pt(In,An,L)},fr=async()=>{if(await Ue("Are you SURE you want to reset the game?")===!1)return Z("OK, the game hasn't been reset!");await he.default.removeItem("UPBSave");let r=btoa(JSON.stringify(cr));await he.default.setItem("UPBSave",r),await vt()},Nn=()=>{let r=performance.now()-ht;Dn(r/1e3),ht+=r},Dn=n=>{Qt(n,L),L.refreshTime+=n,S("refresh-timer",{textContent:`${T(L.refreshTime,2)}s`});let r=de(L.barEXP,L.barTNL);r<100?me(r):Jt(L),qt(L)},Me=60;var ur=n=>{U("main-tab-nav").addEventListener("click",()=>ue("Main")),U("upgrade-tab-nav").addEventListener("click",()=>ue("Upgrades")),U("talent-tab-nav").addEventListener("click",()=>ue("Talents")),U("buy-coin-bar-speed").addEventListener("click",r=>n.coinUpgrades.barSpeed.purchaseLevels(1,r)),U("buy-coin-bar-momentum").addEventListener("click",r=>n.coinUpgrades.barMomentum.purchaseLevels(1,r)),U("buy-coin-bar-reverberation").addEventListener("click",r=>n.coinUpgrades.barReverberation.purchaseLevels(1,r)),U("buy-coin-bar-vibration").addEventListener("click",r=>n.coinUpgrades.barVibration.purchaseLevels(1,r)),U("buy-coin-bar-agitation").addEventListener("click",r=>n.coinUpgrades.barAgitation.purchaseLevels(1,r)),U("buy-reset").addEventListener("click",()=>$e("Refresh",n)),U("reset-game").addEventListener("click",()=>void fr()),U("talentCriticalChanceSacrifice").addEventListener("click",()=>void n.talents.barCriticalChance.sacrificeFragments()),U("talentProgressSpeedSacrifice").addEventListener("click",()=>void n.talents.barSpeed.sacrificeFragments())};window.addEventListener("load",async()=>{var n,r;if(ur(L),await vt(),Fe(L),typeof((n=navigator.storage)==null?void 0:n.persist)=="function"&&typeof((r=navigator.storage)==null?void 0:r.persisted)=="function"){let s=await navigator.storage.persisted();s?console.log(`Storage is persistent! (persistent = ${s})`):await navigator.storage.persist()&&Z("Data on this page is now persistent! If you do not know what this means, you can safely ignore it.")}});document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(L.coins.updateHTML(),L.coinUpgrades.barMomentum.updateHTML(),L.coinUpgrades.barSpeed.updateHTML(),L.coinUpgrades.barReverberation.updateHTML(),L.coinUpgrades.barVibration.updateHTML(),L.coinUpgrades.barAgitation.updateHTML(),L.barFragments.updateHTML(),L.talents.barCriticalChance.updateHTML("Initialize"),L.talents.barSpeed.updateHTML("Initialize"),S("coinWorth",{textContent:`Worth ${T(ae(L))} coins`}))});})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
