(()=>{var an=Object.create;var je=Object.defineProperty;var sn=Object.getOwnPropertyDescriptor;var fn=Object.getOwnPropertyNames;var cn=Object.getPrototypeOf,un=Object.prototype.hasOwnProperty;var ln=a=>je(a,"__esModule",{value:!0});var ge=(a=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(a,{get:(r,c)=>(typeof require!="undefined"?require:r)[c]}):a)(function(a){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+a+'" is not supported')});var dn=(a,r)=>()=>(r||a((r={exports:{}}).exports,r),r.exports);var mn=(a,r,c,d)=>{if(r&&typeof r=="object"||typeof r=="function")for(let v of fn(r))!un.call(a,v)&&(c||v!=="default")&&je(a,v,{get:()=>r[v],enumerable:!(d=sn(r,v))||d.enumerable});return a},pn=(a,r)=>mn(ln(je(a!=null?an(cn(a)):{},"default",!r&&a&&a.__esModule?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var $t=dn((Xt,rt)=>{(function(a){if(typeof Xt=="object"&&typeof rt<"u")rt.exports=a();else if(typeof define=="function"&&define.amd)define([],a);else{var r;typeof window<"u"?r=window:typeof global<"u"?r=global:typeof self<"u"?r=self:r=this,r.localforage=a()}})(function(){var a,r,c;return function d(v,E,L){function B(N,V){if(!E[N]){if(!v[N]){var y=typeof ge=="function"&&ge;if(!V&&y)return y(N,!0);if(x)return x(N,!0);var w=new Error("Cannot find module '"+N+"'");throw w.code="MODULE_NOT_FOUND",w}var F=E[N]={exports:{}};v[N][0].call(F.exports,function(X){var q=v[N][1][X];return B(q||X)},F,F.exports,d,v,E,L)}return E[N].exports}for(var x=typeof ge=="function"&&ge,A=0;A<L.length;A++)B(L[A]);return B}({1:[function(d,v,E){(function(L){"use strict";var B=L.MutationObserver||L.WebKitMutationObserver,x;if(B){var A=0,N=new B(X),V=L.document.createTextNode("");N.observe(V,{characterData:!0}),x=function(){V.data=A=++A%2}}else if(!L.setImmediate&&typeof L.MessageChannel<"u"){var y=new L.MessageChannel;y.port1.onmessage=X,x=function(){y.port2.postMessage(0)}}else"document"in L&&"onreadystatechange"in L.document.createElement("script")?x=function(){var $=L.document.createElement("script");$.onreadystatechange=function(){X(),$.onreadystatechange=null,$.parentNode.removeChild($),$=null},L.document.documentElement.appendChild($)}:x=function(){setTimeout(X,0)};var w,F=[];function X(){w=!0;for(var $,Z,W=F.length;W;){for(Z=F,F=[],$=-1;++$<W;)Z[$]();W=F.length}w=!1}v.exports=q;function q($){F.push($)===1&&!w&&x()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(d,v,E){"use strict";var L=d(1);function B(){}var x={},A=["REJECTED"],N=["FULFILLED"],V=["PENDING"];v.exports=y;function y(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=V,this.queue=[],this.outcome=void 0,b!==B&&q(this,b)}y.prototype.catch=function(b){return this.then(null,b)},y.prototype.then=function(b,M){if(typeof b!="function"&&this.state===N||typeof M!="function"&&this.state===A)return this;var _=new this.constructor(B);if(this.state!==V){var R=this.state===N?b:M;F(_,R,this.outcome)}else this.queue.push(new w(_,b,M));return _};function w(b,M,_){this.promise=b,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(b){x.resolve(this.promise,b)},w.prototype.otherCallFulfilled=function(b){F(this.promise,this.onFulfilled,b)},w.prototype.callRejected=function(b){x.reject(this.promise,b)},w.prototype.otherCallRejected=function(b){F(this.promise,this.onRejected,b)};function F(b,M,_){L(function(){var R;try{R=M(_)}catch(z){return x.reject(b,z)}R===b?x.reject(b,new TypeError("Cannot resolve promise with itself")):x.resolve(b,R)})}x.resolve=function(b,M){var _=$(X,M);if(_.status==="error")return x.reject(b,_.value);var R=_.value;if(R)q(b,R);else{b.state=N,b.outcome=M;for(var z=-1,Y=b.queue.length;++z<Y;)b.queue[z].callFulfilled(M)}return b},x.reject=function(b,M){b.state=A,b.outcome=M;for(var _=-1,R=b.queue.length;++_<R;)b.queue[_].callRejected(M);return b};function X(b){var M=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof M=="function")return function(){M.apply(b,arguments)}}function q(b,M){var _=!1;function R(Q){_||(_=!0,x.reject(b,Q))}function z(Q){_||(_=!0,x.resolve(b,Q))}function Y(){M(z,R)}var K=$(Y);K.status==="error"&&R(K.value)}function $(b,M){var _={};try{_.value=b(M),_.status="success"}catch(R){_.status="error",_.value=R}return _}y.resolve=Z;function Z(b){return b instanceof this?b:x.resolve(new this(B),b)}y.reject=W;function W(b){var M=new this(B);return x.reject(M,b)}y.all=$e;function $e(b){var M=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=b.length,R=!1;if(!_)return this.resolve([]);for(var z=new Array(_),Y=0,K=-1,Q=new this(B);++K<_;)j(b[K],K);return Q;function j(ve,Be){M.resolve(ve).then(We,function(fe){R||(R=!0,x.reject(Q,fe))});function We(fe){z[Be]=fe,++Y===_&&!R&&(R=!0,x.resolve(Q,z))}}}y.race=ie;function ie(b){var M=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=b.length,R=!1;if(!_)return this.resolve([]);for(var z=-1,Y=new this(B);++z<_;)K(b[z]);return Y;function K(Q){M.resolve(Q).then(function(j){R||(R=!0,x.resolve(Y,j))},function(j){R||(R=!0,x.reject(Y,j))})}}},{"1":1}],3:[function(d,v,E){(function(L){"use strict";typeof L.Promise!="function"&&(L.Promise=d(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(d,v,E){"use strict";var L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function B(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function x(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(e){return}}var A=x();function N(){try{if(!A||!A.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(t){return!1}}function V(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(o){if(o.name!=="TypeError")throw o;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,i=new t,s=0;s<e.length;s+=1)i.append(e[s]);return i.getBlob(n.type)}}typeof Promise>"u"&&d(3);var y=Promise;function w(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function F(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function X(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function q(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var $="local-forage-detect-blob-support",Z=void 0,W={},$e=Object.prototype.toString,ie="readonly",b="readwrite";function M(e){for(var n=e.length,t=new ArrayBuffer(n),i=new Uint8Array(t),s=0;s<n;s++)i[s]=e.charCodeAt(s);return t}function _(e){return new y(function(n){var t=e.transaction($,b),i=V([""]);t.objectStore($).put(i,"key"),t.onabort=function(s){s.preventDefault(),s.stopPropagation(),n(!1)},t.oncomplete=function(){var s=navigator.userAgent.match(/Chrome\/(\d+)/),o=navigator.userAgent.match(/Edge\//);n(o||!s||parseInt(s[1],10)>=43)}}).catch(function(){return!1})}function R(e){return typeof Z=="boolean"?y.resolve(Z):_(e).then(function(n){return Z=n,Z})}function z(e){var n=W[e.name],t={};t.promise=new y(function(i,s){t.resolve=i,t.reject=s}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function Y(e){var n=W[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function K(e,n){var t=W[e.name],i=t.deferredOperations.pop();if(i)return i.reject(n),i.promise}function Q(e,n){return new y(function(t,i){if(W[e.name]=W[e.name]||yt(),e.db)if(n)z(e),e.db.close();else return t(e.db);var s=[e.name];n&&s.push(e.version);var o=A.open.apply(A,s);n&&(o.onupgradeneeded=function(u){var l=o.result;try{l.createObjectStore(e.storeName),u.oldVersion<=1&&l.createObjectStore($)}catch(m){if(m.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+u.oldVersion+" to version "+u.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw m}}),o.onerror=function(u){u.preventDefault(),i(o.error)},o.onsuccess=function(){var u=o.result;u.onversionchange=function(l){l.target.close()},t(u),Y(e)}})}function j(e){return Q(e,!1)}function ve(e){return Q(e,!0)}function Be(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,s=e.version>e.db.version;if(i&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||t){if(t){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function We(e){return new y(function(n,t){var i=new FileReader;i.onerror=t,i.onloadend=function(s){var o=btoa(s.target.result||"");n({__local_forage_encoded_blob:!0,data:o,type:e.type})},i.readAsBinaryString(e)})}function fe(e){var n=M(atob(e.data));return V([n],{type:e.type})}function bt(e){return e&&e.__local_forage_encoded_blob}function ir(e){var n=this,t=n._initReady().then(function(){var i=W[n._dbInfo.name];if(i&&i.dbReady)return i.dbReady});return F(t,e,e),t}function sr(e){z(e);for(var n=W[e.name],t=n.forages,i=0;i<t.length;i++){var s=t[i];s._dbInfo.db&&(s._dbInfo.db.close(),s._dbInfo.db=null)}return e.db=null,j(e).then(function(o){return e.db=o,Be(e)?ve(e):o}).then(function(o){e.db=n.db=o;for(var u=0;u<t.length;u++)t[u]._dbInfo.db=o}).catch(function(o){throw K(e,o),o})}function ee(e,n,t,i){i===void 0&&(i=1);try{var s=e.db.transaction(e.storeName,n);t(null,s)}catch(o){if(i>0&&(!e.db||o.name==="InvalidStateError"||o.name==="NotFoundError"))return y.resolve().then(function(){if(!e.db||o.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),ve(e)}).then(function(){return sr(e).then(function(){ee(e,n,t,i-1)})}).catch(t);t(o)}}function yt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function fr(e){var n=this,t={db:null};if(e)for(var i in e)t[i]=e[i];var s=W[t.name];s||(s=yt(),W[t.name]=s),s.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=ir);var o=[];function u(){return y.resolve()}for(var l=0;l<s.forages.length;l++){var m=s.forages[l];m!==n&&o.push(m._initReady().catch(u))}var p=s.forages.slice(0);return y.all(o).then(function(){return t.db=s.db,j(t)}).then(function(h){return t.db=h,Be(t,n._defaultConfig.version)?ve(t):h}).then(function(h){t.db=s.db=h,n._dbInfo=t;for(var g=0;g<p.length;g++){var S=p[g];S!==n&&(S._dbInfo.db=t.db,S._dbInfo.version=t.version)}})}function cr(e,n){var t=this;e=X(e);var i=new y(function(s,o){t.ready().then(function(){ee(t._dbInfo,ie,function(u,l){if(u)return o(u);try{var m=l.objectStore(t._dbInfo.storeName),p=m.get(e);p.onsuccess=function(){var h=p.result;h===void 0&&(h=null),bt(h)&&(h=fe(h)),s(h)},p.onerror=function(){o(p.error)}}catch(h){o(h)}})}).catch(o)});return w(i,n),i}function ur(e,n){var t=this,i=new y(function(s,o){t.ready().then(function(){ee(t._dbInfo,ie,function(u,l){if(u)return o(u);try{var m=l.objectStore(t._dbInfo.storeName),p=m.openCursor(),h=1;p.onsuccess=function(){var g=p.result;if(g){var S=g.value;bt(S)&&(S=fe(S));var P=e(S,g.key,h++);P!==void 0?s(P):g.continue()}else s()},p.onerror=function(){o(p.error)}}catch(g){o(g)}})}).catch(o)});return w(i,n),i}function lr(e,n,t){var i=this;e=X(e);var s=new y(function(o,u){var l;i.ready().then(function(){return l=i._dbInfo,$e.call(n)==="[object Blob]"?R(l.db).then(function(m){return m?n:We(n)}):n}).then(function(m){ee(i._dbInfo,b,function(p,h){if(p)return u(p);try{var g=h.objectStore(i._dbInfo.storeName);m===null&&(m=void 0);var S=g.put(m,e);h.oncomplete=function(){m===void 0&&(m=null),o(m)},h.onabort=h.onerror=function(){var P=S.error?S.error:S.transaction.error;u(P)}}catch(P){u(P)}})}).catch(u)});return w(s,t),s}function dr(e,n){var t=this;e=X(e);var i=new y(function(s,o){t.ready().then(function(){ee(t._dbInfo,b,function(u,l){if(u)return o(u);try{var m=l.objectStore(t._dbInfo.storeName),p=m.delete(e);l.oncomplete=function(){s()},l.onerror=function(){o(p.error)},l.onabort=function(){var h=p.error?p.error:p.transaction.error;o(h)}}catch(h){o(h)}})}).catch(o)});return w(i,n),i}function mr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){ee(n._dbInfo,b,function(o,u){if(o)return s(o);try{var l=u.objectStore(n._dbInfo.storeName),m=l.clear();u.oncomplete=function(){i()},u.onabort=u.onerror=function(){var p=m.error?m.error:m.transaction.error;s(p)}}catch(p){s(p)}})}).catch(s)});return w(t,e),t}function pr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){ee(n._dbInfo,ie,function(o,u){if(o)return s(o);try{var l=u.objectStore(n._dbInfo.storeName),m=l.count();m.onsuccess=function(){i(m.result)},m.onerror=function(){s(m.error)}}catch(p){s(p)}})}).catch(s)});return w(t,e),t}function hr(e,n){var t=this,i=new y(function(s,o){if(e<0){s(null);return}t.ready().then(function(){ee(t._dbInfo,ie,function(u,l){if(u)return o(u);try{var m=l.objectStore(t._dbInfo.storeName),p=!1,h=m.openKeyCursor();h.onsuccess=function(){var g=h.result;if(!g){s(null);return}e===0||p?s(g.key):(p=!0,g.advance(e))},h.onerror=function(){o(h.error)}}catch(g){o(g)}})}).catch(o)});return w(i,n),i}function vr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){ee(n._dbInfo,ie,function(o,u){if(o)return s(o);try{var l=u.objectStore(n._dbInfo.storeName),m=l.openKeyCursor(),p=[];m.onsuccess=function(){var h=m.result;if(!h){i(p);return}p.push(h.key),h.continue()},m.onerror=function(){s(m.error)}}catch(h){s(h)}})}).catch(s)});return w(t,e),t}function br(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i=this,s;if(!e.name)s=y.reject("Invalid arguments");else{var o=e.name===t.name&&i._dbInfo.db,u=o?y.resolve(i._dbInfo.db):j(e).then(function(l){var m=W[e.name],p=m.forages;m.db=l;for(var h=0;h<p.length;h++)p[h]._dbInfo.db=l;return l});e.storeName?s=u.then(function(l){if(!!l.objectStoreNames.contains(e.storeName)){var m=l.version+1;z(e);var p=W[e.name],h=p.forages;l.close();for(var g=0;g<h.length;g++){var S=h[g];S._dbInfo.db=null,S._dbInfo.version=m}var P=new y(function(I,O){var k=A.open(e.name,m);k.onerror=function(J){var ye=k.result;ye.close(),O(J)},k.onupgradeneeded=function(){var J=k.result;J.deleteObjectStore(e.storeName)},k.onsuccess=function(){var J=k.result;J.close(),I(J)}});return P.then(function(I){p.db=I;for(var O=0;O<h.length;O++){var k=h[O];k._dbInfo.db=I,Y(k._dbInfo)}}).catch(function(I){throw(K(e,I)||y.resolve()).catch(function(){}),I})}}):s=u.then(function(l){z(e);var m=W[e.name],p=m.forages;l.close();for(var h=0;h<p.length;h++){var g=p[h];g._dbInfo.db=null}var S=new y(function(P,I){var O=A.deleteDatabase(e.name);O.onerror=function(){var k=O.result;k&&k.close(),I(O.error)},O.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},O.onsuccess=function(){var k=O.result;k&&k.close(),P(k)}});return S.then(function(P){m.db=P;for(var I=0;I<p.length;I++){var O=p[I];Y(O._dbInfo)}}).catch(function(P){throw(K(e,P)||y.resolve()).catch(function(){}),P})})}return w(s,n),s}var yr={_driver:"asyncStorage",_initStorage:fr,_support:N(),iterate:ur,getItem:cr,setItem:lr,removeItem:dr,clear:mr,length:pr,key:hr,keys:vr,dropInstance:br};function gr(){return typeof openDatabase=="function"}var re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Er="~~local_forage_type~",gt=/^~~local_forage_type~([^~]+)~/,Ae="__lfsc__:",ze=Ae.length,Ge="arbf",Ve="blob",Et="si08",Lt="ui08",xt="uic8",Tt="si16",wt="si32",St="ur16",Ct="ui32",_t="fl32",Mt="fl64",Pt=ze+Ge.length,It=Object.prototype.toString;function Rt(e){var n=e.length*.75,t=e.length,i,s=0,o,u,l,m;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var p=new ArrayBuffer(n),h=new Uint8Array(p);for(i=0;i<t;i+=4)o=re.indexOf(e[i]),u=re.indexOf(e[i+1]),l=re.indexOf(e[i+2]),m=re.indexOf(e[i+3]),h[s++]=o<<2|u>>4,h[s++]=(u&15)<<4|l>>2,h[s++]=(l&3)<<6|m&63;return p}function Ye(e){var n=new Uint8Array(e),t="",i;for(i=0;i<n.length;i+=3)t+=re[n[i]>>2],t+=re[(n[i]&3)<<4|n[i+1]>>4],t+=re[(n[i+1]&15)<<2|n[i+2]>>6],t+=re[n[i+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function Lr(e,n){var t="";if(e&&(t=It.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&It.call(e.buffer)==="[object ArrayBuffer]")){var i,s=Ae;e instanceof ArrayBuffer?(i=e,s+=Ge):(i=e.buffer,t==="[object Int8Array]"?s+=Et:t==="[object Uint8Array]"?s+=Lt:t==="[object Uint8ClampedArray]"?s+=xt:t==="[object Int16Array]"?s+=Tt:t==="[object Uint16Array]"?s+=St:t==="[object Int32Array]"?s+=wt:t==="[object Uint32Array]"?s+=Ct:t==="[object Float32Array]"?s+=_t:t==="[object Float64Array]"?s+=Mt:n(new Error("Failed to get type for BinaryArray"))),n(s+Ye(i))}else if(t==="[object Blob]"){var o=new FileReader;o.onload=function(){var u=Er+e.type+"~"+Ye(this.result);n(Ae+Ve+u)},o.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(u){console.error("Couldn't convert value into a JSON string: ",e),n(null,u)}}function xr(e){if(e.substring(0,ze)!==Ae)return JSON.parse(e);var n=e.substring(Pt),t=e.substring(ze,Pt),i;if(t===Ve&&gt.test(n)){var s=n.match(gt);i=s[1],n=n.substring(s[0].length)}var o=Rt(n);switch(t){case Ge:return o;case Ve:return V([o],{type:i});case Et:return new Int8Array(o);case Lt:return new Uint8Array(o);case xt:return new Uint8ClampedArray(o);case Tt:return new Int16Array(o);case St:return new Uint16Array(o);case wt:return new Int32Array(o);case Ct:return new Uint32Array(o);case _t:return new Float32Array(o);case Mt:return new Float64Array(o);default:throw new Error("Unkown type: "+t)}}var Ke={serialize:Lr,deserialize:xr,stringToBuffer:Rt,bufferToString:Ye};function Bt(e,n,t,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,i)}function Tr(e){var n=this,t={db:null};if(e)for(var i in e)t[i]=typeof e[i]!="string"?e[i].toString():e[i];var s=new y(function(o,u){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(l){return u(l)}t.db.transaction(function(l){Bt(l,t,function(){n._dbInfo=t,o()},function(m,p){u(p)})},u)});return t.serializer=Ke,s}function ne(e,n,t,i,s,o){e.executeSql(t,i,s,function(u,l){l.code===l.SYNTAX_ERR?u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(m,p){p.rows.length?o(m,l):Bt(m,n,function(){m.executeSql(t,i,s,o)},o)},o):o(u,l)},o)}function wr(e,n){var t=this;e=X(e);var i=new y(function(s,o){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(l){ne(l,u,"SELECT * FROM "+u.storeName+" WHERE key = ? LIMIT 1",[e],function(m,p){var h=p.rows.length?p.rows.item(0).value:null;h&&(h=u.serializer.deserialize(h)),s(h)},function(m,p){o(p)})})}).catch(o)});return w(i,n),i}function Sr(e,n){var t=this,i=new y(function(s,o){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(l){ne(l,u,"SELECT * FROM "+u.storeName,[],function(m,p){for(var h=p.rows,g=h.length,S=0;S<g;S++){var P=h.item(S),I=P.value;if(I&&(I=u.serializer.deserialize(I)),I=e(I,P.key,S+1),I!==void 0){s(I);return}}s()},function(m,p){o(p)})})}).catch(o)});return w(i,n),i}function At(e,n,t,i){var s=this;e=X(e);var o=new y(function(u,l){s.ready().then(function(){n===void 0&&(n=null);var m=n,p=s._dbInfo;p.serializer.serialize(n,function(h,g){g?l(g):p.db.transaction(function(S){ne(S,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){u(m)},function(P,I){l(I)})},function(S){if(S.code===S.QUOTA_ERR){if(i>0){u(At.apply(s,[e,m,t,i-1]));return}l(S)}})})}).catch(l)});return w(o,t),o}function Cr(e,n,t){return At.apply(this,[e,n,t,1])}function _r(e,n){var t=this;e=X(e);var i=new y(function(s,o){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(l){ne(l,u,"DELETE FROM "+u.storeName+" WHERE key = ?",[e],function(){s()},function(m,p){o(p)})})}).catch(o)});return w(i,n),i}function Mr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(u){ne(u,o,"DELETE FROM "+o.storeName,[],function(){i()},function(l,m){s(m)})})}).catch(s)});return w(t,e),t}function Pr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(u){ne(u,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(l,m){var p=m.rows.item(0).c;i(p)},function(l,m){s(m)})})}).catch(s)});return w(t,e),t}function Ir(e,n){var t=this,i=new y(function(s,o){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(l){ne(l,u,"SELECT key FROM "+u.storeName+" WHERE id = ? LIMIT 1",[e+1],function(m,p){var h=p.rows.length?p.rows.item(0).key:null;s(h)},function(m,p){o(p)})})}).catch(o)});return w(i,n),i}function Rr(e){var n=this,t=new y(function(i,s){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(u){ne(u,o,"SELECT key FROM "+o.storeName,[],function(l,m){for(var p=[],h=0;h<m.rows.length;h++)p.push(m.rows.item(h).key);i(p)},function(l,m){s(m)})})}).catch(s)});return w(t,e),t}function Br(e){return new y(function(n,t){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(s,o){for(var u=[],l=0;l<o.rows.length;l++)u.push(o.rows.item(l).name);n({db:e,storeNames:u})},function(s,o){t(o)})},function(i){t(i)})})}function Ar(e,n){n=q.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i=this,s;return e.name?s=new y(function(o){var u;e.name===t.name?u=i._dbInfo.db:u=openDatabase(e.name,"","",0),e.storeName?o({db:u,storeNames:[e.storeName]}):o(Br(u))}).then(function(o){return new y(function(u,l){o.db.transaction(function(m){function p(P){return new y(function(I,O){m.executeSql("DROP TABLE IF EXISTS "+P,[],function(){I()},function(k,J){O(J)})})}for(var h=[],g=0,S=o.storeNames.length;g<S;g++)h.push(p(o.storeNames[g]));y.all(h).then(function(){u()}).catch(function(P){l(P)})},function(m){l(m)})})}):s=y.reject("Invalid arguments"),w(s,n),s}var Nr={_driver:"webSQLStorage",_initStorage:Tr,_support:gr(),iterate:Sr,getItem:wr,setItem:Cr,removeItem:_r,clear:Mr,length:Pr,key:Ir,keys:Rr,dropInstance:Ar};function Dr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Nt(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Ur(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function kr(){return!Ur()||localStorage.length>0}function Hr(e){var n=this,t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=Nt(e,n._defaultConfig),kr()?(n._dbInfo=t,t.serializer=Ke,y.resolve()):y.reject()}function Fr(e){var n=this,t=n.ready().then(function(){for(var i=n._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var o=localStorage.key(s);o.indexOf(i)===0&&localStorage.removeItem(o)}});return w(t,e),t}function Or(e,n){var t=this;e=X(e);var i=t.ready().then(function(){var s=t._dbInfo,o=localStorage.getItem(s.keyPrefix+e);return o&&(o=s.serializer.deserialize(o)),o});return w(i,n),i}function Xr(e,n){var t=this,i=t.ready().then(function(){for(var s=t._dbInfo,o=s.keyPrefix,u=o.length,l=localStorage.length,m=1,p=0;p<l;p++){var h=localStorage.key(p);if(h.indexOf(o)===0){var g=localStorage.getItem(h);if(g&&(g=s.serializer.deserialize(g)),g=e(g,h.substring(u),m++),g!==void 0)return g}}});return w(i,n),i}function $r(e,n){var t=this,i=t.ready().then(function(){var s=t._dbInfo,o;try{o=localStorage.key(e)}catch(u){o=null}return o&&(o=o.substring(s.keyPrefix.length)),o});return w(i,n),i}function Wr(e){var n=this,t=n.ready().then(function(){for(var i=n._dbInfo,s=localStorage.length,o=[],u=0;u<s;u++){var l=localStorage.key(u);l.indexOf(i.keyPrefix)===0&&o.push(l.substring(i.keyPrefix.length))}return o});return w(t,e),t}function zr(e){var n=this,t=n.keys().then(function(i){return i.length});return w(t,e),t}function Gr(e,n){var t=this;e=X(e);var i=t.ready().then(function(){var s=t._dbInfo;localStorage.removeItem(s.keyPrefix+e)});return w(i,n),i}function Vr(e,n,t){var i=this;e=X(e);var s=i.ready().then(function(){n===void 0&&(n=null);var o=n;return new y(function(u,l){var m=i._dbInfo;m.serializer.serialize(n,function(p,h){if(h)l(h);else try{localStorage.setItem(m.keyPrefix+e,p),u(o)}catch(g){(g.name==="QuotaExceededError"||g.name==="NS_ERROR_DOM_QUOTA_REACHED")&&l(g),l(g)}})})});return w(s,t),s}function Yr(e,n){if(n=q.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var i=this,s;return e.name?s=new y(function(o){e.storeName?o(Nt(e,i._defaultConfig)):o(e.name+"/")}).then(function(o){for(var u=localStorage.length-1;u>=0;u--){var l=localStorage.key(u);l.indexOf(o)===0&&localStorage.removeItem(l)}}):s=y.reject("Invalid arguments"),w(s,n),s}var Kr={_driver:"localStorageWrapper",_initStorage:Hr,_support:Dr(),iterate:Xr,getItem:Or,setItem:Vr,removeItem:Gr,clear:Fr,length:zr,key:$r,keys:Wr,dropInstance:Yr},Qr=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},Jr=function(n,t){for(var i=n.length,s=0;s<i;){if(Qr(n[s],t))return!0;s++}return!1},Dt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},be={},Ut={},ce={INDEXEDDB:yr,WEBSQL:Nr,LOCALSTORAGE:Kr},qr=[ce.INDEXEDDB._driver,ce.WEBSQL._driver,ce.LOCALSTORAGE._driver],Ne=["dropInstance"],Qe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ne),Zr={description:"",driver:qr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function jr(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function Je(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(Dt(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var en=function(){function e(n){B(this,e);for(var t in ce)if(ce.hasOwnProperty(t)){var i=ce[t],s=i._driver;this[t]=s,be[s]||this.defineDriver(i)}this._defaultConfig=Je({},Zr),this._config=Je({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":L(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in t){if(i==="storeName"&&(t[i]=t[i].replace(/\W/g,"_")),i==="version"&&typeof t[i]!="number")return new Error("Database version must be a number.");this._config[i]=t[i]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,i,s){var o=new y(function(u,l){try{var m=t._driver,p=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){l(p);return}for(var h=Qe.concat("_initStorage"),g=0,S=h.length;g<S;g++){var P=h[g],I=!Jr(Ne,P);if((I||t[P])&&typeof t[P]!="function"){l(p);return}}var O=function(){for(var ye=function(nn){return function(){var on=new Error("Method "+nn+" is not implemented by the current driver"),kt=y.reject(on);return w(kt,arguments[arguments.length-1]),kt}},qe=0,rn=Ne.length;qe<rn;qe++){var Ze=Ne[qe];t[Ze]||(t[Ze]=ye(Ze))}};O();var k=function(ye){be[m]&&console.info("Redefining LocalForage driver: "+m),be[m]=t,Ut[m]=ye,u()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(k,l):k(!!t._support):k(!0)}catch(J){l(J)}});return F(o,i,s),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,i,s){var o=be[t]?y.resolve(be[t]):y.reject(new Error("Driver not found."));return F(o,i,s),o},e.prototype.getSerializer=function(t){var i=y.resolve(Ke);return F(i,t),i},e.prototype.ready=function(t){var i=this,s=i._driverSet.then(function(){return i._ready===null&&(i._ready=i._initDriver()),i._ready});return F(s,t,t),s},e.prototype.setDriver=function(t,i,s){var o=this;Dt(t)||(t=[t]);var u=this._getSupportedDrivers(t);function l(){o._config.driver=o.driver()}function m(g){return o._extend(g),l(),o._ready=o._initStorage(o._config),o._ready}function p(g){return function(){var S=0;function P(){for(;S<g.length;){var I=g[S];return S++,o._dbInfo=null,o._ready=null,o.getDriver(I).then(m).catch(P)}l();var O=new Error("No available storage method found.");return o._driverSet=y.reject(O),o._driverSet}return P()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=h.then(function(){var g=u[0];return o._dbInfo=null,o._ready=null,o.getDriver(g).then(function(S){o._driver=S._driver,l(),o._wrapLibraryMethodsWithReady(),o._initDriver=p(u)})}).catch(function(){l();var g=new Error("No available storage method found.");return o._driverSet=y.reject(g),o._driverSet}),F(this._driverSet,i,s),this._driverSet},e.prototype.supports=function(t){return!!Ut[t]},e.prototype._extend=function(t){Je(this,t)},e.prototype._getSupportedDrivers=function(t){for(var i=[],s=0,o=t.length;s<o;s++){var u=t[s];this.supports(u)&&i.push(u)}return i},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,i=Qe.length;t<i;t++)jr(this,Qe[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),tn=new en;v.exports=tn},{"3":3}]},{},[4])(4)})});var tt=a=>{let r=typeof a;return a!==null&&(r==="object"||r==="function")},et=new Set(["__proto__","prototype","constructor"]),hn=new Set("0123456789");function Ht(a){let r=[],c="",d="start",v=!1;for(let E of a)switch(E){case"\\":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");v&&(c+=E),d="property",v=!v;break;case".":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="property";break}if(v){v=!1,c+=E;break}if(et.has(c))return[];r.push(c),c="",d="property";break;case"[":if(d==="index")throw new Error("Invalid character in an index");if(d==="indexEnd"){d="index";break}if(v){v=!1,c+=E;break}if(d==="property"){if(et.has(c))return[];r.push(c),c=""}d="index";break;case"]":if(d==="index"){r.push(Number.parseInt(c,10)),c="",d="indexEnd";break}if(d==="indexEnd")throw new Error("Invalid character after an index");default:if(d==="index"&&!hn.has(E))throw new Error("Invalid character in an index");if(d==="indexEnd")throw new Error("Invalid character after an index");d==="start"&&(d="property"),v&&(v=!1,c+="\\"),c+=E}switch(v&&(c+="\\"),d){case"property":{if(et.has(c))return[];r.push(c);break}case"index":throw new Error("Index was not closed");case"start":{r.push("");break}}return r}function Ft(a,r){if(typeof r!="number"&&Array.isArray(a)){let c=Number.parseInt(r,10);return Number.isInteger(c)&&a[c]===a[r]}return!1}function vn(a,r){if(Ft(a,r))throw new Error("Cannot use string index")}function H(a,r,c){if(!tt(a)||typeof r!="string")return c===void 0?a:c;let d=Ht(r);if(d.length===0)return c;for(let v=0;v<d.length;v++){let E=d[v];if(Ft(a,E)?a=v===d.length-1?void 0:null:a=a[E],a==null){if(v!==d.length-1)return c;break}}return a===void 0?c:a}function Ot(a,r,c){if(!tt(a)||typeof r!="string")return a;let d=a,v=Ht(r);for(let E=0;E<v.length;E++){let L=v[E];vn(a,L),E===v.length-1?a[L]=c:tt(a[L])||(a[L]=typeof v[E+1]=="number"?[]:{}),a=a[L]}return d}var he=pn($t());var T=(a,r=0)=>{if(a<0)return"-"+T(-a,r);if(a>=1e6){let A=Math.floor(Math.log10(a));return a/=Math.pow(10,A),T(a,2)+"e"+T(A)}let c=Math.floor(a),d=a-c,v=c.toLocaleString(),E=r>0&&a!==0,L=Math.pow(10,r)*d,B=1e-6;Math.ceil(L)-L<B&&(L=Math.ceil(L));let x=E?Math.floor(L).toString():"";if(x!==""){for(;x.length<r;)x="0"+x;x="."+x}return v+x};var Wt=(a,r)=>{if(document.visibilityState==="hidden")return!1;let c=Object.entries(r);for(let[d,v]of c)a[d]=v;return!0},C=(a,r)=>document.visibilityState==="hidden"?!1:Wt(U(a),r),D=(a,r)=>document.visibilityState==="hidden"?!1:Wt(U(a).style,r);var bn=10,De=0,nt=0,Ee=()=>{let a=0;return a+=bn*Math.pow(f.barLevel+1,2),a*=Math.min(1,(f.barLevel+20)/40),a*=Math.max(1,1+(f.barLevel-20)/10),f.barLevel>40&&(a*=Math.pow(2,1/10*(f.barLevel-40))),f.barLevel>100&&(a*=Math.pow(2,1/10*(f.barLevel-100))),f.barLevel>200&&(a*=Math.pow(2,1/10*(f.barLevel-200))),a},yn=()=>{let a=0;return f.barLevel>=5&&(a=.1),f.barLevel>=10&&(a+=.9*(1-Math.pow(Math.E,-f.barLevel/200))),a>=.9999?1e4:1/(1-a)},gn=()=>yn()*(1-f.barEXP/f.barTNL),zt=a=>{if(a==null)return;let r=1;r+=f.coinUpgrades.barSpeed.upgradeEffect(),r*=f.barFragments.unspentBonus(),r*=Math.pow(1+f.coinUpgrades.barMomentum.upgradeEffect(),Math.sqrt(100*Math.min(1,f.barEXP/f.barTNL))),r/=gn(),r*=f.talents.barSpeed.talentEffect();let c=Math.random(),d=f.coinUpgrades.barReverberation.upgradeEffect()+f.talents.barCriticalChance.talentEffect();c<d&&(r*=f.coinUpgrades.barVibration.upgradeEffect(),f.talents.barCriticalChance.gainEXP(a),f.criticalHits+=1,f.criticalHitsThisRefresh+=1,Ue());let v=r*a;f.barEXP+=v,De+=v,C("perSecCurr",{textContent:`+${T(De,2)} this sec`})},ue=(a,r)=>Math.min(100,.1*Math.floor(1e3*a/r)),le=a=>{D("progression",{width:`${a}%`})},de=()=>{if(f.barLevel>=128)return"#FFFFFF";let a=(128+f.barLevel).toString(16).padStart(2,"0"),r=(2*f.barLevel).toString(16).padStart(2,"0"),c=(128+f.barLevel).toString(16).padStart(2,"0");return`#${a}${r}${c}`},Gt=()=>{f.coins.gain(oe()),f.barEXP-=f.barTNL,f.barLevel+=1,f.barLevel>f.highestBarLevel&&(f.highestBarLevel=f.barLevel);let a=de();D("progression",{backgroundColor:a}),f.barTNL=Ee(),f.barEXP/=10,f.barEXP=Math.min(f.barEXP,Math.floor(f.barTNL/10));let r=ue(f.barEXP,f.barTNL);le(r),C("coinWorth",{textContent:`Worth ${T(oe())} coins`}),f.barFragments.updateHTML(),f.barLevel===20&&(f.talents.barCriticalChance.updateHTML("Level20"),f.talents.barSpeed.updateHTML("Level20"))},Vt=()=>{C("level",{textContent:`Level: ${f.barLevel}`}),C("exp",{textContent:`EXP: ${T(f.barEXP)}/${T(f.barTNL)}`})},Yt=()=>{nt=De,De=0,C("perSecPrev",{textContent:`+${T(nt,2)} prev sec`}),f.talents.barCriticalChance.updateHTML("Time"),f.talents.barSpeed.gainEXP(nt)},oe=()=>{let a=0,r=1+f.barLevel;r>f.highestBarLevel&&(a+=3),r%5===0&&(a+=Math.floor(r/5)+3),r%10===0&&(a+=Math.floor(r/2)),r%50===0&&(a+=Math.floor(r/2)),r%100===0&&(a+=Math.floor(r));let c=U("coinWorth");return c.style.color=a>0?"gold":"grey",a};var me=a=>{D("mainTab",{display:"none"}),D("upgradeTab",{display:"none"}),D("talentsTab",{display:"none"}),a==="Main"?D("mainTab",{display:"block"}):a==="Upgrades"?D("upgradeTab",{display:"block"}):a==="Talents"&&D("talentsTab",{display:"block"})},U=a=>document.getElementById(a),Ue=()=>{D("progression",{backgroundColor:"gold"}),setTimeout(()=>{D("progression",{backgroundColor:de()})},250),C("refresh-crit-counter",{textContent:T(f.criticalHitsThisRefresh)}),f.barFragments.updateHTML()},ke=()=>{D("progression",{backgroundColor:"cyan"}),setTimeout(()=>{D("progression",{backgroundColor:de()})},1e3),C("coinWorth",{textContent:`Worth ${T(oe())} coins`}),C("refresh-crit-counter",{textContent:T(f.criticalHitsThisRefresh)}),C("refresh-counter",{textContent:T(f.refreshCount)})};var te=(a,r)=>a.querySelector(r),En=(a,r)=>{let c=U("confirmationBox"),d=U("confirmWrapper"),v=te(document,"#confirm"),E=te(document,"#transparentBG"),L=te(v,"#okConfirm"),B=te(v,"#cancelConfirm");c.style.display="block",d.style.display="block",E.style.display="block",te(v,"p").textContent=a,v.focus();let x=({target:N})=>{let V=N;L.removeEventListener("click",x),B.removeEventListener("click",x),v.removeEventListener("keyup",A),c.style.display="none",d.style.display="none",E.style.display="none",r(V===L)},A=N=>N.key==="Enter"||N.key===" "?x({target:L}):N.key==="Escape"?x({target:B}):N.preventDefault();L.addEventListener("click",x),B.addEventListener("click",x),v.addEventListener("keyup",A)},Ln=(a,r)=>{let c=U("confirmationBox"),d=U("alertWrapper"),v=te(document,"#transparentBG"),E=te(document,"#alert"),L=te(E,"#okAlert");c.style.display="block",d.style.display="block",v.style.display="block",te(E,"p").textContent=a,E.focus();let B=()=>{L.removeEventListener("click",B),E.removeEventListener("keyup",x),c.style.display="none",d.style.display="none",v.style.display="none",r(void 0)},x=A=>(A.key==="Enter"||A.key===" ")&&B();L.addEventListener("click",B),E.addEventListener("keyup",x)};var ae=a=>new Promise(r=>Ln(a,r));var He=a=>new Promise(r=>En(a,r));var Fe=a=>{if(a==="Refresh"&&f.barLevel>=5){if(f.refreshTime<Le)return void ae(`Currently, refreshes have a ${T(Le)} second cooldown. Sorry!`);f.barFragments.set(f.barFragments.getAmountOnRefresh()),f.barEXP=0,f.barLevel=0,f.barTNL=Ee(),le(ue(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),f.talents.barCriticalChance.convertToPerm(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.convertToPerm(),f.talents.barSpeed.updateHTML("Initialize"),f.refreshCount+=1,f.refreshTime=0,f.criticalHitsThisRefresh=0,Ue(),ke()}else return void ae("You cannot refresh yet. Get to level 5 lol")};var Kt=()=>{U("main-tab-nav").addEventListener("click",()=>me("Main")),U("upgrade-tab-nav").addEventListener("click",()=>me("Upgrades")),U("talent-tab-nav").addEventListener("click",()=>me("Talents")),U("buy-coin-bar-speed").addEventListener("click",a=>f.coinUpgrades.barSpeed.purchaseLevels(1,a)),U("buy-coin-bar-momentum").addEventListener("click",a=>f.coinUpgrades.barMomentum.purchaseLevels(1,a)),U("buy-coin-bar-reverberation").addEventListener("click",a=>f.coinUpgrades.barReverberation.purchaseLevels(1,a)),U("buy-coin-bar-vibration").addEventListener("click",a=>f.coinUpgrades.barVibration.purchaseLevels(1,a)),U("buy-coin-bar-agitation").addEventListener("click",a=>f.coinUpgrades.barAgitation.purchaseLevels(1,a)),U("buy-reset").addEventListener("click",()=>Fe("Refresh")),U("reset-game").addEventListener("click",()=>void Qt()),U("talentCriticalChanceSacrifice").addEventListener("click",()=>void f.talents.barCriticalChance.sacrificeFragments()),U("talentProgressSpeedSacrifice").addEventListener("click",()=>void f.talents.barSpeed.sacrificeFragments())};window.addEventListener("load",async()=>{Kt(),await ot(),ke()});document.addEventListener("visibilitychange",()=>{document.visibilityState!=="hidden"&&(f.coins.updateHTML(),f.coinUpgrades.barMomentum.updateHTML(),f.coinUpgrades.barSpeed.updateHTML(),f.coinUpgrades.barReverberation.updateHTML(),f.coinUpgrades.barVibration.updateHTML(),f.coinUpgrades.barAgitation.updateHTML(),f.barFragments.updateHTML(),f.talents.barCriticalChance.updateHTML("Initialize"),f.talents.barSpeed.updateHTML("Initialize"),C("coinWorth",{textContent:`Worth ${T(oe())} coins`}))});var xe=class{constructor(r=0){this.amount=r,this.updateHTML()}spend(r){this.amount>=r&&(this.amount-=r,this.updateHTML())}gain(r){this.amount+=r,this.updateHTML()}set(r){this.amount=r,this.updateHTML()}};var Oe=class extends xe{updateHTML(){C("gold-amount",{textContent:T(this.amount)})}};var Xe=class extends xe{updateHTML(){C("fragment-amount",{textContent:T(this.amount)}),C("fragment-bonus",{textContent:T(this.amount)}),C("fragment-gain",{textContent:T(this.getAmountOnRefresh())})}getAmountOnRefresh(){let r=f.barLevel,c=100*Math.pow(1.07,-5);return c*=Math.pow(1.07,r),c*=Math.pow(3,Math.floor(r/100)),c*=1+f.criticalHitsThisRefresh*f.coinUpgrades.barAgitation.upgradeEffect(),Math.floor(c)}unspentBonus(){return 1+1/100*this.amount}};var Te=class{constructor(r,c){this.level=r,this.cost=c}};var pe=class extends Te{constructor(r,c){super(r,c);this.updateHTML()}capLevel(){this.maxLevel!==-1&&(this.level=Math.min(this.maxLevel,this.level))}purchaseLevels(r,c){c.shiftKey&&(r=-1,r=Math.floor(f.coins.amount/this.cost)),this.maxLevel!==-1&&(r=Math.min(r,this.maxLevel-this.level)),this.cost*r<=f.coins.amount&&(f.coins.spend(this.cost*r),this.level+=r,this.updateHTML())}},G={barSpeed:1,barMomentum:10,barReverberation:25,barVibration:50,barAgitation:1e4},we=class extends pe{constructor(){super(...arguments);this.maxLevel=-1}upgradeEffect(){return 4*this.level/100+.06*Math.min(90,this.level)}updateHTML(){C("coin-bar-speed-effect",{textContent:`+${T(this.upgradeEffect(),2)} Progress Per Second`})}},Se=class extends pe{constructor(r,c){super(r,c);this.expoDivisor=400;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.maxLevel===this.level?.5:.45*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+1/200*Math.min(10,this.level)}updateHTML(){C("coin-bar-momentum-effect",{textContent:`Up to ${T(Math.pow(1+this.upgradeEffect(),10),2)}x Progress Speed based on fill%`}),this.level===this.maxLevel&&(C("coin-bar-momentum-name",{textContent:"Bar Momentum [MAX LEVEL]"}),D("coin-bar-momentum-name",{color:"orchid"}))}},Ce=class extends pe{constructor(r,c){super(r,c);this.expoDivisor=100;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?.1:.09*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+.002*Math.min(5,this.level)}updateHTML(){C("coin-bar-reverberation-effect",{textContent:`+${T(100*this.upgradeEffect(),2)}% chance to have a CRITICAL TICK`}),this.level===this.maxLevel&&(C("coin-bar-reverberation-name",{textContent:"Bar Reverberation [MAX LEVEL]"}),D("coin-bar-reverberation-name",{color:"orchid"}))}},_e=class extends pe{constructor(r,c){super(r,c);this.expoDivisor=170;this.maxLevel=Math.ceil(this.expoDivisor*Math.log(1e3));this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level===this.maxLevel?200:20+170*(1-Math.pow(Math.E,-this.level/this.expoDivisor))+Math.min(10,this.level)}updateHTML(){C("coin-bar-vibration-effect",{textContent:`CRITICAL TICKS fill up the bar ${T(this.upgradeEffect(),2)}x faster`}),this.level===this.maxLevel&&(C("coin-bar-vibration-name",{textContent:"Bar Vibration [MAX LEVEL]"}),D("coin-bar-vibration-name",{color:"orchid"}))}},Me=class extends pe{constructor(r,c){super(r,c);this.maxLevel=10;this.capLevel(),this.updateHTML()}upgradeEffect(){return this.level/5e3}updateHTML(){C("coin-bar-agitation-effect",{textContent:`+${T(100*this.upgradeEffect(),2)}% Bar Fragments per CRIT`}),this.level===this.maxLevel&&(C("coin-bar-agitation-name",{textContent:"Bar Agitation [MAX LEVEL]"}),D("coin-bar-agitation-name",{color:"orchid"}))}};var Jt="coinUpgrades.barSpeed",at=a=>{var c,d;let r=(c=H(a,Jt))!=null?c:H(f,Jt);return new we((d=r==null?void 0:r.level)!=null?d:0,G.barSpeed)};var qt="coinUpgrades.barMomentum",it=a=>{var c,d;let r=(c=H(a,qt))!=null?c:H(f,qt);return new Se((d=r==null?void 0:r.level)!=null?d:0,G.barMomentum)};var Zt="coinUpgrades.barReverberation",st=a=>{var c,d;let r=(c=H(a,Zt))!=null?c:H(f,Zt);return new Ce((d=r==null?void 0:r.level)!=null?d:0,G.barReverberation)};var jt="coinUpgrades.barVibration",ft=a=>{var c,d;let r=(c=H(a,jt))!=null?c:H(f,jt);return new _e((d=r==null?void 0:r.level)!=null?d:0,G.barVibration)};var er="coinUpgrades.barAgitation",ct=a=>{var c,d;let r=(c=H(a,er))!=null?c:H(f,er);return new Me((d=r==null?void 0:r.level)!=null?d:0,G.barAgitation)};var tr=(a,r,c,d=1)=>Math.ceil(a*(Math.pow(c,d)-Math.pow(r,d)));var ut=()=>f.barLevel>=20,lt=class extends Te{constructor(r,c,d,v,E){super(r,c);this.investedFragments=d,this.permLevel=v,this.currEXP=E,this.currTNL=this.calculateTNL()}calculateTNL(){return tr(this.cost,this.level,this.level+1,2)}setEXP(r){this.currEXP=r,this.updateHTML("GainEXP")}gainEXP(r){if(!ut())return;let c=this.calculateEXPGain(r);this.currEXP+=c,this.currEXP>=this.currTNL&&this.levelUp(),this.updateHTML("GainEXP")}levelUp(){this.level+=1,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("LevelUp")}computePermLevelGain(r){let c=0;return c+=Math.sqrt(r),c*=Math.min(4,Math.pow(f.refreshTime/300,2)),c=Math.min(r,c),Math.floor(c)}convertToPerm(){this.permLevel+=this.computePermLevelGain(this.level),this.level=0,this.setEXP(0),this.currTNL=this.calculateTNL(),this.updateHTML("PermLevelUp")}getBarWidth(){return Math.min(100,100*this.currEXP/this.currTNL)}async sacrificeFragments(){if(f.barFragments.amount<1e3)return void ae("You cannot sacrifice your bar fragments until you have at least 1,000 of them.");if(f.barFragments.amount<=this.investedFragments)return void ae(`This bar needs more fragments than you can invest. You need ${T(this.investedFragments)}.`);await He(`You will sacrifice ${T(f.barFragments.amount-this.investedFragments)} Bar Fragments to increase EXP gain for this bar. Will you? (automatically performs a refresh, setting your fragments to 0)`)&&(this.investedFragments=f.barFragments.amount,f.refreshTime+=Le,Fe("Refresh"),f.barFragments.set(0))}updateHTML(r){if(this.idHTML!==void 0){if(r==="Initialize"||r==="GainEXP"||r==="LevelUp"||r==="PermLevelUp"){C(`talent${this.idHTML}EXP`,{textContent:`EXP: ${T(this.currEXP)}/${T(this.currTNL)}`});let c=`${this.getBarWidth()}%`;D(`talent${this.idHTML}Progression`,{width:c})}(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp")&&C(`talent${this.idHTML}TempLevel`,{textContent:`Level this run: ${T(this.level)}`}),(r==="Initialize"||r==="PermLevelUp")&&C(`talent${this.idHTML}PermLevel`,{textContent:`Banked levels: ${T(this.permLevel)}`}),(r==="Initialize"||r==="Time"||r==="LevelUp")&&C(`talent${this.idHTML}PermGain`,{textContent:`Banked on reset: +${T(this.computePermLevelGain(this.level))}`}),(r==="Initialize"||r==="LevelUp"||r==="PermLevelUp"||r==="Level20")&&C(`talent${this.idHTML}Effect`,{textContent:this.displayEffect()})}}},se={talentCriticalChance:10,talentProgressSpeed:10},Pe=class extends lt{constructor(r,c,d,v,E){super(r,c,d,v,E);this.idHTML="CriticalChance";this.updateHTML("Initialize")}calculateEXPGain(r){let c=1;return c*=r*1e3/dt,c*=f.barLevel/10-1,c*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),c}talentEffect(){return ut()?.025*(1-Math.pow(Math.E,-this.level/2500))+.025*Math.min(250,this.level)/250+.025*(1-Math.pow(Math.E,-this.permLevel/4e3))+.025*Math.min(500,this.level)/500:0}displayEffect(){return`+${T(100*this.talentEffect(),3)}% chance of CRITICAL TICK`}},Ie=class extends lt{constructor(r,c,d,v,E){super(r,c,d,v,E);this.idHTML="ProgressSpeed";this.updateHTML("Initialize")}calculateEXPGain(r){let c=Math.log10(1+r);return c*=f.barLevel/10-1,c*=1+1/9*Math.pow(Math.log2(1+this.investedFragments/125),2),c}talentEffect(){return ut?(1+this.level/25)*(1+this.permLevel/50):0}displayEffect(){return`Progress Speed +${T(100*(this.talentEffect()-1),2)}%`}};var rr="talents.barCriticalChance",mt=a=>{var c,d,v,E,L;let r=(c=H(a,rr))!=null?c:H(f,rr);return new Pe((d=r==null?void 0:r.level)!=null?d:0,se.talentCriticalChance,(v=r==null?void 0:r.investedFragments)!=null?v:0,(E=r==null?void 0:r.permLevel)!=null?E:0,(L=r==null?void 0:r.currEXP)!=null?L:0)};var nr="talents.barSpeed",pt=a=>{var c,d,v,E,L;let r=(c=H(a,nr))!=null?c:H(f,nr);return new Ie((d=r==null?void 0:r.level)!=null?d:0,se.talentCriticalChance,(v=r==null?void 0:r.investedFragments)!=null?v:0,(E=r==null?void 0:r.permLevel)!=null?E:0,(L=r==null?void 0:r.currEXP)!=null?L:0)};var f={firstPlayed:new Date,barEXP:0,barTNL:0,totalEXP:0,barLevel:0,highestBarLevel:0,coins:new Oe,coinUpgrades:{},talents:{},barFragments:{},refreshCount:0,refreshTime:0,criticalHits:0,criticalHitsThisRefresh:0};f.coinUpgrades={barSpeed:new we(0,G.barSpeed),barMomentum:new Se(0,G.barMomentum),barReverberation:new Ce(0,G.barReverberation),barVibration:new _e(0,G.barVibration),barAgitation:new Me(0,G.barAgitation)};f.talents={barCriticalChance:new Pe(0,se.talentCriticalChance,0,0,0),barSpeed:new Ie(0,se.talentProgressSpeed,0,0,0)};f.barFragments=new Xe;var ar=Object.assign({},f),Tn=async()=>{let a=Object.assign({},f,{});await he.default.removeItem("UPBSave");let r=btoa(JSON.stringify(a));r!==null&&await he.default.setItem("UPBSave",r)},or=new Map([["coins",a=>new Oe(Number(a.coins.amount))],["coinUpgrades.barSpeed",at],["coinUpgrades.barMomentum",it],["coinUpgrades.barReverberation",st],["coinUpgrades.barVibration",ft],["coinUpgrades.barAgitation",ct],["talents.barCriticalChance",mt],["talents.barSpeed",pt],["barFragments",a=>new Xe(Number(a.barFragments.amount))]]),wn=async()=>{console.log("load attempted");let a=await he.default.getItem("UPBSave"),r=a?JSON.parse(atob(a)):null;if(!r)return;let c=Object.keys(r);for(let d of c)d in ar&&(or.has(d)||Object.defineProperty(f,d,{value:r[d]}));for(let[d,v]of or)Ot(f,d,v(r))},Re=new Set,ht=new Proxy(setInterval,{apply(a,r,c){let d=a.apply(r,c);return Re.add(d),d}}),Sn=new Proxy(clearInterval,{apply(a,r,c){let d=c[0];return Re.has(d)&&Re.delete(d),a.apply(r,c)}});window.addEventListener("pagehide",()=>{window.scrollTo(0,0)});var vt=0,dt=24,Cn=5e3,ot=async()=>{for(let a of Re)Sn(a);Re.clear(),await wn(),f.barTNL=Ee(),Object.defineProperty(window,"player",{value:f}),le(ue(f.barEXP,f.barTNL)),f.barFragments.updateHTML(),me("Main"),D("progression",{backgroundColor:de()}),C("coinWorth",{textContent:`Worth ${T(oe())} coins`}),vt=performance.now(),ht(_n,1e3/dt),ht(Yt,1e3),ht(Tn,Cn)},Qt=async()=>{if(await He("Are you SURE you want to reset the game?")===!1)return ae("OK, the game hasn't been reset!");await he.default.removeItem("UPBSave");let r=btoa(JSON.stringify(ar));await he.default.setItem("UPBSave",r),await ot()},_n=()=>{let r=performance.now()-vt;Mn(r/1e3),vt+=r},Mn=a=>{zt(a),f.refreshTime+=a,C("refresh-timer",{textContent:`${T(f.refreshTime,2)}s`});let r=ue(f.barEXP,f.barTNL);r<100?le(r):Gt(),Vt()},Le=60;})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=out.js.map
